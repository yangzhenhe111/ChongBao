Index: app/src/main/res/layout/activity_add_pet.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<ScrollView\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\">\r\n    <LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"match_parent\"\r\n        android:paddingTop=\"30dp\"\r\n        android:orientation=\"vertical\">\r\n        <!--顶栏-->\r\n        <LinearLayout\r\n\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\">\r\n            <ImageView\r\n\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:onClick=\"close\"\r\n                android:src=\"@drawable/shutdown\" />\r\n        </LinearLayout>\r\n        <LinearLayout\r\n\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginLeft=\"25dp\"\r\n            android:layout_marginRight=\"25dp\">\r\n\r\n            <LinearLayout\r\n\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"match_parent\"\r\n                android:orientation=\"vertical\">\r\n\r\n                <ImageView\r\n                    android:id=\"@+id/pet_photo\"\r\n                    android:layout_width=\"200dp\"\r\n                    android:layout_height=\"200dp\"\r\n                    android:layout_gravity=\"center\"\r\n                    android:layout_marginTop=\"21dp\"\r\n                    android:background=\"@drawable/hashiqi\" />\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"50dp\"\r\n                    android:layout_marginTop=\"50dp\"\r\n                    >\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:layout_marginRight=\"25sp\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:text=\"爱称\"\r\n                        android:textColor=\"#000\"\r\n                        android:textSize=\"12sp\" />\r\n\r\n                    <LinearLayout\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:background=\"@drawable/bg_myinfo\"\r\n                        android:orientation=\"vertical\">\r\n\r\n                        <EditText\r\n                            android:id=\"@+id/pet_name\"\r\n                            android:layout_width=\"match_parent\"\r\n                            android:layout_height=\"match_parent\"\r\n                            android:background=\"@null\"\r\n                            android:gravity=\"center_vertical\"\r\n                            android:onClick=\"onClicked\"\r\n                            android:text=\"有光\"\r\n                            android:textSize=\"12sp\" />\r\n                    </LinearLayout>\r\n\r\n\r\n                </LinearLayout>\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"50dp\"\r\n                    >\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:layout_marginRight=\"25sp\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:text=\"种类\"\r\n                        android:textColor=\"#000\"\r\n                        android:textSize=\"12sp\" />\r\n\r\n                    <LinearLayout\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:background=\"@drawable/bg_myinfo\"\r\n                        android:orientation=\"vertical\">\r\n\r\n                        <EditText\r\n                            android:id=\"@+id/pet_type\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"match_parent\"\r\n                            android:background=\"@null\"\r\n                            android:gravity=\"center_vertical\"\r\n                            android:onClick=\"onClicked\"\r\n                            android:text=\"哈士奇\"\r\n                            android:textColor=\"@color/black\"\r\n                            android:textSize=\"12sp\" />\r\n                    </LinearLayout>\r\n\r\n\r\n                </LinearLayout>\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"50dp\"\r\n                    >\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:layout_marginRight=\"25sp\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:text=\"年龄\"\r\n                        android:textColor=\"#000\"\r\n                        android:textSize=\"12sp\" />\r\n\r\n                    <LinearLayout\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:background=\"@drawable/bg_myinfo\"\r\n                        android:orientation=\"vertical\">\r\n\r\n                        <EditText\r\n                            android:id=\"@+id/pet_age\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"match_parent\"\r\n                            android:background=\"@null\"\r\n                            android:gravity=\"center_vertical\"\r\n                            android:onClick=\"onClicked\"\r\n                            android:text=\"4岁\"\r\n                            android:textColor=\"@color/black\"\r\n                            android:textSize=\"12sp\" />\r\n                    </LinearLayout>\r\n                </LinearLayout>\r\n\r\n                <LinearLayout\r\n\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n\r\n                    android:orientation=\"vertical\">\r\n\r\n                    <TextView\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_marginTop=\"25sp\"\r\n                        android:layout_marginBottom=\"20dp\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:text=\"宠物简介\"\r\n                        android:textColor=\"#000\"\r\n                        android:textSize=\"12sp\" />\r\n\r\n                    <LinearLayout\r\n                        android:layout_marginBottom=\"30dp\"\r\n                        android:background=\"@drawable/bg_myinfo\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"100dp\">\r\n\r\n                        <EditText\r\n                            android:id=\"@+id/pet_autograph\"\r\n                            android:layout_width=\"match_parent\"\r\n                            android:layout_height=\"100dp\"\r\n                            android:background=\"@null\"\r\n                            android:enabled=\"true\"\r\n                            android:gravity=\"start\"\r\n                            android:hint=\"阿巴阿巴阿巴\"\r\n                            android:inputType=\"textMultiLine\"\r\n                            android:maxLines=\"6\"\r\n                            android:minLines=\"6\"\r\n                            android:scrollbars=\"vertical\"\r\n                            android:textSize=\"12sp\" />\r\n                    </LinearLayout>\r\n                    <Button\r\n                        android:textColor=\"@color/red\"\r\n                        android:id=\"@+id/pet_update\"\r\n                        android:background=\"@drawable/edit\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"添加宠物\" />\r\n                </LinearLayout>\r\n            </LinearLayout>\r\n        </LinearLayout>\r\n\r\n\r\n    </LinearLayout>\r\n</ScrollView>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_add_pet.xml	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ app/src/main/res/layout/activity_add_pet.xml	(date 1607573572703)
@@ -1,50 +1,62 @@
 <?xml version="1.0" encoding="utf-8"?>
-<ScrollView
-    xmlns:android="http://schemas.android.com/apk/res/android"
-    android:layout_width="match_parent"
-    android:layout_height="match_parent">
-    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
-        android:layout_width="match_parent"
-        android:layout_height="match_parent"
-        android:paddingTop="30dp"
-        android:orientation="vertical">
-        <!--顶栏-->
-        <LinearLayout
+<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:paddingTop="30dp"
+    android:orientation="vertical">
+    <!--顶栏-->
+    <LinearLayout
 
-            android:layout_width="match_parent"
-            android:layout_height="wrap_content">
-            <ImageView
-
-                android:layout_width="wrap_content"
-                android:layout_height="wrap_content"
-                android:onClick="close"
-                android:src="@drawable/shutdown" />
-        </LinearLayout>
-        <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+        <ImageView
+            android:id="@+id/btn_close_add_pet"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:onClick="onClicked"
+            android:src="@drawable/shutdown"
+            android:background="@drawable/bg_circle"/>
+    </LinearLayout>
+    <RelativeLayout
 
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content">
+
+        <Button
+            android:id="@+id/pet_add"
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
-            android:layout_marginLeft="25dp"
-            android:layout_marginRight="25dp">
+            android:layout_alignParentBottom="true"
+            android:background="@drawable/edit"
+            android:onClick="onClicked"
+            android:text="添加"
+            android:textColor="@color/red" />
 
+        <ScrollView
+            android:layout_width="match_parent"
+            android:layout_height="match_parent"
+            android:layout_above="@id/pet_add">
             <LinearLayout
-
                 android:layout_width="match_parent"
                 android:layout_height="match_parent"
-                android:orientation="vertical">
+                android:orientation="vertical"
+                android:layout_marginLeft="25dp"
+                android:layout_marginRight="25dp">
 
                 <ImageView
-                    android:id="@+id/pet_photo"
-                    android:layout_width="200dp"
-                    android:layout_height="200dp"
+                    android:id="@+id/pet_photo1"
+                    android:onClick="onClicked"
+                    android:layout_width="250dp"
+                    android:layout_height="250dp"
                     android:layout_gravity="center"
                     android:layout_marginTop="21dp"
-                    android:background="@drawable/hashiqi" />
+                    android:background="@drawable/bg_circle"/>
 
                 <LinearLayout
                     android:layout_width="match_parent"
                     android:layout_height="50dp"
                     android:layout_marginTop="50dp"
+                    android:background="#fff"
                     >
 
                     <TextView
@@ -63,13 +75,12 @@
                         android:orientation="vertical">
 
                         <EditText
-                            android:id="@+id/pet_name"
+                            android:id="@+id/pet_name1"
                             android:layout_width="match_parent"
                             android:layout_height="match_parent"
                             android:background="@null"
                             android:gravity="center_vertical"
-                            android:onClick="onClicked"
-                            android:text="有光"
+                            android:hint="有光"
                             android:textSize="12sp" />
                     </LinearLayout>
 
@@ -79,6 +90,7 @@
                 <LinearLayout
                     android:layout_width="match_parent"
                     android:layout_height="50dp"
+                    android:background="#fff"
                     >
 
                     <TextView
@@ -91,19 +103,20 @@
                         android:textSize="12sp" />
 
                     <LinearLayout
+                        android:id="@+id/ll_pet_type1"
+                        android:onClick="onClicked"
                         android:layout_width="match_parent"
                         android:layout_height="match_parent"
                         android:background="@drawable/bg_myinfo"
                         android:orientation="vertical">
 
-                        <EditText
-                            android:id="@+id/pet_type"
+                        <TextView
+                            android:id="@+id/pet_type1"
                             android:layout_width="wrap_content"
                             android:layout_height="match_parent"
                             android:background="@null"
                             android:gravity="center_vertical"
-                            android:onClick="onClicked"
-                            android:text="哈士奇"
+                            android:hint="哈士奇"
                             android:textColor="@color/black"
                             android:textSize="12sp" />
                     </LinearLayout>
@@ -114,6 +127,7 @@
                 <LinearLayout
                     android:layout_width="match_parent"
                     android:layout_height="50dp"
+                    android:background="#fff"
                     >
 
                     <TextView
@@ -126,31 +140,30 @@
                         android:textSize="12sp" />
 
                     <LinearLayout
+                        android:id="@+id/ll_pet_age1"
+                        android:onClick="onClicked"
                         android:layout_width="match_parent"
                         android:layout_height="match_parent"
                         android:background="@drawable/bg_myinfo"
                         android:orientation="vertical">
 
                         <EditText
-                            android:id="@+id/pet_age"
+                            android:id="@+id/pet_age1"
                             android:layout_width="wrap_content"
                             android:layout_height="match_parent"
                             android:background="@null"
                             android:gravity="center_vertical"
-                            android:onClick="onClicked"
-                            android:text="4岁"
+                            android:hint="4岁"
                             android:textColor="@color/black"
                             android:textSize="12sp" />
                     </LinearLayout>
                 </LinearLayout>
 
                 <LinearLayout
-
                     android:layout_width="match_parent"
                     android:layout_height="wrap_content"
-
+                    android:background="@drawable/bg_myinfo"
                     android:orientation="vertical">
-
                     <TextView
                         android:layout_width="match_parent"
                         android:layout_height="wrap_content"
@@ -160,15 +173,14 @@
                         android:text="宠物简介"
                         android:textColor="#000"
                         android:textSize="12sp" />
-
-                    <LinearLayout
+                    <RelativeLayout
                         android:layout_marginBottom="30dp"
                         android:background="@drawable/bg_myinfo"
                         android:layout_width="match_parent"
                         android:layout_height="100dp">
 
                         <EditText
-                            android:id="@+id/pet_autograph"
+                            android:id="@+id/pet_autograph1"
                             android:layout_width="match_parent"
                             android:layout_height="100dp"
                             android:background="@null"
@@ -180,18 +192,20 @@
                             android:minLines="6"
                             android:scrollbars="vertical"
                             android:textSize="12sp" />
-                    </LinearLayout>
-                    <Button
-                        android:textColor="@color/red"
-                        android:id="@+id/pet_update"
-                        android:background="@drawable/edit"
-                        android:layout_width="match_parent"
-                        android:layout_height="wrap_content"
-                        android:text="添加宠物" />
+                        <TextView
+                            android:id="@+id/tv_input1"
+                            android:layout_width="wrap_content"
+                            android:layout_height="wrap_content"
+                            android:layout_alignParentBottom="true"
+                            android:layout_alignParentRight="true"
+                            android:layout_marginRight="10dp"
+                            android:text="0/200"/>
+                    </RelativeLayout>
                 </LinearLayout>
             </LinearLayout>
-        </LinearLayout>
+        </ScrollView>
 
+    </RelativeLayout>
 
-    </LinearLayout>
-</ScrollView>
\ No newline at end of file
+
+</LinearLayout>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_09_[Default_Changelist]/shelved.patch
===================================================================
--- .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_09_[Default_Changelist]/shelved.patch	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_09_[Default_Changelist]/shelved.patch	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
@@ -1,149 +0,0 @@
-Index: app/src/main/java/com/example/pet/other/Cache.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.pet.other;\r\n\r\nimport com.example.pet.other.entity.User;\r\n\r\npublic class Cache {\r\n    /**\r\n     * 存储一些全局信息\r\n     */\r\n\r\npublic static  User user  ;\r\npublic static final String MY_URL=\"http://10.7.90.249:8080/ChongBaoService\";\r\n\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
---- app/src/main/java/com/example/pet/other/Cache.java	(revision 8b5496ff3b02de2cfef3f394fe3a69b2ec115f46)
-+++ app/src/main/java/com/example/pet/other/Cache.java	(date 1606959273044)
-@@ -9,5 +9,5 @@
- 
- public static  User user  ;
- public static final String MY_URL="http://10.7.90.249:8080/ChongBaoService";
--
-+public static String url = "http://192.168.43.227:8080/ChongBao_war_exploded/";
- }
-Index: app/src/main/java/com/example/pet/forum/ForumFragment.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.pet.forum;\r\nimport android.content.Intent;\r\nimport android.graphics.Bitmap;\r\nimport android.media.Image;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.text.TextPaint;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageView;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.ListView;\r\nimport android.widget.PopupWindow;\r\nimport android.widget.RelativeLayout;\r\nimport android.widget.Switch;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport com.example.pet.R;\r\nimport com.example.pet.other.entity.BaseUrl;\r\nimport com.example.pet.other.entity.Tips;\r\nimport com.youth.banner.Banner;\r\nimport com.youth.banner.BannerConfig;\r\nimport com.youth.banner.listener.OnBannerListener;\r\n\r\nimport org.json.JSONArray;\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\nimport java.io.BufferedReader;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.io.InputStreamReader;\r\nimport java.net.HttpURLConnection;\r\nimport java.net.MalformedURLException;\r\nimport java.net.ProtocolException;\r\nimport java.net.URL;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class ForumFragment extends Fragment {\r\n\r\n    private EditText et_search;\r\n    private Button btn_search;\r\n    private Button btn_publish;\r\n    private RelativeLayout forum_food;\r\n    private RelativeLayout forum_articles;\r\n    private RelativeLayout forum_daily;\r\n    private RelativeLayout forum_cosmetology;\r\n    private RelativeLayout forum_train;\r\n    private RelativeLayout forum_deworming;\r\n    private RelativeLayout forum_disease;\r\n    private RelativeLayout forum_randomtalk;\r\n    private RelativeLayout forum_question;\r\n    private RelativeLayout forum_sharephotos;\r\n    private TextView tv_newest;\r\n    private TextView tv_hot;\r\n    private TextView tv_essence;\r\n    private ListView lv_tips;\r\n    private Banner banner;\r\n    private ArrayList<Tips> arrayList = new ArrayList<>();\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(@NonNull final LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\r\n        View view = inflater.inflate(R.layout.fragment_forum,container,false);\r\n        init();\r\n        et_search = view.findViewById(R.id.et_main_search);\r\n        btn_search = view.findViewById(R.id.btn_main_search);\r\n        btn_search.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n\r\n            }\r\n        });\r\n        btn_publish = view.findViewById(R.id.btn_publish_articles);\r\n        btn_publish.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),PublishActivity.class);\r\n                startActivity(intent);\r\n                getActivity().finish();\r\n            }\r\n        });\r\n        forum_food = view.findViewById(R.id.forum_food);\r\n        forum_food.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_articles = view.findViewById(R.id.forum_articles);\r\n        forum_articles.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_daily = view.findViewById(R.id.forum_daily);\r\n        forum_daily.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_cosmetology = view.findViewById(R.id.forum_cosmetology);\r\n        forum_cosmetology.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_train = view.findViewById(R.id.forum_train);\r\n        forum_train.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_deworming = view.findViewById(R.id.forum_deworming);\r\n        forum_deworming.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_disease = view.findViewById(R.id.forum_disease);\r\n        forum_disease.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_randomtalk = view.findViewById(R.id.forum_randomtalk);\r\n        forum_randomtalk.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_question = view.findViewById(R.id.forum_question);\r\n        forum_question.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_sharephotos = view.findViewById(R.id.forum_sharephotos);\r\n        forum_sharephotos.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        tv_newest = view.findViewById(R.id.forum_newest);\r\n        TextPaint base = tv_newest.getPaint();\r\n        base.setFakeBoldText(true);\r\n        tv_hot = view.findViewById(R.id.forum_hot);\r\n        tv_essence = view.findViewById(R.id.forum_essence);\r\n        tv_newest.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                tv_newest.setBackgroundColor(getResources().getColor(R.color.Blue));\r\n                tv_hot.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_essence.setBackgroundColor(getResources().getColor(R.color.White));\r\n                TextPaint newest = tv_newest.getPaint();\r\n                newest.setFakeBoldText(true);\r\n                TextPaint hot = tv_hot.getPaint();\r\n                hot.setFakeBoldText(false);\r\n                TextPaint essence = tv_essence.getPaint();\r\n                essence.setFakeBoldText(false);\r\n            }\r\n        });\r\n        tv_hot.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                tv_newest.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_hot.setBackgroundColor(getResources().getColor(R.color.Orange));\r\n                tv_essence.setBackgroundColor(getResources().getColor(R.color.White));\r\n                TextPaint newest = tv_newest.getPaint();\r\n                newest.setFakeBoldText(false);\r\n                TextPaint hot = tv_hot.getPaint();\r\n                hot.setFakeBoldText(true);\r\n                TextPaint essence = tv_essence.getPaint();\r\n                essence.setFakeBoldText(false);\r\n            }\r\n        });\r\n        tv_essence.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                tv_newest.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_hot.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_essence.setBackgroundColor(getResources().getColor(R.color.Purple));\r\n                TextPaint newest = tv_newest.getPaint();\r\n                newest.setFakeBoldText(false);\r\n                TextPaint hot = tv_hot.getPaint();\r\n                hot.setFakeBoldText(false);\r\n                TextPaint essence = tv_essence.getPaint();\r\n                essence.setFakeBoldText(true);\r\n            }\r\n        });\r\n\r\n\r\n        ArrayList<Integer> images = new ArrayList<>();\r\n        ArrayList<String> title = new ArrayList<>();\r\n        title.add(\"新手推荐文章1\");\r\n        title.add(\"新手推荐文章2\");\r\n        title.add(\"新手推荐文章3\");\r\n        title.add(\"新手推荐文章4\");\r\n        title.add(\"新手推荐文章5\");\r\n        images.add(R.drawable.recommend1);\r\n        images.add(R.drawable.recommend2);\r\n        images.add(R.drawable.recommend3);\r\n        images.add(R.drawable.recommend4);\r\n        images.add(R.drawable.recommend5);\r\n\r\n        banner = view.findViewById(R.id.banner);\r\n        banner.setBannerStyle(BannerConfig.CIRCLE_INDICATOR_TITLE_INSIDE);\r\n        banner.setBannerTitles(title);\r\n        banner.setImageLoader(new GlideImageLoader());\r\n        banner.setImages(images);\r\n        banner.start();\r\n\r\n        banner.setOnBannerListener(new OnBannerListener() {\r\n            @Override\r\n            public void OnBannerClick(int position) {\r\n                Intent intent;\r\n                switch (position){\r\n                    case 0:\r\n                        intent = new Intent(getContext(),TipsActivity.class);\r\n                        startActivity(intent);\r\n                        break;\r\n                    case 1:\r\n                        intent = new Intent(getContext(),TipsActivity.class);\r\n                        startActivity(intent);\r\n                        break;\r\n                    case 2:\r\n                        intent = new Intent(getContext(),TipsActivity.class);\r\n                        startActivity(intent);\r\n                        break;\r\n                }\r\n                Log.e(\"点击了第几张轮播图:\",position+\"\");\r\n            }\r\n        });\r\n\r\n        lv_tips = view.findViewById(R.id.lv_tips);\r\n//        for (int i = 0; i < 5; i++) {\r\n//            Tips tips = new Tips();\r\n//            tips.setId(1);\r\n//            tips.setUserName(\"名字\" + i);\r\n//            tips.setTime(\"2020-11-28/16:36:0\" + i);\r\n//            tips.setTopic(\"标签\" + i);\r\n//            tips.setTitle(\"标题\" + i);\r\n//            tips.setText(\"正文\" + i);\r\n//            arrayList.add(tips);\r\n//        }\r\n        MainForumTipsAdapter mainForumTipsAdapter = new MainForumTipsAdapter(getContext(),arrayList,R.layout.forum_tips_item);\r\n        lv_tips.setAdapter(mainForumTipsAdapter);\r\n        return view;\r\n    }\r\n\r\n    public void init(){\r\n        new Thread(){\r\n            @Override\r\n            public void run() {\r\n                try {\r\n                    URL url = new URL(\"http:10.7.90.222:8080/ChongBao_war_exploded/GetAllPostServlet\");\r\n                    HttpURLConnection connection = (HttpURLConnection) url.openConnection();\r\n                    connection.setRequestMethod(\"GET\");\r\n                    InputStream input = connection.getInputStream();\r\n                    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(input));\r\n                    StringBuffer stringBuffer = new StringBuffer();\r\n                    String line;\r\n                    while ((line=bufferedReader.readLine())!=null){\r\n                        stringBuffer.append(line);\r\n                    }\r\n                    JSONArray jsonArray = new JSONArray(stringBuffer.toString());\r\n                    arrayList = new ArrayList<>();\r\n                    for (int i=0;i<jsonArray.length();i++){\r\n                        JSONObject jsonObject = jsonArray.getJSONObject(i);\r\n                        String post_title = jsonObject.getString(\"post_title\");\r\n                        String post_time = jsonObject.getString(\"post_time\");\r\n                        String post_text = jsonObject.getString(\"post_text\");\r\n                        String name = jsonObject.getString(\"name\");\r\n                        String user_name = jsonObject.getString(\"user_name\");\r\n                        Tips tips = new Tips();\r\n                        tips.setTitle(post_title);\r\n                        tips.setText(post_text);\r\n                        tips.setTime(post_time);\r\n                        tips.setUserName(user_name);\r\n                        arrayList.add(tips);\r\n                    }\r\n                } catch (MalformedURLException e) {\r\n                    e.printStackTrace();\r\n                } catch (ProtocolException e) {\r\n                    e.printStackTrace();\r\n                } catch (IOException e) {\r\n                    e.printStackTrace();\r\n                } catch (JSONException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            }\r\n        }.start();\r\n    }\r\n\r\n    public void search(){\r\n        new Thread(){\r\n            @Override\r\n            public void run() {\r\n                String search = et_search.getText().toString();\r\n            }\r\n        };\r\n    }\r\n\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
---- app/src/main/java/com/example/pet/forum/ForumFragment.java	(revision 8b5496ff3b02de2cfef3f394fe3a69b2ec115f46)
-+++ app/src/main/java/com/example/pet/forum/ForumFragment.java	(date 1606959024617)
-@@ -1,9 +1,8 @@
- package com.example.pet.forum;
- import android.content.Intent;
--import android.graphics.Bitmap;
--import android.media.Image;
--import android.net.Uri;
- import android.os.Bundle;
-+import android.os.Handler;
-+import android.os.Message;
- import android.text.TextPaint;
- import android.util.Log;
- import android.view.LayoutInflater;
-@@ -11,12 +10,8 @@
- import android.view.ViewGroup;
- import android.widget.Button;
- import android.widget.EditText;
--import android.widget.ImageView;
--import android.widget.LinearLayout;
- import android.widget.ListView;
--import android.widget.PopupWindow;
- import android.widget.RelativeLayout;
--import android.widget.Switch;
- import android.widget.TextView;
- 
- import androidx.annotation.NonNull;
-@@ -24,7 +19,7 @@
- import androidx.fragment.app.Fragment;
- 
- import com.example.pet.R;
--import com.example.pet.other.entity.BaseUrl;
-+import com.example.pet.other.Cache;
- import com.example.pet.other.entity.Tips;
- import com.youth.banner.Banner;
- import com.youth.banner.BannerConfig;
-@@ -43,7 +38,6 @@
- import java.net.ProtocolException;
- import java.net.URL;
- import java.util.ArrayList;
--import java.util.List;
- 
- public class ForumFragment extends Fragment {
- 
-@@ -67,11 +61,22 @@
-     private Banner banner;
-     private ArrayList<Tips> arrayList = new ArrayList<>();
- 
-+    private Handler handler = new Handler(){
-+        @Override
-+        public void handleMessage(@NonNull Message message) {
-+            switch (message.what){
-+                case 1:
-+                    init((ArrayList) message.obj);
-+                    break;
-+            }
-+        }
-+    };
-+
-     @Nullable
-     @Override
-     public View onCreateView(@NonNull final LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
-         View view = inflater.inflate(R.layout.fragment_forum,container,false);
--        init();
-+        getAllTips();
-         et_search = view.findViewById(R.id.et_main_search);
-         btn_search = view.findViewById(R.id.btn_main_search);
-         btn_search.setOnClickListener(new View.OnClickListener() {
-@@ -282,17 +287,21 @@
- //            tips.setText("正文" + i);
- //            arrayList.add(tips);
- //        }
-+
-+        return view;
-+    }
-+
-+    public void init(ArrayList arrayList){
-         MainForumTipsAdapter mainForumTipsAdapter = new MainForumTipsAdapter(getContext(),arrayList,R.layout.forum_tips_item);
-         lv_tips.setAdapter(mainForumTipsAdapter);
--        return view;
-     }
- 
--    public void init(){
-+    public void getAllTips(){
-         new Thread(){
-             @Override
-             public void run() {
-                 try {
--                    URL url = new URL("http:10.7.90.222:8080/ChongBao_war_exploded/GetAllPostServlet");
-+                    URL url = new URL(Cache.url + "GetAllPostServlet");
-                     HttpURLConnection connection = (HttpURLConnection) url.openConnection();
-                     connection.setRequestMethod("GET");
-                     InputStream input = connection.getInputStream();
-@@ -303,7 +312,7 @@
-                         stringBuffer.append(line);
-                     }
-                     JSONArray jsonArray = new JSONArray(stringBuffer.toString());
--                    arrayList = new ArrayList<>();
-+                    ArrayList arrayList = new ArrayList<>();
-                     for (int i=0;i<jsonArray.length();i++){
-                         JSONObject jsonObject = jsonArray.getJSONObject(i);
-                         String post_title = jsonObject.getString("post_title");
-@@ -317,6 +326,13 @@
-                         tips.setTime(post_time);
-                         tips.setUserName(user_name);
-                         arrayList.add(tips);
-+
-+                        Log.e("123",arrayList + "");
-+
-+                        Message message = handler.obtainMessage();
-+                        message.what = 1;
-+                        message.obj = arrayList;
-+                        handler.sendMessage(message);
-                     }
-                 } catch (MalformedURLException e) {
-                     e.printStackTrace();
-Index: app/src/main/java/com/example/pet/other/entity/BaseUrl.java
-===================================================================
---- app/src/main/java/com/example/pet/other/entity/BaseUrl.java	(revision 8b5496ff3b02de2cfef3f394fe3a69b2ec115f46)
-+++ app/src/main/java/com/example/pet/other/entity/BaseUrl.java	(revision 8b5496ff3b02de2cfef3f394fe3a69b2ec115f46)
-@@ -1,5 +0,0 @@
--package com.example.pet.other.entity;
--
--public class BaseUrl {
--    public static String url = "http://192.168.43.227:8080//LovePet/";
--}
Index: .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_9_09__Default_Changelist_.xml
===================================================================
--- .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_9_09__Default_Changelist_.xml	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_9_09__Default_Changelist_.xml	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
@@ -1,4 +0,0 @@
-<changelist name="Uncommitted_changes_before_Update_at_2020_12_3_9_09_[Default_Changelist]" date="1606957776291" recycled="true" deleted="true">
-  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_9_09_[Default_Changelist]/shelved.patch" />
-  <option name="DESCRIPTION" value="Uncommitted changes before Update at 2020/12/3 9:09 [Default Changelist]" />
-</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_9_09_[Default_Changelist]/shelved.patch
===================================================================
--- .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_9_09_[Default_Changelist]/shelved.patch	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_9_09_[Default_Changelist]/shelved.patch	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
@@ -1,175 +0,0 @@
-Index: app/src/main/java/com/example/pet/other/entity/BaseUrl.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.pet.other.entity;\r\n\r\npublic class BaseUrl {\r\n    public static String url = \"http://192.168.43.227:8080//LovePet/\";\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
---- app/src/main/java/com/example/pet/other/entity/BaseUrl.java	(revision 70772a57e4d51a2222224889684257011a2a1791)
-+++ app/src/main/java/com/example/pet/other/entity/BaseUrl.java	(date 1606897521348)
-@@ -1,5 +1,5 @@
- package com.example.pet.other.entity;
- 
- public class BaseUrl {
--    public static String url = "http://192.168.43.227:8080//LovePet/";
-+    public static String url = "http://192.168.43.202:8080/ChongBao_war_exploded/";
- }
-Index: app/src/main/java/com/example/pet/forum/ForumFragment.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.pet.forum;\r\nimport android.content.Intent;\r\nimport android.graphics.Bitmap;\r\nimport android.os.Bundle;\r\nimport android.text.TextPaint;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.ListView;\r\nimport android.widget.PopupWindow;\r\nimport android.widget.RelativeLayout;\r\nimport android.widget.Switch;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport com.example.pet.R;\r\nimport com.example.pet.other.entity.BaseUrl;\r\nimport com.example.pet.other.entity.Tips;\r\nimport com.youth.banner.Banner;\r\nimport com.youth.banner.BannerConfig;\r\nimport com.youth.banner.listener.OnBannerListener;\r\n\r\nimport org.json.JSONArray;\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\nimport java.io.BufferedReader;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.io.InputStreamReader;\r\nimport java.net.HttpURLConnection;\r\nimport java.net.MalformedURLException;\r\nimport java.net.ProtocolException;\r\nimport java.net.URL;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class ForumFragment extends Fragment {\r\n\r\n    private EditText et_search;\r\n    private Button btn_search;\r\n    private Button btn_publish;\r\n    private RelativeLayout forum_food;\r\n    private RelativeLayout forum_articles;\r\n    private RelativeLayout forum_daily;\r\n    private RelativeLayout forum_cosmetology;\r\n    private RelativeLayout forum_train;\r\n    private RelativeLayout forum_deworming;\r\n    private RelativeLayout forum_disease;\r\n    private RelativeLayout forum_randomtalk;\r\n    private RelativeLayout forum_question;\r\n    private RelativeLayout forum_sharephotos;\r\n    private TextView tv_newest;\r\n    private TextView tv_hot;\r\n    private TextView tv_essence;\r\n    private ListView lv_tips;\r\n    private Banner banner;\r\n    private ArrayList<Tips> arrayList = new ArrayList<>();\r\n    private PopupWindow popupWindow;\r\n\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(@NonNull final LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\r\n        View view = inflater.inflate(R.layout.fragment_forum,container,false);\r\n        init();\r\n        Log.e(\"1\",\"1\");\r\n        et_search = view.findViewById(R.id.et_main_search);\r\n        btn_search = view.findViewById(R.id.btn_main_search);\r\n        btn_search.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n\r\n            }\r\n        });\r\n        btn_publish = view.findViewById(R.id.btn_publish_articles);\r\n        btn_publish.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),PublishActivity.class);\r\n                startActivity(intent);\r\n                getActivity().finish();\r\n            }\r\n        });\r\n        forum_food = view.findViewById(R.id.forum_food);\r\n        forum_food.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_articles = view.findViewById(R.id.forum_articles);\r\n        forum_articles.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_daily = view.findViewById(R.id.forum_daily);\r\n        forum_daily.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_cosmetology = view.findViewById(R.id.forum_cosmetology);\r\n        forum_cosmetology.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_train = view.findViewById(R.id.forum_train);\r\n        forum_train.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_deworming = view.findViewById(R.id.forum_deworming);\r\n        forum_deworming.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_disease = view.findViewById(R.id.forum_disease);\r\n        forum_disease.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_randomtalk = view.findViewById(R.id.forum_randomtalk);\r\n        forum_randomtalk.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_question = view.findViewById(R.id.forum_question);\r\n        forum_question.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_sharephotos = view.findViewById(R.id.forum_sharephotos);\r\n        forum_sharephotos.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        tv_newest = view.findViewById(R.id.forum_newest);\r\n        TextPaint base = tv_newest.getPaint();\r\n        base.setFakeBoldText(true);\r\n        tv_hot = view.findViewById(R.id.forum_hot);\r\n        tv_essence = view.findViewById(R.id.forum_essence);\r\n        tv_newest.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                tv_newest.setBackgroundColor(getResources().getColor(R.color.Blue));\r\n                tv_hot.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_essence.setBackgroundColor(getResources().getColor(R.color.White));\r\n                TextPaint newest = tv_newest.getPaint();\r\n                newest.setFakeBoldText(true);\r\n                TextPaint hot = tv_hot.getPaint();\r\n                hot.setFakeBoldText(false);\r\n                TextPaint essence = tv_essence.getPaint();\r\n                essence.setFakeBoldText(false);\r\n            }\r\n        });\r\n        tv_hot.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                tv_newest.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_hot.setBackgroundColor(getResources().getColor(R.color.Orange));\r\n                tv_essence.setBackgroundColor(getResources().getColor(R.color.White));\r\n                TextPaint newest = tv_newest.getPaint();\r\n                newest.setFakeBoldText(false);\r\n                TextPaint hot = tv_hot.getPaint();\r\n                hot.setFakeBoldText(true);\r\n                TextPaint essence = tv_essence.getPaint();\r\n                essence.setFakeBoldText(false);\r\n            }\r\n        });\r\n        tv_essence.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                tv_newest.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_hot.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_essence.setBackgroundColor(getResources().getColor(R.color.Purple));\r\n                TextPaint newest = tv_newest.getPaint();\r\n                newest.setFakeBoldText(false);\r\n                TextPaint hot = tv_hot.getPaint();\r\n                hot.setFakeBoldText(false);\r\n                TextPaint essence = tv_essence.getPaint();\r\n                essence.setFakeBoldText(true);\r\n            }\r\n        });\r\n\r\n\r\n        ArrayList<Integer> images = new ArrayList<>();\r\n        ArrayList<String> title = new ArrayList<>();\r\n        title.add(\"新手推荐文章1\");\r\n        title.add(\"新手推荐文章2\");\r\n        title.add(\"新手推荐文章3\");\r\n        title.add(\"新手推荐文章4\");\r\n        title.add(\"新手推荐文章5\");\r\n        images.add(R.drawable.recommend1);\r\n        images.add(R.drawable.recommend2);\r\n        images.add(R.drawable.recommend3);\r\n        images.add(R.drawable.recommend4);\r\n        images.add(R.drawable.recommend5);\r\n\r\n        banner = view.findViewById(R.id.banner);\r\n        banner.setBannerStyle(BannerConfig.CIRCLE_INDICATOR_TITLE_INSIDE);\r\n        banner.setBannerTitles(title);\r\n        banner.setImageLoader(new GlideImageLoader());\r\n        banner.setImages(images);\r\n        banner.start();\r\n\r\n        banner.setOnBannerListener(new OnBannerListener() {\r\n            @Override\r\n            public void OnBannerClick(int position) {\r\n                Intent intent;\r\n                switch (position){\r\n                    case 0:\r\n                        intent = new Intent(getContext(),TipsActivity.class);\r\n                        startActivity(intent);\r\n                        break;\r\n                    case 1:\r\n                        intent = new Intent(getContext(),TipsActivity.class);\r\n                        startActivity(intent);\r\n                        break;\r\n                    case 2:\r\n                        intent = new Intent(getContext(),TipsActivity.class);\r\n                        startActivity(intent);\r\n                        break;\r\n                }\r\n                Log.e(\"点击了第几张轮播图:\",position+\"\");\r\n            }\r\n        });\r\n\r\n        lv_tips = view.findViewById(R.id.lv_tips);\r\n        for (int i = 0; i < 5; i++) {\r\n            Tips tips = new Tips();\r\n            tips.setId(1);\r\n            tips.setUserName(\"名字\" + i);\r\n            tips.setTime(\"2020-11-28/16:36:0\" + i);\r\n            tips.setTopic(\"标签\" + i);\r\n            tips.setTitle(\"标题\" + i);\r\n            tips.setText(\"正文\" + i);\r\n            arrayList.add(tips);\r\n        }\r\n        MainForumTipsAdapter mainForumTipsAdapter = new MainForumTipsAdapter(getContext(),arrayList,R.layout.forum_tips_item);\r\n        lv_tips.setAdapter(mainForumTipsAdapter);\r\n        return view;\r\n    }\r\n\r\n    public void init(){\r\n        Log.e(\"2\",\"2\");\r\n        new Thread(){\r\n            @Override\r\n            public void run() {\r\n                try {\r\n                    Log.e(\"3\",\"3\");\r\n                    URL url = new URL(\"http://192.168.43.227:8080//LovePet/SearchAllPostServlet\");\r\n                    Log.e(\"5\",\"5\");\r\n                    HttpURLConnection connection = (HttpURLConnection) url.openConnection();\r\n                    Log.e(\"7\",\"7\");\r\n                    connection.setRequestMethod(\"GET\");\r\n                    InputStream input = connection.getInputStream();\r\n                    Log.e(\"6\",\"6\");\r\n                    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(input));\r\n                    StringBuffer stringBuffer = new StringBuffer();\r\n                    String line;\r\n                    while ((line=bufferedReader.readLine())!=null){\r\n                        stringBuffer.append(line);\r\n                    }\r\n                    Log.e(\"4\",\"4\");\r\n                    Log.e(\"4\",\"4\");\r\n                    JSONArray jsonArray = new JSONArray(stringBuffer.toString());\r\n                    Log.e(\"9\",jsonArray+\"\");\r\n                    Log.e(\"10\",\"10\");\r\n                    List<Tips> tipsList = new ArrayList<>();\r\n                    for (int i=0;i<jsonArray.length();i++){\r\n                        JSONObject jsonObject = jsonArray.getJSONObject(i);\r\n                        int id = jsonObject.getInt(\"id\");\r\n                        int usedid = jsonObject.getInt(\"userId\");\r\n                        String userName = jsonObject.getString(\"userName\");\r\n                        String userhead = jsonObject.getString(\"userHead\");\r\n                        String time = jsonObject.getString(\"time\");\r\n                        String topic = jsonObject.getString(\"topic\");\r\n                        String title = jsonObject.getString(\"title\");\r\n                        String text = jsonObject.getString(\"text\");\r\n                        int likes = jsonObject.getInt(\"like\");\r\n                        int comments = jsonObject.getInt(\"comments\");\r\n                        int forwards = jsonObject.getInt(\"forwards\");\r\n                        Tips tips = new Tips();\r\n                        tips.setUserName(userName);\r\n                        tips.setId(id);\r\n                        tips.setUserId(usedid);\r\n                        tips.setTime(time);\r\n                        tips.setTopic(topic);\r\n                        tips.setTitle(title);\r\n                        tips.setText(text);\r\n                        tips.setLikes(likes);\r\n                        tips.setComments(comments);\r\n                        tips.setForwards(forwards);\r\n                        Log.e(\"userid+\",jsonObject+\"\");\r\n                    }\r\n                } catch (MalformedURLException e) {\r\n                    e.printStackTrace();\r\n                } catch (ProtocolException e) {\r\n                    e.printStackTrace();\r\n                } catch (IOException e) {\r\n                    e.printStackTrace();\r\n                } catch (JSONException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            }\r\n        }.start();\r\n    }\r\n\r\n    public void search(){\r\n        new Thread(){\r\n            @Override\r\n            public void run() {\r\n                String search = et_search.getText().toString();\r\n            }\r\n        };\r\n    }\r\n\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
---- app/src/main/java/com/example/pet/forum/ForumFragment.java	(revision 70772a57e4d51a2222224889684257011a2a1791)
-+++ app/src/main/java/com/example/pet/forum/ForumFragment.java	(date 1606957099338)
-@@ -40,7 +40,9 @@
- import java.net.ProtocolException;
- import java.net.URL;
- import java.util.ArrayList;
-+import java.util.HashMap;
- import java.util.List;
-+import java.util.Map;
- 
- public class ForumFragment extends Fragment {
- 
-@@ -63,7 +65,6 @@
-     private ListView lv_tips;
-     private Banner banner;
-     private ArrayList<Tips> arrayList = new ArrayList<>();
--    private PopupWindow popupWindow;
- 
- 
-     @Nullable
-@@ -71,7 +72,6 @@
-     public View onCreateView(@NonNull final LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
-         View view = inflater.inflate(R.layout.fragment_forum,container,false);
-         init();
--        Log.e("1","1");
-         et_search = view.findViewById(R.id.et_main_search);
-         btn_search = view.findViewById(R.id.btn_main_search);
-         btn_search.setOnClickListener(new View.OnClickListener() {
-@@ -288,44 +288,40 @@
-     }
- 
-     public void init(){
--        Log.e("2","2");
-         new Thread(){
-             @Override
-             public void run() {
-                 try {
--                    Log.e("3","3");
--                    URL url = new URL("http://192.168.43.227:8080//LovePet/SearchAllPostServlet");
--                    Log.e("5","5");
--                    HttpURLConnection connection = (HttpURLConnection) url.openConnection();
--                    Log.e("7","7");
--                    connection.setRequestMethod("GET");
--                    InputStream input = connection.getInputStream();
-+                    URL url = new URL("http://192.168.43.202:8080/ChongBao_war_exploded/SearchAllPostServlet");
-+                    //HttpURLConnection connection = (HttpURLConnection) url.openConnection();
-+                    //connection.setRequestMethod("GET");
-+                    //InputStream input = connection.getInputStream();
-+                    Log.e("6","6");
-+                    InputStream inputStream = url.openStream();
-                     Log.e("6","6");
--                    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(input));
--                    StringBuffer stringBuffer = new StringBuffer();
-+                    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(inputStream,"utf-8"));
-+                    String getAllTips = "";
-                     String line;
--                    while ((line=bufferedReader.readLine())!=null){
--                        stringBuffer.append(line);
-+                    while((line = bufferedReader.readLine()) != null){
-+                        getAllTips += line;
-                     }
--                    Log.e("4","4");
--                    Log.e("4","4");
--                    JSONArray jsonArray = new JSONArray(stringBuffer.toString());
--                    Log.e("9",jsonArray+"");
--                    Log.e("10","10");
-+                    Log.e("123",getAllTips);
-                     List<Tips> tipsList = new ArrayList<>();
--                    for (int i=0;i<jsonArray.length();i++){
--                        JSONObject jsonObject = jsonArray.getJSONObject(i);
--                        int id = jsonObject.getInt("id");
--                        int usedid = jsonObject.getInt("userId");
--                        String userName = jsonObject.getString("userName");
--                        String userhead = jsonObject.getString("userHead");
--                        String time = jsonObject.getString("time");
--                        String topic = jsonObject.getString("topic");
--                        String title = jsonObject.getString("title");
--                        String text = jsonObject.getString("text");
--                        int likes = jsonObject.getInt("like");
--                        int comments = jsonObject.getInt("comments");
--                        int forwards = jsonObject.getInt("forwards");
-+                    Log.e("6","6");
-+                    for (int i = 0; i < tipsList.size(); i++){
-+                        Log.e("6","6");
-+                        Map<String ,Object> map = new HashMap<>(i);
-+                        int id = (int) map.get("id");
-+                        int usedid = (int) map.get("userId");
-+                        String userName = (String) map.get("userName");
-+                        String userhead = (String) map.get("userHead");
-+                        String time = (String) map.get("time");
-+                        String topic = (String) map.get("topic");
-+                        String title = (String) map.get("title");
-+                        String text = (String) map.get("text");
-+                        int likes = (int) map.get("like");
-+                        int comments = (int) map.get("comments");
-+                        int forwards = (int) map.get("forwards");
-                         Tips tips = new Tips();
-                         tips.setUserName(userName);
-                         tips.setId(id);
-@@ -337,16 +333,49 @@
-                         tips.setLikes(likes);
-                         tips.setComments(comments);
-                         tips.setForwards(forwards);
--                        Log.e("userid+",jsonObject+"");
-+                        Log.e("userid+",map+"");
-                     }
-+                   // BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(input));
-+                   // StringBuffer stringBuffer = new StringBuffer();
-+                   // String line;
-+                  //  while ((line=bufferedReader.readLine())!=null){
-+                       // stringBuffer.append(line);
-+                   // }
-+                    //JSONArray jsonArray = new JSONArray(stringBuffer.toString());
-+                    //Log.e("9",jsonArray+"");
-+//                    List<Tips> tipsList = new ArrayList<>();
-+//                    for (int i=0;i<jsonArray.length();i++){
-+//                        JSONObject jsonObject = jsonArray.getJSONObject(i);
-+//                        int id = jsonObject.getInt("id");
-+//                        int usedid = jsonObject.getInt("userId");
-+//                        String userName = jsonObject.getString("userName");
-+//                        String userhead = jsonObject.getString("userHead");
-+//                        String time = jsonObject.getString("time");
-+//                        String topic = jsonObject.getString("topic");
-+//                        String title = jsonObject.getString("title");
-+//                        String text = jsonObject.getString("text");
-+//                        int likes = jsonObject.getInt("like");
-+//                        int comments = jsonObject.getInt("comments");
-+//                        int forwards = jsonObject.getInt("forwards");
-+//                        Tips tips = new Tips();
-+//                        tips.setUserName(userName);
-+//                        tips.setId(id);
-+//                        tips.setUserId(usedid);
-+//                        tips.setTime(time);
-+//                        tips.setTopic(topic);
-+//                        tips.setTitle(title);
-+//                        tips.setText(text);
-+//                        tips.setLikes(likes);
-+//                        tips.setComments(comments);
-+//                        tips.setForwards(forwards);
-+//                        Log.e("userid+",jsonObject+"");
-+//                    }
-                 } catch (MalformedURLException e) {
-                     e.printStackTrace();
-                 } catch (ProtocolException e) {
-                     e.printStackTrace();
-                 } catch (IOException e) {
-                     e.printStackTrace();
--                } catch (JSONException e) {
--                    e.printStackTrace();
-                 }
-             }
-         }.start();
Index: .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_15__Default_Changelist_.xml
===================================================================
--- .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_15__Default_Changelist_.xml	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_15__Default_Changelist_.xml	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
@@ -1,4 +0,0 @@
-<changelist name="Uncommitted_changes_before_Update_at_2020_12_3_10_15_[Default_Changelist]" date="1606961786899" recycled="true" deleted="true">
-  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_15_[Default_Changelist]/shelved.patch" />
-  <option name="DESCRIPTION" value="Uncommitted changes before Update at 2020/12/3 10:15 [Default Changelist]" />
-</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_09__Default_Changelist_.xml
===================================================================
--- .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_09__Default_Changelist_.xml	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_09__Default_Changelist_.xml	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
@@ -1,4 +0,0 @@
-<changelist name="Uncommitted_changes_before_Update_at_2020_12_3_10_09_[Default_Changelist]" date="1606961390784" recycled="true" deleted="true">
-  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_09_[Default_Changelist]/shelved.patch" />
-  <option name="DESCRIPTION" value="Uncommitted changes before Update at 2020/12/3 10:09 [Default Changelist]" />
-</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_15_[Default_Changelist]/shelved.patch
===================================================================
--- .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_15_[Default_Changelist]/shelved.patch	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_15_[Default_Changelist]/shelved.patch	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
@@ -1,62 +0,0 @@
-Index: app/src/main/java/com/example/pet/other/Cache.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.pet.other;\r\n\r\nimport com.example.pet.other.entity.User;\r\n\r\npublic class Cache {\r\n    /**\r\n     * 存储一些全局信息\r\n     */\r\n\r\npublic static  User user  ;\r\npublic static final String MY_URL=\"http://10.7.90.249:8080/ChongBaoService\";\r\n\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
---- app/src/main/java/com/example/pet/other/Cache.java	(revision e1d8325ab0a9b24a606299727e4f0c421c9a0cd9)
-+++ app/src/main/java/com/example/pet/other/Cache.java	(date 1606961424741)
-@@ -9,5 +9,5 @@
- 
- public static  User user  ;
- public static final String MY_URL="http://10.7.90.249:8080/ChongBaoService";
--
-+public static String url = "http://172.20.10.2:8080/ChongBao_war_exploded/";
- }
-Index: app/src/main/java/com/example/pet/forum/ForumFragment.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.pet.forum;\r\nimport android.content.Intent;\r\nimport android.graphics.Bitmap;\r\nimport android.media.Image;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.text.TextPaint;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageView;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.ListView;\r\nimport android.widget.PopupWindow;\r\nimport android.widget.RelativeLayout;\r\nimport android.widget.Switch;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport com.example.pet.R;\r\nimport com.example.pet.other.entity.BaseUrl;\r\nimport com.example.pet.other.entity.Tips;\r\nimport com.youth.banner.Banner;\r\nimport com.youth.banner.BannerConfig;\r\nimport com.youth.banner.listener.OnBannerListener;\r\n\r\nimport org.json.JSONArray;\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\nimport java.io.BufferedReader;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.io.InputStreamReader;\r\nimport java.net.HttpURLConnection;\r\nimport java.net.MalformedURLException;\r\nimport java.net.ProtocolException;\r\nimport java.net.URL;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class ForumFragment extends Fragment {\r\n\r\n    private EditText et_search;\r\n    private Button btn_search;\r\n    private Button btn_publish;\r\n    private RelativeLayout forum_food;\r\n    private RelativeLayout forum_articles;\r\n    private RelativeLayout forum_daily;\r\n    private RelativeLayout forum_cosmetology;\r\n    private RelativeLayout forum_train;\r\n    private RelativeLayout forum_deworming;\r\n    private RelativeLayout forum_disease;\r\n    private RelativeLayout forum_randomtalk;\r\n    private RelativeLayout forum_question;\r\n    private RelativeLayout forum_sharephotos;\r\n    private TextView tv_newest;\r\n    private TextView tv_hot;\r\n    private TextView tv_essence;\r\n    private ListView lv_tips;\r\n    private Banner banner;\r\n    private ArrayList<Tips> arrayList = new ArrayList<>();\r\n    private ArrayList<Tips> tipsArrayList;\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(@NonNull final LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\r\n        View view = inflater.inflate(R.layout.fragment_forum,container,false);\r\n        init();\r\n        et_search = view.findViewById(R.id.et_main_search);\r\n        btn_search = view.findViewById(R.id.btn_main_search);\r\n        btn_search.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n\r\n            }\r\n        });\r\n        btn_publish = view.findViewById(R.id.btn_publish_articles);\r\n        btn_publish.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),PublishActivity.class);\r\n                startActivity(intent);\r\n                getActivity().finish();\r\n            }\r\n        });\r\n        forum_food = view.findViewById(R.id.forum_food);\r\n        forum_food.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_articles = view.findViewById(R.id.forum_articles);\r\n        forum_articles.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_daily = view.findViewById(R.id.forum_daily);\r\n        forum_daily.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_cosmetology = view.findViewById(R.id.forum_cosmetology);\r\n        forum_cosmetology.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_train = view.findViewById(R.id.forum_train);\r\n        forum_train.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_deworming = view.findViewById(R.id.forum_deworming);\r\n        forum_deworming.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_disease = view.findViewById(R.id.forum_disease);\r\n        forum_disease.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_randomtalk = view.findViewById(R.id.forum_randomtalk);\r\n        forum_randomtalk.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_question = view.findViewById(R.id.forum_question);\r\n        forum_question.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_sharephotos = view.findViewById(R.id.forum_sharephotos);\r\n        forum_sharephotos.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        tv_newest = view.findViewById(R.id.forum_newest);\r\n        TextPaint base = tv_newest.getPaint();\r\n        base.setFakeBoldText(true);\r\n        tv_hot = view.findViewById(R.id.forum_hot);\r\n        tv_essence = view.findViewById(R.id.forum_essence);\r\n        tv_newest.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                tv_newest.setBackgroundColor(getResources().getColor(R.color.Blue));\r\n                tv_hot.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_essence.setBackgroundColor(getResources().getColor(R.color.White));\r\n                TextPaint newest = tv_newest.getPaint();\r\n                newest.setFakeBoldText(true);\r\n                TextPaint hot = tv_hot.getPaint();\r\n                hot.setFakeBoldText(false);\r\n                TextPaint essence = tv_essence.getPaint();\r\n                essence.setFakeBoldText(false);\r\n            }\r\n        });\r\n        tv_hot.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                tv_newest.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_hot.setBackgroundColor(getResources().getColor(R.color.Orange));\r\n                tv_essence.setBackgroundColor(getResources().getColor(R.color.White));\r\n                TextPaint newest = tv_newest.getPaint();\r\n                newest.setFakeBoldText(false);\r\n                TextPaint hot = tv_hot.getPaint();\r\n                hot.setFakeBoldText(true);\r\n                TextPaint essence = tv_essence.getPaint();\r\n                essence.setFakeBoldText(false);\r\n            }\r\n        });\r\n        tv_essence.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                tv_newest.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_hot.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_essence.setBackgroundColor(getResources().getColor(R.color.Purple));\r\n                TextPaint newest = tv_newest.getPaint();\r\n                newest.setFakeBoldText(false);\r\n                TextPaint hot = tv_hot.getPaint();\r\n                hot.setFakeBoldText(false);\r\n                TextPaint essence = tv_essence.getPaint();\r\n                essence.setFakeBoldText(true);\r\n            }\r\n        });\r\n\r\n\r\n        ArrayList<Integer> images = new ArrayList<>();\r\n        ArrayList<String> title = new ArrayList<>();\r\n        title.add(\"新手推荐文章1\");\r\n        title.add(\"新手推荐文章2\");\r\n        title.add(\"新手推荐文章3\");\r\n        title.add(\"新手推荐文章4\");\r\n        title.add(\"新手推荐文章5\");\r\n        images.add(R.drawable.recommend1);\r\n        images.add(R.drawable.recommend2);\r\n        images.add(R.drawable.recommend3);\r\n        images.add(R.drawable.recommend4);\r\n        images.add(R.drawable.recommend5);\r\n\r\n        banner = view.findViewById(R.id.banner);\r\n        banner.setBannerStyle(BannerConfig.CIRCLE_INDICATOR_TITLE_INSIDE);\r\n        banner.setBannerTitles(title);\r\n        banner.setImageLoader(new GlideImageLoader());\r\n        banner.setImages(images);\r\n        banner.start();\r\n\r\n        banner.setOnBannerListener(new OnBannerListener() {\r\n            @Override\r\n            public void OnBannerClick(int position) {\r\n                Intent intent;\r\n                switch (position){\r\n                    case 0:\r\n                        intent = new Intent(getContext(),TipsActivity.class);\r\n                        startActivity(intent);\r\n                        break;\r\n                    case 1:\r\n                        intent = new Intent(getContext(),TipsActivity.class);\r\n                        startActivity(intent);\r\n                        break;\r\n                    case 2:\r\n                        intent = new Intent(getContext(),TipsActivity.class);\r\n                        startActivity(intent);\r\n                        break;\r\n                }\r\n                Log.e(\"点击了第几张轮播图:\",position+\"\");\r\n            }\r\n        });\r\n\r\n        lv_tips = view.findViewById(R.id.lv_tips);\r\n//        for (int i = 0; i < 5; i++) {\r\n//            Tips tips = new Tips();\r\n//            tips.setId(1);\r\n//            tips.setUserName(\"名字\" + i);\r\n//            tips.setTime(\"2020-11-28/16:36:0\" + i);\r\n//            tips.setTopic(\"标签\" + i);\r\n//            tips.setTitle(\"标题\" + i);\r\n//            tips.setText(\"正文\" + i);\r\n//            arrayList.add(tips);\r\n//        }\r\n        MainForumTipsAdapter mainForumTipsAdapter = new MainForumTipsAdapter(getContext(),arrayList,R.layout.forum_tips_item);\r\n        lv_tips.setAdapter(mainForumTipsAdapter);\r\n        return view;\r\n    }\r\n\r\n    public void init(){\r\n        new Thread(){\r\n            @Override\r\n            public void run() {\r\n                try {\r\n                    URL url = new URL(\"http:10.7.90.222:8080/ChongBao_war_exploded/GetAllPostServlet\");\r\n                    HttpURLConnection connection = (HttpURLConnection) url.openConnection();\r\n                    connection.setRequestMethod(\"GET\");\r\n                    InputStream input = connection.getInputStream();\r\n                    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(input));\r\n                    StringBuffer stringBuffer = new StringBuffer();\r\n                    String line;\r\n                    while ((line=bufferedReader.readLine())!=null){\r\n                        stringBuffer.append(line);\r\n                    }\r\n                    JSONArray jsonArray = new JSONArray(stringBuffer.toString());\r\n                    tipsArrayList = new ArrayList<>();\r\n                    for (int i=0;i<jsonArray.length();i++){\r\n                        JSONObject jsonObject = jsonArray.getJSONObject(i);\r\n                        String post_title = jsonObject.getString(\"post_title\");\r\n                        String post_time = jsonObject.getString(\"post_time\");\r\n                        String post_text = jsonObject.getString(\"post_text\");\r\n                        String name = jsonObject.getString(\"name\");\r\n                        String user_name = jsonObject.getString(\"user_name\");\r\n                        Tips tips = new Tips();\r\n                        tips.setTitle(post_title);\r\n                        tips.setText(post_text);\r\n                        tips.setTime(post_time);\r\n                        tips.setUserName(user_name);\r\n                        arrayList.add(tips);\r\n                    }\r\n                } catch (MalformedURLException e) {\r\n                    e.printStackTrace();\r\n                } catch (ProtocolException e) {\r\n                    e.printStackTrace();\r\n                } catch (IOException e) {\r\n                    e.printStackTrace();\r\n                } catch (JSONException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            }\r\n        }.start();\r\n    }\r\n\r\n    public void search(){\r\n        new Thread(){\r\n            @Override\r\n            public void run() {\r\n                String search = et_search.getText().toString();\r\n            }\r\n        };\r\n    }\r\n\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
---- app/src/main/java/com/example/pet/forum/ForumFragment.java	(revision e1d8325ab0a9b24a606299727e4f0c421c9a0cd9)
-+++ app/src/main/java/com/example/pet/forum/ForumFragment.java	(date 1606961735808)
-@@ -24,7 +24,7 @@
- import androidx.fragment.app.Fragment;
- 
- import com.example.pet.R;
--import com.example.pet.other.entity.BaseUrl;
-+import com.example.pet.other.Cache;
- import com.example.pet.other.entity.Tips;
- import com.youth.banner.Banner;
- import com.youth.banner.BannerConfig;
-@@ -293,7 +293,8 @@
-             @Override
-             public void run() {
-                 try {
--                    URL url = new URL("http:10.7.90.222:8080/ChongBao_war_exploded/GetAllPostServlet");
-+                    URL url = new URL(Cache.url + "GetAllPostServlet");
-+                    Log.e("123","123");
-                     HttpURLConnection connection = (HttpURLConnection) url.openConnection();
-                     connection.setRequestMethod("GET");
-                     InputStream input = connection.getInputStream();
-@@ -303,6 +304,7 @@
-                     while ((line=bufferedReader.readLine())!=null){
-                         stringBuffer.append(line);
-                     }
-+                    Log.e("123","123");
-                     JSONArray jsonArray = new JSONArray(stringBuffer.toString());
-                     tipsArrayList = new ArrayList<>();
-                     for (int i=0;i<jsonArray.length();i++){
-Index: app/src/main/java/com/example/pet/other/entity/BaseUrl.java
-===================================================================
---- app/src/main/java/com/example/pet/other/entity/BaseUrl.java	(revision e1d8325ab0a9b24a606299727e4f0c421c9a0cd9)
-+++ app/src/main/java/com/example/pet/other/entity/BaseUrl.java	(revision e1d8325ab0a9b24a606299727e4f0c421c9a0cd9)
-@@ -1,5 +0,0 @@
--package com.example.pet.other.entity;
--
--public class BaseUrl {
--    public static String url = "http://192.168.43.227:8080//LovePet/";
--}
Index: app/src/main/java/com/example/pet/other/Cache.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.other;\r\n\r\nimport com.example.pet.other.entity.Order;\r\nimport com.example.pet.other.entity.Pet;\r\nimport com.example.pet.other.entity.Tips;\r\nimport com.example.pet.other.entity.User;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.HashSet;\r\nimport java.util.List;\r\n\r\npublic class Cache {\r\n    /**\r\n     * 存储一些全局信息\r\n     */\r\n    public static User user;\r\n    public static String userPhone;\r\n    public static final String MY_URL = \"http://10.7.90.249:8080/ChongBaoService/\";//我的URL\r\n    public static String url = \"http://10.7.89.96:8080/ChongBao_war_exploded/\";\r\n    public static int user_id = 1;\r\n    public static List<Order> myOrderList;//我的订单数据\r\n    public static List<Pet> myPetList;//我的宠物数据\r\n    public static ArrayList<Tips> myPostList;//我的帖子数据\r\n    public static HashSet<User> userHashSet = new HashSet<>();//用户列表\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/other/Cache.java	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ app/src/main/java/com/example/pet/other/Cache.java	(date 1607598125720)
@@ -15,7 +15,7 @@
      */
     public static User user;
     public static String userPhone;
-    public static final String MY_URL = "http://10.7.90.249:8080/ChongBaoService/";//我的URL
+    public static final String MY_URL = "http://10.7.86.121:8080/";//我的URL
     public static String url = "http://10.7.89.96:8080/ChongBao_war_exploded/";
     public static int user_id = 1;
     public static List<Order> myOrderList;//我的订单数据
Index: app/src/main/java/com/example/pet/my/PageFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.my;\r\n\r\nimport android.app.Activity;\r\nimport android.content.Intent;\r\nimport android.content.pm.PackageManager;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.BitmapFactory;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\nimport android.os.Message;\r\nimport android.text.Editable;\r\nimport android.text.TextWatcher;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageView;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.core.app.ActivityCompat;\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport com.bigkoo.pickerview.builder.OptionsPickerBuilder;\r\nimport com.bigkoo.pickerview.listener.CustomListener;\r\nimport com.bigkoo.pickerview.listener.OnOptionsSelectListener;\r\nimport com.bigkoo.pickerview.view.OptionsPickerView;\r\nimport com.bumptech.glide.Glide;\r\nimport com.example.pet.R;\r\nimport com.example.pet.my.editinfo.Const;\r\nimport com.example.pet.my.editinfo.EditInfo;\r\nimport com.example.pet.my.editinfo.GlideEngine;\r\nimport com.example.pet.other.Cache;\r\nimport com.example.pet.other.entity.Pet;\r\nimport com.google.gson.Gson;\r\nimport com.luck.picture.lib.PictureSelector;\r\nimport com.luck.picture.lib.config.PictureConfig;\r\nimport com.luck.picture.lib.config.PictureMimeType;\r\nimport com.luck.picture.lib.entity.LocalMedia;\r\n\r\nimport java.io.File;\r\nimport java.io.FileNotFoundException;\r\nimport java.io.IOException;\r\nimport java.util.ArrayList;\r\nimport java.util.Calendar;\r\nimport java.util.List;\r\n\r\nimport okhttp3.Call;\r\nimport okhttp3.Callback;\r\nimport okhttp3.MediaType;\r\nimport okhttp3.MultipartBody;\r\nimport okhttp3.OkHttpClient;\r\nimport okhttp3.Request;\r\nimport okhttp3.RequestBody;\r\nimport okhttp3.Response;\r\n\r\npublic class PageFragment extends Fragment {\r\n\r\n    private ImageView petPhoto;\r\n    private EditText petName;\r\n    private TextView petType;\r\n    private TextView petAge;\r\n    private EditText petAutograph;\r\n    private Button btnUpdate;\r\n    private TextView tvNum;\r\n    private int index;\r\n    private Pet pet;\r\n    private int agex;\r\n\r\n\r\n    private OptionsPickerView pvAgeOptions;\r\n    private OptionsPickerView pvTypeOptions;\r\n    private ArrayList<Integer> ageItem = new ArrayList<>();\r\n    private ArrayList<String> typeItem = new ArrayList<>();\r\n    //输入框初始值\r\n    private int num = 0;\r\n    //输入框最大值\r\n    public int mMaxNum=200;\r\n    private String image_path;\r\n    private static final int REQUEST_EXTERNAL_STORAGE = 1;\r\n    private static String[] PERMISSIONS_STORAGE = {\r\n            \"android.permission.READ_EXTERNAL_STORAGE\",\r\n            \"android.permission.WRITE_EXTERNAL_STORAGE\",\r\n            \"android.permission.CAMER\"};\r\n\r\n    Handler hd = new Handler() {\r\n        @Override\r\n        public void handleMessage(Message msg) {\r\n            if(msg.what == 1){\r\n                Toast.makeText(getContext(),\"上传成功\",Toast.LENGTH_SHORT);\r\n                upData();\r\n            }else if(msg.what == 2){\r\n                Log.e(\"up\",\"6b\");\r\n                Toast.makeText(getContext(),\"上传失败了\",Toast.LENGTH_SHORT);\r\n            }else if(msg.what == 3){\r\n                Toast.makeText(getContext(),\"上传成功\",Toast.LENGTH_SHORT);\r\n            }else if(msg.what == 4) {\r\n                Log.e(\"up\",\"6b\");\r\n                Toast.makeText(getContext(),\"上传失败了\",Toast.LENGTH_SHORT);\r\n            }else if(msg.what == 5){\r\n                Uri uri = Uri.parse(msg.obj.toString());\r\n                Cache.myPetList.get(index).setPicturePath(image_path);\r\n//                try {\r\n//                    Bitmap bitmap = BitmapFactory.decodeStream(getContext().getContentResolver().openInputStream(Uri.parse(image_path)));\r\n//                    Cache.myPetList.get(index).setPicture(bitmap);\r\n//                    petPhoto.setImageBitmap(bitmap);\r\n//                } catch (FileNotFoundException e) {\r\n//                    e.printStackTrace();\r\n//                }\r\n                petPhoto.setImageURI(uri);\r\n            }else if(msg.what == 6) {\r\n                Log.e(\"up\",\"6b\");\r\n                Toast.makeText(getContext(),\"上传失败了\",Toast.LENGTH_SHORT);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * 上传图片\r\n     * 未测试\r\n     */\r\n    public void upPhoto(String path) {\r\n        Log.e(\"up\", \"1\");\r\n        File file = new File(path);\r\n        Log.e(\"up\", \"2\");\r\n        String url = Cache.MY_URL + \"UpDataPetInfoServlet\";\r\n        OkHttpClient okHttpClient = new OkHttpClient();\r\n        if (file != null && file.exists()) {\r\n            RequestBody requestBody = new MultipartBody.Builder()\r\n                    .setType(MultipartBody.FORM)\r\n                    .addFormDataPart(\"file\",\r\n                            Cache.userPhone + Cache.myPetList.get(0).getPetId() + \".jpg\",\r\n                            RequestBody.create(MediaType.parse(\"image/png\"), file))\r\n                    .build();\r\n            Request request = new Request.Builder()\r\n                    .url(url)\r\n                    .post(requestBody)\r\n                    .build();\r\n            Call call = okHttpClient.newCall(request);\r\n\r\n            Log.e(\"up\", \"3\");\r\n            call.enqueue(new Callback() {\r\n                @Override\r\n                public void onFailure(Call call, IOException e) {\r\n                    //失败\r\n                    Log.e(\"up\", \"4b\");\r\n                    Message msg = new Message();\r\n                    msg.what = 2;\r\n                    msg.obj = 1;\r\n                    Log.e(\"up\", \"5b\");\r\n                    hd.sendMessage(msg);\r\n                    Log.e(\"up\", \"6b\");\r\n                    e.printStackTrace();\r\n                }\r\n\r\n                @Override\r\n                public void onResponse(Call call, Response response) throws IOException {\r\n                    //上传成功\r\n                    Log.e(\"up\", \"4a\");\r\n                    Message msg = new Message();\r\n                    String res = response.body().string();\r\n                    if (res.equals(\"true\")) {\r\n                        msg.what = 1;\r\n                        msg.obj = 1;\r\n                        Log.e(\"updata\", res);\r\n                    } else {\r\n                        msg.what = 2;\r\n                        msg.obj = 1;\r\n                        Log.e(\"updata\", res);\r\n                    }\r\n                    hd.sendMessage(msg);\r\n\r\n                }\r\n            });\r\n\r\n        } else {\r\n            Toast.makeText(getActivity(), \"请添加头像\", Toast.LENGTH_SHORT);\r\n        }\r\n    }\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\r\n        View view = inflater.inflate(R.layout.activity_pet, container, false);\r\n        Bundle bundle = getArguments();\r\n        index = bundle.getInt(\"index\");\r\n        //设置\r\n        pet = new Pet();\r\n        initAge();\r\n        initType();\r\n        MyListener myListener = new MyListener();\r\n        LinearLayout llAge = view.findViewById(R.id.ll_pet_age);\r\n        llAge.setOnClickListener(myListener);\r\n        LinearLayout llType = view.findViewById(R.id.ll_pet_type);\r\n        llType.setOnClickListener(myListener);\r\n        Log.e(\"upAge\",\"绑定成功\");\r\n        petPhoto = view.findViewById(R.id.pet_photo);\r\n        petPhoto.setOnClickListener(myListener);\r\n        petName = view.findViewById(R.id.pet_name);\r\n        petType = view.findViewById(R.id.pet_type);\r\n        petAge = view.findViewById(R.id.pet_age);\r\n        petAutograph = view.findViewById(R.id.pet_autograph);\r\n        btnUpdate = view.findViewById(R.id.pet_update);\r\n        tvNum = view.findViewById(R.id.tv_input);\r\n        btnUpdate.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n//                upData();\r\n                if(image_path != null){\r\n                    upPhoto(image_path);\r\n                }else {\r\n                    upData();\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n        setViewContent();\r\n//        countWords();\r\n        return view;\r\n    }\r\n\r\n    private void upData() {\r\n        String type = petType.getText().toString();\r\n//        String age = petAge.getText().toString();\r\n        String autograph = petAutograph.getText().toString();\r\n        String name = petName.getText().toString();\r\n        Log.e(\"type:\",type);\r\n        Log.e(\"age\",agex+\"岁\");\r\n        Log.e(\"autogragh:\",autograph);\r\n        Log.e(\"name:\",name);\r\n        if(image_path != null &&  type != null && agex != 0 && autograph != null && name != null){\r\n            //发送\r\n            pet.setPetId(Cache.myPetList.get(index).getPetId());\r\n            pet.setPicturePath(Cache.userPhone + Cache.myPetList.get(index).getPetId()+ \".jpg\");\r\n            pet.setPetType(type);\r\n            pet.setPetAutograph(autograph);\r\n            pet.setPetName(name);\r\n            pet.setPetAge(agex);\r\n            Log.e(\"pet\",pet.toString());\r\n            OkHttpClient okHttpClient = new OkHttpClient();\r\n\r\n            RequestBody requestBody = RequestBody.create(MediaType.parse(\r\n                    \"text/plain;charset=UTF-8\"),new Gson().toJson(pet));\r\n            //3.创建请求对象\r\n            Request request = new Request.Builder()\r\n                    .post(requestBody)\r\n                    .url(Cache.MY_URL + \"UpDataPetInfo2Servlet\")\r\n                    .build();\r\n            //3.创建Call对象，发送请求，并接受响应\r\n            Call call = okHttpClient.newCall(request);\r\n            //异步网络请求（无需手动使用子线程）\r\n            call.enqueue(new Callback() {\r\n                @Override\r\n                public void onFailure(Call call, IOException e) {\r\n                    //失败\r\n                    Message msg = new Message();\r\n                    msg.what = 4;\r\n                    msg.obj = 3;\r\n                    Log.e(\"up\",\"5b\");\r\n                    hd.sendMessage(msg);\r\n                    Log.e(\"up\",\"6b\");\r\n                    e.printStackTrace();\r\n                }\r\n\r\n                @Override\r\n                public void onResponse(Call call, Response response) throws IOException {\r\n                    //上传成功\r\n                    Message msg = new Message();\r\n                    String res = response.body().string();\r\n                    if(res.equals(\"true\")){\r\n                        msg.what = 3;\r\n                        msg.obj = 1;\r\n                        Log.e(\"updata\",res);\r\n                    }else {\r\n                        msg.what = 2;\r\n                        msg.obj = 1;\r\n                        Log.e(\"updata\",res);\r\n                    }\r\n                    hd.sendMessage(msg);\r\n\r\n                }\r\n            });\r\n        }else {\r\n            Toast.makeText(getActivity(),\"有信息未填，请填写！\",Toast.LENGTH_SHORT);\r\n        }\r\n    }\r\n\r\n    public void setViewContent() {\r\n        petAutograph.setText(Cache.myPetList.get(index).getPetAutograph(), TextView.BufferType.EDITABLE);\r\n        petPhoto.setImageBitmap(Cache.myPetList.get(index).getPicture());\r\n        petName.setText(Cache.myPetList.get(index).getPetName(), TextView.BufferType.EDITABLE);\r\n        petType.setText(Cache.myPetList.get(index).getPetType(), TextView.BufferType.EDITABLE);\r\n        agex = Cache.myPetList.get(0).getPetAge();\r\n        petAge.setText(agex + \"岁\", TextView.BufferType.EDITABLE);\r\n\r\n    }\r\n\r\n    public class MyListener implements View.OnClickListener {\r\n\r\n        @Override\r\n        public void onClick(View v) {\r\n            switch (v.getId()){\r\n                case R.id.ll_pet_type:\r\n                    pvTypeOptions.show();\r\n                    break;\r\n                case R.id.ll_pet_age:\r\n                    pvAgeOptions.show();\r\n                    Log.e(\"upAge\",\"over\");\r\n                    break;\r\n                case R.id.pet_photo:\r\n                    upPic();\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    private void upType() {\r\n        // 注意：自定义布局中，id为 optionspicker 或者 timepicker 的布局以及其子控件必须要有，否则会报空指针\r\n        // 具体可参考demo 里面的两个自定义布局\r\n        Log.e(\"upAge\",\"start\");\r\n        pvTypeOptions = new OptionsPickerBuilder(getActivity(), new OnOptionsSelectListener() {\r\n            @Override\r\n            public void onOptionsSelect(int options1, int options2, int options3, View v) {\r\n                //返回的分别是三个级别的选中位置\r\n                String tx = typeItem.get(options1);\r\n                petType.setText(tx);\r\n            }\r\n        })\r\n                .setLayoutRes(R.layout.picker_sex_bg, new CustomListener() {\r\n                    @Override\r\n                    public void customLayout(View v) {\r\n                        //自定义布局中的控件初始化及事件处理\r\n                        final TextView tvSubmit = v.findViewById(R.id.tv_finish);\r\n                        TextView tvCancel = v.findViewById(R.id.tv_cancel);\r\n                        TextView tyTitle = v.findViewById(R.id.tv_title);\r\n                        tyTitle.setText(\"宠物年龄\");\r\n                        tvSubmit.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvTypeOptions.returnData();\r\n                                pvTypeOptions.dismiss();\r\n                            }\r\n                        });\r\n                        tvCancel.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvTypeOptions.dismiss();\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                })\r\n                .setLineSpacingMultiplier(1.5f)//滚轮字体间距\r\n                .setContentTextSize(22)//字体大小\r\n                .setOutSideCancelable(true)\r\n                .build();\r\n        pvTypeOptions.setPicker(typeItem);//添加数据\r\n    }\r\n\r\n    private void upAge() {\r\n        // 注意：自定义布局中，id为 optionspicker 或者 timepicker 的布局以及其子控件必须要有，否则会报空指针\r\n        // 具体可参考demo 里面的两个自定义布局\r\n        Log.e(\"upAge\",\"start\");\r\n        pvAgeOptions = new OptionsPickerBuilder(getActivity(), new OnOptionsSelectListener() {\r\n            @Override\r\n            public void onOptionsSelect(int options1, int options2, int options3, View v) {\r\n                //返回的分别是三个级别的选中位置\r\n                int tx = ageItem.get(options1);\r\n                petAge.setText(tx + \"岁\");\r\n                agex = tx;\r\n            }\r\n        })\r\n                .setLayoutRes(R.layout.picker_sex_bg, new CustomListener() {\r\n                    @Override\r\n                    public void customLayout(View v) {\r\n                        //自定义布局中的控件初始化及事件处理\r\n                        final TextView tvSubmit = v.findViewById(R.id.tv_finish);\r\n                        TextView tvCancel = v.findViewById(R.id.tv_cancel);\r\n                        TextView tyTitle = v.findViewById(R.id.tv_title);\r\n                        tyTitle.setText(\"宠物年龄\");\r\n                        tvSubmit.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvAgeOptions.returnData();\r\n                                pvAgeOptions.dismiss();\r\n                            }\r\n                        });\r\n                        tvCancel.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvAgeOptions.dismiss();\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                })\r\n                .setLineSpacingMultiplier(1.5f)//滚轮字体间距\r\n                .setContentTextSize(22)//字体大小\r\n                .setOutSideCancelable(true)\r\n                .build();\r\n        pvAgeOptions.setPicker(ageItem);//添加数据\r\n    }\r\n\r\n    public void initAge(){\r\n        for(int i = 1;i < 30;i++){\r\n            ageItem.add(i);\r\n        }\r\n    }\r\n    public void initType(){\r\n        typeItem.add(\"哈士奇\");\r\n        typeItem.add(\"兔子\");\r\n        typeItem.add(\"加菲猫\");\r\n        typeItem.add(\"小白鼠\");\r\n        typeItem.add(\"无皮猫\");\r\n        typeItem.add(\"土狗\");\r\n        typeItem.add(\"仓鼠\");\r\n    }\r\n    /**\r\n     * 记录字数和限制最大输入字数\r\n     */\r\n//    private void countWords() {\r\n//        petAutograph.addTextChangedListener(new TextWatcher() {\r\n//            //记录输入的字数\r\n//            private CharSequence wordNum;\r\n//            private int selectionStart;\r\n//            private int selectionEnd;\r\n//            @Override\r\n//            public void beforeTextChanged(CharSequence s, int start, int count, int after) {\r\n//\r\n//            }\r\n//\r\n//            @Override\r\n//            public void onTextChanged(CharSequence s, int start, int before, int count) {\r\n//                //实时记录输入的字数\r\n//                wordNum= s;\r\n//            }\r\n//\r\n//            @Override\r\n//            public void afterTextChanged(Editable s) {\r\n//\r\n//                Cache.user.setUserAutograph(Cache.user.getUserAutograph() + s);\r\n//                int number = num + s.length();\r\n//                //TextView显示剩余字数\r\n//                petAutograph.setText(\"\" + number+\"/\" + mMaxNum);\r\n//                selectionStart=tvNum.getSelectionStart();\r\n//                selectionEnd = tvNum.getSelectionEnd();\r\n//                //判断大于最大值\r\n//                if (wordNum.length() > mMaxNum) {\r\n//                    //删除多余输入的字（不会显示出来）\r\n//                    s.delete(selectionStart - 1, selectionEnd);\r\n//                    int tempSelection = selectionEnd;\r\n//                    petAutograph.setText(s);\r\n//                    petAutograph.setSelection(tempSelection);//设置光标在最后\r\n//                    //吐司最多输入300字\r\n//                    Toast.makeText(getContext(), \"最多输入\"+mMaxNum+\"字\", Toast.LENGTH_SHORT).show();\r\n//\r\n//                }\r\n//            }\r\n//        });\r\n//    }\r\n\r\n    /**\r\n     * 添加相片\r\n     */\r\n    private void upPic() {\r\n        //动态申请权限\r\n        verifyStoragePermissions(getActivity());\r\n        PictureSelector.create(PageFragment.this)\r\n                .openGallery(PictureConfig.TYPE_IMAGE)\r\n                .imageEngine(GlideEngine.createGlideEngine())\r\n                .imageSpanCount(4)// 每行显示个数 int\r\n                .maxSelectNum(1)\r\n                .isWeChatStyle(true)\r\n                .selectionMode(PictureConfig.SINGLE)// 多选 or 单选 PictureConfig.MULTIPLE or PictureConfig.SINGLE\r\n                .isSingleDirectReturn(true)//PictureConfig.SINGLE模式下是否直接返回\r\n                .isPreviewImage(true)// 是否可预览图片 true or false\r\n                .isCamera(true)// 是否显示拍照按钮 true or false\r\n                .imageFormat(PictureMimeType.JPEG)// 拍照保存图片格式后缀,默认jpeg\r\n                .isZoomAnim(true)// 图片列表点击 缩放效果 默认true\r\n                .setOutputCameraPath(Const.getImgPath())// 自定义拍照保存路径,可不填\r\n                .isEnableCrop(true)// 是否裁剪 true or false\r\n                .isCompress(true)// 是否压缩 true or false\r\n                .compressSavePath(Const.getImgPath())//压缩图片保存地址\r\n                .freeStyleCropEnabled(true)// 裁剪框是否可拖拽 true or false\r\n                .showCropGrid(true)// 是否显示裁剪矩形网格 圆形裁剪时建议设为false    true or false\r\n                .synOrAsy(false)\r\n                .forResult(PictureConfig.CHOOSE_REQUEST);//结果回调onActivityResult code\r\n    }\r\n\r\n    //接受回调\r\n    @Override\r\n    public void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        if (resultCode == -1 && data != null) {\r\n            switch (requestCode) {\r\n                case PictureConfig.CHOOSE_REQUEST:\r\n                    List<LocalMedia> selectList = PictureSelector.obtainMultipleResult(data);\r\n                    image_path = selectList.get(0).getCompressPath();\r\n                    Message msg = new Message();\r\n                    msg.what = 5;\r\n                    msg.obj = image_path;\r\n                    hd.sendMessage(msg);\r\n                    Log.e(\"image_path\",image_path);\r\n                    //上传图片\r\n                    Cache.myPetList.get(index).setPicturePath(image_path);\r\n//                    Cache.user.setPicturePath(image_path);\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    //然后通过一个函数来申请权限\r\n    public static void verifyStoragePermissions(Activity activity) {\r\n        try {\r\n            //检测是否有写的权限\r\n            int permission = ActivityCompat.checkSelfPermission(activity,\r\n                    \"android.permission.WRITE_EXTERNAL_STORAGE\");\r\n            if (permission != PackageManager.PERMISSION_GRANTED) {\r\n                // 没有写的权限，去申请写的权限，会弹出对话框\r\n                ActivityCompat.requestPermissions(activity, PERMISSIONS_STORAGE,REQUEST_EXTERNAL_STORAGE);\r\n            }\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n    @Override\r\n    public void onStart() {\r\n        super.onStart();\r\n        setViewContent();\r\n    }\r\n\r\n    /**\r\n     * 上传数据\r\n     */\r\n//    public void upData(){\r\n//        OkHttpClient okHttpClient = new OkHttpClient();\r\n//        //创建请求体对象\r\n//        Cache.user.setUserPhone(Cache.userPhone);\r\n//        String name = petName.getText().toString();\r\n//        if(name == null){\r\n//            pet.setPetName(\"\");\r\n//        }else {\r\n//            pet.setPetName(name);\r\n//        }\r\n//        String autograph = petAutograph.getText().toString();\r\n//        if(autograph == null){\r\n//            pet.setPetAutograph(\"\");\r\n//        }else {\r\n//            pet.setPetAutograph(autograph);\r\n//        }\r\n//        String path = Cache.myPetList.get(0).getPetPicPath();\r\n//        if(path == null){\r\n//            pet.setPetPicPath(\"\");\r\n//        }else {\r\n//            pet.setPetPicPath(path);\r\n//        }\r\n//        String age = petAge.getText().toString();\r\n//        if(age == null){\r\n//            pet.getPetAge(\"未知\");\r\n//        }else {\r\n//            pet.getPetAge(age);\r\n//        }\r\n//        String brithday = upBrithday.getText().toString();\r\n//        if(brithday == null){\r\n//            Calendar selectedDate = Calendar.getInstance();//系统当前时间\r\n//            user.setUserBrithday(getTimes(selectedDate.getTime()));\r\n//        }else {\r\n//            user.setUserBrithday(brithday);\r\n//        }\r\n//\r\n//        RequestBody requestBody = RequestBody.create(MediaType.parse(\r\n//                \"text/plain;charset=UTF-8\"),new Gson().toJson(user));\r\n//        //3.创建请求对象\r\n//        Request request = new Request.Builder()\r\n//                .post(requestBody)\r\n//                .url(Cache.MY_URL + \"UpDataUserInfo2Servlet\")\r\n//                .build();\r\n//        //3.创建Call对象，发送请求，并接受响应\r\n//        Call call = okHttpClient.newCall(request);\r\n//        //异步网络请求（无需手动使用子线程）\r\n//        call.enqueue(new Callback() {\r\n//            @Override\r\n//            public void onFailure(Call call, IOException e) {\r\n//                //失败\r\n//                Message msg = new Message();\r\n//                msg.what = 4;\r\n//                msg.obj = 3;\r\n//                Log.e(\"up\",\"5b\");\r\n//                hd.sendMessage(msg);\r\n//                Log.e(\"up\",\"6b\");\r\n//                e.printStackTrace();\r\n//            }\r\n//\r\n//            @Override\r\n//            public void onResponse(Call call, Response response) throws IOException {\r\n//                //上传成功\r\n//                Message msg = new Message();\r\n//                String res = response.body().string();\r\n//                if(res.equals(\"true\")){\r\n//                    msg.what = 3;\r\n//                    msg.obj = 1;\r\n//                    Log.e(\"updata\",res);\r\n//                }else {\r\n//                    msg.what = 2;\r\n//                    msg.obj = 1;\r\n//                    Log.e(\"updata\",res);\r\n//                }\r\n//                hd.sendMessage(msg);\r\n//\r\n//            }\r\n//        });\r\n//    }\r\n    @Override\r\n    public void onResume() {\r\n        super.onResume();\r\n        upAge();\r\n        upType();\r\n//        setViewContent();\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/my/PageFragment.java	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ app/src/main/java/com/example/pet/my/PageFragment.java	(date 1607603613886)
@@ -72,6 +72,7 @@
     private int index;
     private Pet pet;
     private int agex;
+    private Bitmap bitmap;
 
 
     private OptionsPickerView pvAgeOptions;
@@ -105,15 +106,9 @@
                 Toast.makeText(getContext(),"上传失败了",Toast.LENGTH_SHORT);
             }else if(msg.what == 5){
                 Uri uri = Uri.parse(msg.obj.toString());
-                Cache.myPetList.get(index).setPicturePath(image_path);
-//                try {
-//                    Bitmap bitmap = BitmapFactory.decodeStream(getContext().getContentResolver().openInputStream(Uri.parse(image_path)));
-//                    Cache.myPetList.get(index).setPicture(bitmap);
-//                    petPhoto.setImageBitmap(bitmap);
-//                } catch (FileNotFoundException e) {
-//                    e.printStackTrace();
-//                }
-                petPhoto.setImageURI(uri);
+                bitmap = BitmapFactory.decodeFile(image_path);
+                petPhoto.setImageBitmap(bitmap);
+                //                petPhoto.setImageURI(uri);
             }else if(msg.what == 6) {
                 Log.e("up","6b");
                 Toast.makeText(getContext(),"上传失败了",Toast.LENGTH_SHORT);
@@ -126,6 +121,8 @@
      * 未测试
      */
     public void upPhoto(String path) {
+        Cache.myPetList.get(index).setPicturePath(image_path);
+        Cache.myPetList.get(index).setPicture(bitmap);
         Log.e("up", "1");
         File file = new File(path);
         Log.e("up", "2");
@@ -135,7 +132,7 @@
             RequestBody requestBody = new MultipartBody.Builder()
                     .setType(MultipartBody.FORM)
                     .addFormDataPart("file",
-                            Cache.userPhone + Cache.myPetList.get(0).getPetId() + ".jpg",
+                            Cache.userPhone +"" + index + ".jpg",
                             RequestBody.create(MediaType.parse("image/png"), file))
                     .build();
             Request request = new Request.Builder()
@@ -212,6 +209,14 @@
             @Override
             public void onClick(View v) {
 //                upData();
+                String type = petType.getText().toString();
+//        String age = petAge.getText().toString();
+                String autograph = petAutograph.getText().toString();
+                String name = petName.getText().toString();
+                Log.e("type:",type);
+                Log.e("age",agex+"岁");
+                Log.e("autogragh:",autograph);
+                Log.e("name:",name);
                 if(image_path != null){
                     upPhoto(image_path);
                 }else {
@@ -221,8 +226,10 @@
         });
 
 
+//        Intent intent = new Intent(getContext(),MyDataService.class);
+//        getContext().startService(intent);
         setViewContent();
-//        countWords();
+        countWords();
         return view;
     }
 
@@ -235,10 +242,14 @@
         Log.e("age",agex+"岁");
         Log.e("autogragh:",autograph);
         Log.e("name:",name);
+        Cache.myPetList.get(index).setPetAge(agex);
+        Cache.myPetList.get(index).setPetName(name);
+        Cache.myPetList.get(index).setPetAutograph(autograph);
+        Cache.myPetList.get(index).setPetType(type);
         if(image_path != null &&  type != null && agex != 0 && autograph != null && name != null){
             //发送
             pet.setPetId(Cache.myPetList.get(index).getPetId());
-            pet.setPicturePath(Cache.userPhone + Cache.myPetList.get(index).getPetId()+ ".jpg");
+            pet.setPicturePath(Cache.userPhone +""+ Cache.myPetList.get(index).getPetId()+ ".jpg");
             pet.setPetType(type);
             pet.setPetAutograph(autograph);
             pet.setPetName(name);
@@ -425,46 +436,55 @@
     /**
      * 记录字数和限制最大输入字数
      */
-//    private void countWords() {
-//        petAutograph.addTextChangedListener(new TextWatcher() {
-//            //记录输入的字数
-//            private CharSequence wordNum;
-//            private int selectionStart;
-//            private int selectionEnd;
-//            @Override
-//            public void beforeTextChanged(CharSequence s, int start, int count, int after) {
-//
-//            }
-//
-//            @Override
-//            public void onTextChanged(CharSequence s, int start, int before, int count) {
-//                //实时记录输入的字数
-//                wordNum= s;
-//            }
-//
-//            @Override
-//            public void afterTextChanged(Editable s) {
-//
-//                Cache.user.setUserAutograph(Cache.user.getUserAutograph() + s);
-//                int number = num + s.length();
-//                //TextView显示剩余字数
-//                petAutograph.setText("" + number+"/" + mMaxNum);
-//                selectionStart=tvNum.getSelectionStart();
-//                selectionEnd = tvNum.getSelectionEnd();
-//                //判断大于最大值
-//                if (wordNum.length() > mMaxNum) {
-//                    //删除多余输入的字（不会显示出来）
-//                    s.delete(selectionStart - 1, selectionEnd);
-//                    int tempSelection = selectionEnd;
-//                    petAutograph.setText(s);
-//                    petAutograph.setSelection(tempSelection);//设置光标在最后
-//                    //吐司最多输入300字
-//                    Toast.makeText(getContext(), "最多输入"+mMaxNum+"字", Toast.LENGTH_SHORT).show();
-//
-//                }
-//            }
-//        });
-//    }
+    private void countWords() {
+        petAutograph.addTextChangedListener(new TextWatcher() {
+            //记录输入的字数
+            private CharSequence wordNum;
+            private int selectionStart;
+            private int selectionEnd;
+            @Override
+            public void beforeTextChanged(CharSequence s, int start, int count, int after) {
+
+                wordNum = s;
+                //判断大于最大值
+                tvNum.setText("" + count+"/" + mMaxNum);
+                if (wordNum.length() > mMaxNum) {
+                    int tempSelection = selectionEnd;
+                    petAutograph.setText(s);
+                    petAutograph.setSelection(tempSelection);//设置光标在最后
+                    //吐司最多输入300字
+                    Toast.makeText(getContext(), "最多输入"+mMaxNum+"字", Toast.LENGTH_SHORT).show();
+
+                }
+            }
+
+            @Override
+            public void onTextChanged(CharSequence s, int start, int before, int count) {
+                //实时记录输入的字数
+                wordNum= s;
+            }
+
+            @Override
+            public void afterTextChanged(Editable s) {
+                int number = num + s.length();
+                //TextView显示剩余字数
+                tvNum.setText("" + number+"/" + mMaxNum);
+                selectionStart=petAutograph.getSelectionStart();
+                selectionEnd = petAutograph.getSelectionEnd();
+                //判断大于最大值
+                if (wordNum.length() > mMaxNum) {
+                    //删除多余输入的字（不会显示出来）
+                    s.delete(selectionStart - 1, selectionEnd);
+                    int tempSelection = selectionEnd;
+                    petAutograph.setText(s);
+                    petAutograph.setSelection(tempSelection);//设置光标在最后
+                    //吐司最多输入300字
+                    Toast.makeText(getContext(), "最多输入"+mMaxNum+"字", Toast.LENGTH_SHORT).show();
+
+                }
+            }
+        });
+    }
 
     /**
      * 添加相片
@@ -533,95 +553,15 @@
     @Override
     public void onStart() {
         super.onStart();
-        setViewContent();
+//        Intent intent = new Intent(getContext(),MyDataService.class);
+//        getContext().startService(intent);
+//        setViewContent();
     }
 
-    /**
-     * 上传数据
-     */
-//    public void upData(){
-//        OkHttpClient okHttpClient = new OkHttpClient();
-//        //创建请求体对象
-//        Cache.user.setUserPhone(Cache.userPhone);
-//        String name = petName.getText().toString();
-//        if(name == null){
-//            pet.setPetName("");
-//        }else {
-//            pet.setPetName(name);
-//        }
-//        String autograph = petAutograph.getText().toString();
-//        if(autograph == null){
-//            pet.setPetAutograph("");
-//        }else {
-//            pet.setPetAutograph(autograph);
-//        }
-//        String path = Cache.myPetList.get(0).getPetPicPath();
-//        if(path == null){
-//            pet.setPetPicPath("");
-//        }else {
-//            pet.setPetPicPath(path);
-//        }
-//        String age = petAge.getText().toString();
-//        if(age == null){
-//            pet.getPetAge("未知");
-//        }else {
-//            pet.getPetAge(age);
-//        }
-//        String brithday = upBrithday.getText().toString();
-//        if(brithday == null){
-//            Calendar selectedDate = Calendar.getInstance();//系统当前时间
-//            user.setUserBrithday(getTimes(selectedDate.getTime()));
-//        }else {
-//            user.setUserBrithday(brithday);
-//        }
-//
-//        RequestBody requestBody = RequestBody.create(MediaType.parse(
-//                "text/plain;charset=UTF-8"),new Gson().toJson(user));
-//        //3.创建请求对象
-//        Request request = new Request.Builder()
-//                .post(requestBody)
-//                .url(Cache.MY_URL + "UpDataUserInfo2Servlet")
-//                .build();
-//        //3.创建Call对象，发送请求，并接受响应
-//        Call call = okHttpClient.newCall(request);
-//        //异步网络请求（无需手动使用子线程）
-//        call.enqueue(new Callback() {
-//            @Override
-//            public void onFailure(Call call, IOException e) {
-//                //失败
-//                Message msg = new Message();
-//                msg.what = 4;
-//                msg.obj = 3;
-//                Log.e("up","5b");
-//                hd.sendMessage(msg);
-//                Log.e("up","6b");
-//                e.printStackTrace();
-//            }
-//
-//            @Override
-//            public void onResponse(Call call, Response response) throws IOException {
-//                //上传成功
-//                Message msg = new Message();
-//                String res = response.body().string();
-//                if(res.equals("true")){
-//                    msg.what = 3;
-//                    msg.obj = 1;
-//                    Log.e("updata",res);
-//                }else {
-//                    msg.what = 2;
-//                    msg.obj = 1;
-//                    Log.e("updata",res);
-//                }
-//                hd.sendMessage(msg);
-//
-//            }
-//        });
-//    }
     @Override
     public void onResume() {
         super.onResume();
         upAge();
         upType();
-//        setViewContent();
     }
 }
Index: app/src/main/java/com/example/pet/my/MyUserService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.my;\r\n\r\nimport android.app.IntentService;\r\nimport android.content.Intent;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.BitmapFactory;\r\nimport android.util.Log;\r\n\r\n\r\nimport androidx.annotation.Nullable;\r\n\r\nimport com.example.pet.other.Cache;\r\nimport com.example.pet.other.entity.User;\r\nimport com.google.gson.Gson;\r\n\r\nimport org.json.JSONObject;\r\n\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.io.UnsupportedEncodingException;\r\nimport java.net.MalformedURLException;\r\nimport java.net.URL;\r\n\r\n\r\npublic class MyUserService extends IntentService {\r\n    /**\r\n     * Creates an IntentService.  Invoked by your subclass's constructor.\r\n     *\r\n     * @param name Used to name the worker thread, important only for debugging.\r\n     */\r\n    public MyUserService(String name) {\r\n        super(name);\r\n    }\r\n\r\n    public MyUserService() {\r\n        super(\"MyUserService\");\r\n    }\r\n\r\n    @Override\r\n    protected void onHandleIntent(@Nullable Intent intent) {\r\n        Log.e(\"MyUserService\", Cache.userPhone);\r\n\r\n        try {\r\n            URL url = new URL(Cache.MY_URL + \"MyUser?phone=\" + Cache.userPhone);\r\n            InputStream in = url.openStream();\r\n            StringBuilder str = new StringBuilder();\r\n            byte[] bytes = new byte[256];\r\n            int len = 0;\r\n            while ((len = in.read(bytes)) != -1) {\r\n                str.append(new String(bytes, 0, len, \"utf-8\"));\r\n            }\r\n            in.close();\r\n            Cache.user = new Gson().fromJson(str.toString(), User.class);\r\n\r\n            if (Cache.user.getPicturePath() != null && Cache.user.getPicturePath().length() != 0) {\r\n                URL url1 = new URL(Cache.MY_URL + \"img/\" + Cache.user.getPicturePath());\r\n                InputStream in1 = url1.openStream();\r\n                Bitmap bitmap = BitmapFactory.decodeStream(in1);\r\n                Cache.user.setPhoto(bitmap);\r\n            }\r\n            Cache.userHashSet.add(Cache.user);\r\n            Log.e(\"MyUserService\", Cache.userHashSet.size()+\"\");\r\n        } catch (MalformedURLException e) {\r\n            e.printStackTrace();\r\n        } catch (UnsupportedEncodingException e) {\r\n            e.printStackTrace();\r\n        } catch (IOException e) {\r\n            e.printStackTrace();\r\n        }\r\n\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/my/MyUserService.java	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ app/src/main/java/com/example/pet/my/MyUserService.java	(date 1607562992945)
@@ -51,6 +51,7 @@
             }
             in.close();
             Cache.user = new Gson().fromJson(str.toString(), User.class);
+//            Log.e("user",Cache.user.toString());
 
             if (Cache.user.getPicturePath() != null && Cache.user.getPicturePath().length() != 0) {
                 URL url1 = new URL(Cache.MY_URL + "img/" + Cache.user.getPicturePath());
Index: app/src/main/java/com/example/pet/my/MyDataService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.my;\r\n\r\nimport android.app.IntentService;\r\nimport android.content.Intent;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.BitmapFactory;\r\nimport android.util.Log;\r\n\r\nimport androidx.annotation.Nullable;\r\n\r\nimport com.example.pet.other.Cache;\r\nimport com.example.pet.other.entity.Order;\r\nimport  com.example.pet.other.entity.Pet;\r\nimport com.example.pet.other.entity.Tips;\r\nimport com.google.gson.Gson;\r\n\r\n\r\nimport org.json.JSONArray;\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.net.MalformedURLException;\r\nimport java.net.URL;\r\nimport java.util.ArrayList;\r\n\r\npublic class MyDataService extends IntentService {\r\n    /**\r\n     * Creates an IntentService.  Invoked by your subclass's constructor.\r\n     *\r\n     * @param name Used to name the worker thread, important only for debugging.\r\n     */\r\n    public MyDataService(String name) {\r\n        super(name);\r\n    }\r\n\r\n    public MyDataService() {\r\n        super(\"MyDataService\");\r\n    }\r\n\r\n    @Override\r\n    protected void onHandleIntent(@Nullable Intent intent) {\r\n        //宠物数据下载\r\n\r\n            try{\r\n                if(Cache.myPetList!=null){\r\n                    Cache.myPetList.clear();\r\n                }else{\r\n                    Cache.myPetList = new ArrayList<>();\r\n                }\r\n\r\n                URL url = new URL(Cache.MY_URL+\"MyPet?userId=\"+Cache.user.getUserId());\r\n                InputStream in = url.openStream();\r\n                StringBuilder str = new StringBuilder();\r\n                byte[] bytes = new byte[256];\r\n                int len =0;\r\n                while ((len=in.read(bytes))!=-1){\r\n                    str.append(new String(bytes,0,len,\"utf-8\"));\r\n                }\r\n\r\n                in.close();\r\n                JSONArray jsonArray = new JSONArray(str.toString());\r\n\r\n                for(int i=0;i<jsonArray.length();i++){\r\n                    JSONObject rs = jsonArray.getJSONObject(i);\r\n                    Pet pet= new Gson().fromJson(rs.toString(),Pet.class);\r\n                    Log.e(\"pet\",pet.toString());\r\n//                    pet.setPetId(rs.getInt(\"petId\"));\r\n                    String path =rs.getString(\"picturePath\");\r\n                    URL url1 = new URL(Cache.MY_URL +\"img/\" +path);\r\n                    Log.e(\"url\",url1.toString());\r\n                    InputStream in1 = url1.openStream();\r\n                    Bitmap bitmap = BitmapFactory.decodeStream(in1);\r\n                    pet.setPicture(bitmap);\r\n//                    pet.setPetName(rs.getString(\"petName\"));\r\n//                    pet.setPetType(rs.getString(\"petType\"));\r\n//                    pet.setPetAge(rs.getInt(\"petAge\"));\r\n//                    pet.setPetWeight(rs.getString(\"petWeight\"));\r\n//                    pet.setUserId(rs.getInt(\"userId\"));\r\n//                    pet.setPetAutograph(rs.getString(\"petAutograph\"));\r\n                    Log.e(\"MyDataService\",pet.toString());\r\n                    Cache.myPetList.add(pet);\r\n                    Log.e(\"pet\",\"next\");\r\n                }\r\n\r\n            }catch(IOException | JSONException e) {\r\n                e.printStackTrace();\r\n            }\r\n\r\n            try {\r\n                if(Cache.myOrderList!=null){\r\n                    Cache.myOrderList.clear();\r\n                }else{\r\n                    Cache.myOrderList = new ArrayList<>();\r\n                }\r\n                URL url  = new URL(Cache.MY_URL +\"MyOrder?userId=\"+Cache.user.getUserId());\r\n                InputStream in  = url.openStream();\r\n                StringBuilder str= new StringBuilder();\r\n                byte[] bytes = new byte[256];\r\n                int len =0;\r\n                while ((len = in.read(bytes))!=-1){\r\n                    str.append(new String(bytes,0,len,\"utf-8\"));\r\n\r\n                }\r\n\r\n                in.close();\r\n                JSONArray jsonArray = new JSONArray(str.toString());\r\n                Log.e(\"\",jsonArray.toString());\r\n                Cache.myOrderList = new ArrayList();\r\n                for (int i = 0; i < jsonArray.length(); i++) {\r\n                    JSONObject rs = jsonArray.getJSONObject(i);\r\n                    Order order = new Gson().fromJson(rs.toString(),Order.class);\r\n//                    order.setOrderId(rs.getInt(\"orderId\"));\r\n//                    order.setOrderStart(rs.getString(\"orderStart\"));\r\n//                    order.setOrderEnd(rs.getString(\"orderEnd\"));\r\n                    int id = rs.getInt(\"petId\");\r\n                    for(int j=0;j<Cache.myPetList.size();j++){\r\n                        if(Cache.myPetList.get(j).getPetId() == id){\r\n                            order.setPet(Cache.myPetList.get(j));\r\n                            Log.e(\"MyDataService\",id+ \"gggg\");\r\n\r\n                        }\r\n                    }\r\n                    //设置\r\n//                    order.setAddresser(rs.getString(\"addresser\"));\r\n//                    order.setAddressee(rs.getString(\"addressee\"));\r\n//                    order.setPetShopContact(rs.getString(\"petShopContact\"));\r\n//                    order.setRemarks(rs.getString(\"remarks\"));\r\n//                    order.setOrderAmount(rs.getString(\"orderAmount\"));\r\n//                    order.setClientContact(rs.getString(\"clientContact\"));\r\n//                    order.setRunnerContact(rs.getString(\"runnerContact\"));\r\n//                    order.setRunnerName(rs.getString(\"runnerName\"));\r\n//                    order.setOrderTime(rs.getString(\"orderTime\"));\r\n//                    order.setKilometers(rs.getString(\"kilometers\"));\r\n//                    order.setOrderState(rs.getString(\"orderState\"));\r\n//                    order.setUserId(rs.getInt(\"userId\"));\r\n//                    order.setAddresseeContact(rs.getString(\"addresseeContact\"));\r\n                    Log.e(\"MyDataService\",order.toString());\r\n                    Cache.myOrderList.add(order);\r\n                }\r\n            } catch (IOException | JSONException e) {\r\n                e.printStackTrace();\r\n            }\r\n\r\n        try {\r\n            if(Cache.myPostList!=null){\r\n                Cache.myPostList.clear();\r\n            }else{\r\n                Cache.myPostList = new ArrayList<>();\r\n            }\r\n            URL url = new URL(Cache.MY_URL+\"MyTip?userId=\"+ Cache.user.getUserId());\r\n            InputStream in  = url.openStream();\r\n            StringBuilder str= new StringBuilder();\r\n            byte[] bytes = new byte[256];\r\n            int len =0;\r\n            while ((len = in.read(bytes))!=-1){\r\n                str.append(new String(bytes,0,len,\"utf-8\"));\r\n            }\r\n\r\n            in.close();\r\n            JSONArray jsonArray = new JSONArray(str.toString());\r\n            Log.e(\"Post\",jsonArray.toString());\r\n            for (int i = 0; i < jsonArray.length(); i++) {\r\n                JSONObject jsonObject = jsonArray.getJSONObject(i);\r\n                int post_id = jsonObject.getInt(\"post_id\");\r\n                String post_title = jsonObject.getString(\"post_title\");\r\n                String post_time = jsonObject.getString(\"post_time\");\r\n                String post_text = jsonObject.getString(\"post_text\");\r\n                String topic = jsonObject.getString(\"post_topic\");\r\n                String user_name = jsonObject.getString(\"user_name\");\r\n                int count_likes = jsonObject.getInt(\"likes\");\r\n                int count_comments = jsonObject.getInt(\"comments\");\r\n                int count_forwards = jsonObject.getInt(\"forwards\");\r\n                String img_path = jsonObject.getString(\"picture_path\");\r\n                String head_img_path = jsonObject.getString(\"user_picture_path\");\r\n                Tips tips = new Tips();\r\n                tips.setId(post_id);\r\n                tips.setTitle(post_title);\r\n                tips.setText(post_text);\r\n                tips.setTime(post_time);\r\n                tips.setUserName(user_name);\r\n                tips.setTopic(topic);\r\n                tips.setLikes(count_likes);\r\n                tips.setComments(count_comments);\r\n                tips.setForwards(count_forwards);\r\n                tips.setImagepath(img_path);\r\n                tips.setHeadImagepath(head_img_path);\r\n                URL url1 = new URL(Cache.MY_URL +\"img/\" +img_path);\r\n                InputStream in1 = url1.openStream();\r\n                Bitmap bitmap = BitmapFactory.decodeStream(in1);\r\n                tips.setThumbnail(bitmap);\r\n                URL url2 = new URL(Cache.MY_URL +\"img/\"+head_img_path);\r\n                InputStream in2 = url2.openStream();\r\n                Bitmap bitmap1 = BitmapFactory.decodeStream(in2);\r\n                tips.setUserHead(bitmap1);\r\n                in1.close();\r\n                in2.close();\r\n                Cache.myPostList.add(tips);\r\n            }\r\n        } catch (MalformedURLException e) {\r\n            e.printStackTrace();\r\n        } catch (IOException e) {\r\n            e.printStackTrace();\r\n        } catch (JSONException e) {\r\n            e.printStackTrace();\r\n        }\r\n\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/my/MyDataService.java	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ app/src/main/java/com/example/pet/my/MyDataService.java	(date 1607562992888)
@@ -50,6 +50,7 @@
                     Cache.myPetList = new ArrayList<>();
                 }
 
+//                Log.e("id:      ",Cache.user.getUserId() + "");
                 URL url = new URL(Cache.MY_URL+"MyPet?userId="+Cache.user.getUserId());
                 InputStream in = url.openStream();
                 StringBuilder str = new StringBuilder();
Index: app/src/main/java/com/example/pet/my/Login.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.my;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport android.animation.Animator;\r\nimport android.animation.AnimatorSet;\r\nimport android.animation.ObjectAnimator;\r\nimport android.animation.PropertyValuesHolder;\r\nimport android.animation.ValueAnimator;\r\nimport android.content.Intent;\r\nimport android.graphics.Color;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\nimport android.os.Message;\r\nimport android.util.Log;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.view.animation.AccelerateDecelerateInterpolator;\r\nimport android.widget.EditText;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.example.pet.MainActivity;\r\nimport com.example.pet.R;\r\nimport com.example.pet.other.Cache;\r\n\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.net.MalformedURLException;\r\nimport java.net.URL;\r\n\r\npublic class Login extends AppCompatActivity {\r\n    private String phone;\r\n    private View progress;\r\n    private View mInputLayout;\r\n    private TextView login;\r\n    private float mWidth, mHeight;\r\n    private LinearLayout mName, mPsw;\r\n    private EditText etName;\r\n    private EditText etPassword;\r\n    private int back;\r\n    private Handler handler = new Handler() {\r\n        @Override\r\n        public void handleMessage(@NonNull Message msg) {\r\n            switch (msg.what) {\r\n                case 1:\r\n                    mName.setVisibility(View.INVISIBLE);\r\n                    mPsw.setVisibility(View.INVISIBLE);\r\n                    inputAnimator(mInputLayout, mWidth, mHeight);\r\n                    Cache.userPhone = phone;\r\n                    Log.e(\"Login\", \"登录成功\" + Cache.userPhone);\r\n                    Intent intent2 = new Intent(Login.this, MyUserService.class);\r\n                    startService(intent2);\r\n\r\n                    break;\r\n                case 0:\r\n                    Toast.makeText(Login.this, \"密码有误，请重试\", Toast.LENGTH_LONG).show();\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_login);\r\n        if (Build.VERSION.SDK_INT >= 21) {   //只有5.0及以上系统才支持，因此这里先进行了一层if判断\r\n            View decorView = getWindow().getDecorView();\r\n            int option = View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN\r\n                    | View.SYSTEM_UI_FLAG_LAYOUT_STABLE    //设置为全屏显示，必须这两行代码一起才能生效\r\n                    | View.SYSTEM_UI_FLAG_LIGHT_STATUS_BAR;  //因为背景为浅色，设置通知栏字体颜色为深色\r\n            decorView.setSystemUiVisibility(option);\r\n            getWindow().setStatusBarColor(Color.TRANSPARENT);//设置为透明\r\n        }\r\n        back =getIntent().getIntExtra(\"back\",1);\r\n        initView();\r\n    }\r\n\r\n    private void initView() {\r\n        login = (TextView) findViewById(R.id.login_btn);\r\n        progress = findViewById(R.id.layout_progress);\r\n        mInputLayout = findViewById(R.id.input_layout);\r\n        mName = (LinearLayout) findViewById(R.id.input_layout_name);\r\n        mPsw = (LinearLayout) findViewById(R.id.input_layout_psw);\r\n        etName = findViewById(R.id.login_et_username);\r\n        etPassword = findViewById(R.id.login_et_password);\r\n    }\r\n\r\n    public void onClicked(View view) {\r\n        switch (view.getId()) {\r\n            case R.id.login_btn:\r\n                mWidth = login.getMeasuredWidth();\r\n                mHeight = login.getMeasuredHeight();\r\n                loginService();\r\n                break;\r\n            case R.id.login_register:\r\n                Intent intent = new Intent(this, Register.class);\r\n                startActivity(intent);\r\n                break;\r\n            case R.id.login_update:\r\n                Intent intent1 = new Intent(this, Update.class);\r\n                startActivity(intent1);\r\n                break;\r\n\r\n        }\r\n    }\r\n\r\n    private void loginService() {\r\n        phone = etName.getText().toString();\r\n        Cache.userPhone = etName.getText().toString();\r\n        final String pwd = etPassword.getText().toString();\r\n        if (phone.length() == 11 && pwd.length() != 0) {\r\n            new Thread() {\r\n                @Override\r\n                public void run() {\r\n                    try {\r\n                        URL url = new URL(Cache.MY_URL + \"LoginServlet?num=\" + phone + \"&pwd=\" + pwd);\r\n                        InputStream in = url.openStream();\r\n                        int num = in.read();\r\n                        Message message = new Message();\r\n                        message.what = num;\r\n                        handler.sendMessage(message);\r\n                        in.close();\r\n                    } catch (MalformedURLException e) {\r\n                        e.printStackTrace();\r\n                    } catch (IOException e) {\r\n                        e.printStackTrace();\r\n                    }\r\n\r\n                }\r\n            }.start();\r\n        } else {\r\n            Toast.makeText(this, \"输入格式有误\", Toast.LENGTH_LONG).show();\r\n        }\r\n    }\r\n\r\n    private void inputAnimator(final View view, float w, float h) {\r\n        AnimatorSet set = new AnimatorSet();\r\n        ValueAnimator animator = ValueAnimator.ofFloat(0, w);\r\n        animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() {\r\n            @Override\r\n            public void onAnimationUpdate(ValueAnimator animation) {\r\n                float value = (Float) animation.getAnimatedValue();\r\n                ViewGroup.MarginLayoutParams params = (ViewGroup.MarginLayoutParams) view\r\n                        .getLayoutParams();\r\n                params.leftMargin = (int) value;\r\n                params.rightMargin = (int) value;\r\n                view.setLayoutParams(params);\r\n            }\r\n        });\r\n        ObjectAnimator animator2 = ObjectAnimator.ofFloat(mInputLayout, \"scaleX\", 1f, 0.5f);\r\n        set.setDuration(4000);\r\n        set.setInterpolator(new AccelerateDecelerateInterpolator());\r\n        set.playTogether(animator, animator2);\r\n        set.start();\r\n        set.addListener(new Animator.AnimatorListener() {\r\n            @Override\r\n            public void onAnimationStart(Animator animation) {\r\n\r\n            }\r\n\r\n            @Override\r\n            public void onAnimationRepeat(Animator animation) {\r\n                // TODO Auto-generated method stub\r\n\r\n            }\r\n\r\n            @Override\r\n            public void onAnimationEnd(Animator animation) {\r\n                progress.setVisibility(View.VISIBLE);\r\n                progressAnimator(progress);\r\n                mInputLayout.setVisibility(View.INVISIBLE);\r\n                Intent intent1 = new Intent(Login.this, MyDataService.class);\r\n                startService(intent1);\r\n                Intent intent = new Intent(Login.this, MainActivity.class);\r\n                startActivity(intent);\r\n                Login.this.finish();\r\n            }\r\n\r\n            @Override\r\n            public void onAnimationCancel(Animator animation) {\r\n                // TODO Auto-generated method stub\r\n            }\r\n        });\r\n    }\r\n\r\n    private void progressAnimator(final View view) {\r\n        PropertyValuesHolder animator = PropertyValuesHolder.ofFloat(\"scaleX\", 0.5f, 1f);\r\n        PropertyValuesHolder animator2 = PropertyValuesHolder.ofFloat(\"scaleY\", 0.5f, 1f);\r\n        ObjectAnimator animator3 = ObjectAnimator.ofPropertyValuesHolder(view, animator, animator2);\r\n        animator3.setDuration(1500);\r\n        animator3.setInterpolator(new JellyInterpolator());\r\n        animator3.start();\r\n    }\r\n\r\n    public void back(View view) {\r\n        if(back==0){\r\n            Intent intent = new Intent(Login.this, MainActivity.class);\r\n            startActivity(intent);\r\n            this.finish();\r\n        }else {\r\n            this.finish();\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/my/Login.java	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ app/src/main/java/com/example/pet/my/Login.java	(date 1607560876715)
@@ -152,7 +152,7 @@
             }
         });
         ObjectAnimator animator2 = ObjectAnimator.ofFloat(mInputLayout, "scaleX", 1f, 0.5f);
-        set.setDuration(4000);
+        set.setDuration(1500);
         set.setInterpolator(new AccelerateDecelerateInterpolator());
         set.playTogether(animator, animator2);
         set.start();
Index: app/src/main/java/com/example/pet/my/PetActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.my;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.appcompat.widget.Toolbar;\r\n\r\nimport android.graphics.Color;\r\nimport android.net.Uri;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.widget.ArrayAdapter;\r\nimport android.widget.Spinner;\r\n\r\nimport com.example.pet.R;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class PetActivity extends AppCompatActivity {\r\n    private Uri imageUri;\r\n    public static final int TAKE_PHOTO=1;\r\n    private List<String> list = new ArrayList<String>();\r\n    private Spinner spinner;\r\n    private ArrayAdapter<String> adapter;\r\n    private Toolbar toolbar;\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_add_pet);\r\n        if (Build.VERSION.SDK_INT >= 21) {   //只有5.0及以上系统才支持，因此这里先进行了一层if判断\r\n            View decorView = getWindow().getDecorView();\r\n            int option = View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN\r\n                    | View.SYSTEM_UI_FLAG_LAYOUT_STABLE    //设置为全屏显示，必须这两行代码一起才能生效\r\n                    |View.SYSTEM_UI_FLAG_LIGHT_STATUS_BAR;  //因为背景为浅色，设置通知栏字体颜色为深色\r\n            decorView.setSystemUiVisibility(option);\r\n            getWindow().setStatusBarColor(Color.TRANSPARENT);//设置为透明\r\n        }\r\n\r\n}\r\n\r\n    public void onClicked(View view) {\r\n    }\r\n\r\n    public void close(View view) {\r\n        PetActivity.this.finish();\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/my/PetActivity.java	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ app/src/main/java/com/example/pet/my/PetActivity.java	(date 1607603613870)
@@ -1,21 +1,67 @@
 package com.example.pet.my;
 
+import androidx.annotation.Nullable;
 import androidx.appcompat.app.AppCompatActivity;
 import androidx.appcompat.widget.Toolbar;
+import androidx.core.app.ActivityCompat;
 
+import android.app.Activity;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.PackageManager;
+import android.graphics.Bitmap;
+import android.graphics.BitmapFactory;
 import android.graphics.Color;
 import android.net.Uri;
 import android.os.Build;
 import android.os.Bundle;
+import android.os.Handler;
+import android.os.IBinder;
+import android.os.Message;
+import android.text.Editable;
+import android.text.TextWatcher;
+import android.util.Log;
+import android.view.MotionEvent;
 import android.view.View;
+import android.view.inputmethod.InputMethodManager;
 import android.widget.ArrayAdapter;
+import android.widget.Button;
+import android.widget.EditText;
+import android.widget.ImageView;
+import android.widget.LinearLayout;
 import android.widget.Spinner;
+import android.widget.TextView;
+import android.widget.Toast;
 
+import com.bigkoo.pickerview.builder.OptionsPickerBuilder;
+import com.bigkoo.pickerview.listener.CustomListener;
+import com.bigkoo.pickerview.listener.OnOptionsSelectListener;
+import com.bigkoo.pickerview.view.OptionsPickerView;
 import com.example.pet.R;
+import com.example.pet.my.editinfo.Const;
+import com.example.pet.my.editinfo.GlideEngine;
+import com.example.pet.other.Cache;
+import com.example.pet.other.entity.Pet;
+import com.google.gson.Gson;
+import com.luck.picture.lib.PictureSelector;
+import com.luck.picture.lib.config.PictureConfig;
+import com.luck.picture.lib.config.PictureMimeType;
+import com.luck.picture.lib.entity.LocalMedia;
 
+import java.io.File;
+import java.io.IOException;
 import java.util.ArrayList;
 import java.util.List;
 
+import okhttp3.Call;
+import okhttp3.Callback;
+import okhttp3.MediaType;
+import okhttp3.MultipartBody;
+import okhttp3.OkHttpClient;
+import okhttp3.Request;
+import okhttp3.RequestBody;
+import okhttp3.Response;
+
 public class PetActivity extends AppCompatActivity {
     private Uri imageUri;
     public static final int TAKE_PHOTO=1;
@@ -23,6 +69,65 @@
     private Spinner spinner;
     private ArrayAdapter<String> adapter;
     private Toolbar toolbar;
+
+
+
+    private ImageView petPhoto;
+    private EditText petName;
+    private TextView petType;
+    private TextView petAge;
+    private EditText petAutograph;
+    private Button btnUpdate;
+    private TextView tvNum;
+    private int index;
+    private Pet pet;
+    private int agex;
+    private Bitmap bitmap;
+
+
+    private OptionsPickerView pvAgeOptions;
+    private OptionsPickerView pvTypeOptions;
+    private ArrayList<Integer> ageItem = new ArrayList<>();
+    private ArrayList<String> typeItem = new ArrayList<>();
+    //输入框初始值
+    private int num = 0;
+    //输入框最大值
+    public int mMaxNum=200;
+    private String image_path;
+    private static final int REQUEST_EXTERNAL_STORAGE = 1;
+    private static String[] PERMISSIONS_STORAGE = {
+            "android.permission.READ_EXTERNAL_STORAGE",
+            "android.permission.WRITE_EXTERNAL_STORAGE",
+            "android.permission.CAMER"};
+
+    Handler hd = new Handler() {
+        @Override
+        public void handleMessage(Message msg) {
+            if(msg.what == 1){
+                Toast.makeText(PetActivity.this,"上传成功",Toast.LENGTH_SHORT);
+                upData();
+            }else if(msg.what == 2){
+                Log.e("up","6b");
+                Toast.makeText(PetActivity.this,"上传失败了",Toast.LENGTH_SHORT);
+            }else if(msg.what == 3){
+                pet.setPicture(bitmap);
+                Cache.myPetList.add(pet);
+                Toast.makeText(PetActivity.this,"上传成功",Toast.LENGTH_SHORT);
+            }else if(msg.what == 4) {
+                Log.e("up","6b");
+                Toast.makeText(PetActivity.this,"上传失败了",Toast.LENGTH_SHORT);
+            }else if(msg.what == 5){
+                Uri uri = Uri.parse(msg.obj.toString());
+                bitmap = BitmapFactory.decodeFile(image_path);
+                petPhoto.setImageBitmap(bitmap);
+                //                petPhoto.setImageURI(uri);
+            }else if(msg.what == 6) {
+                Log.e("up","6b");
+                Toast.makeText(PetActivity.this,"上传失败了",Toast.LENGTH_SHORT);
+            }
+        }
+    };
+
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
@@ -31,17 +136,531 @@
             View decorView = getWindow().getDecorView();
             int option = View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN
                     | View.SYSTEM_UI_FLAG_LAYOUT_STABLE    //设置为全屏显示，必须这两行代码一起才能生效
-                    |View.SYSTEM_UI_FLAG_LIGHT_STATUS_BAR;  //因为背景为浅色，设置通知栏字体颜色为深色
+                    | View.SYSTEM_UI_FLAG_LIGHT_STATUS_BAR;  //因为背景为浅色，设置通知栏字体颜色为深色
             decorView.setSystemUiVisibility(option);
             getWindow().setStatusBarColor(Color.TRANSPARENT);//设置为透明
         }
+        upAge();
+        upType();
+        setViewContent();
+    }
+
+    private void setViewContent() {
+        //设置
+        pet = new Pet();
+        initAge();
+        initType();
+        Log.e("upAge", "绑定成功");
+        petPhoto = findViewById(R.id.pet_photo1);
+        petName = findViewById(R.id.pet_name1);
+        petType = findViewById(R.id.pet_type1);
+        petAge = findViewById(R.id.pet_age1);
+        petAutograph = findViewById(R.id.pet_autograph1);
+        btnUpdate = findViewById(R.id.pet_add);
+        tvNum = findViewById(R.id.tv_input1);
+        countWords();
+
+    }
 
-}
+
+    public void initAge(){
+        for(int i = 1;i < 30;i++){
+            ageItem.add(i);
+        }
+    }
+    public void initType(){
+        typeItem.add("哈士奇");
+        typeItem.add("兔子");
+        typeItem.add("加菲猫");
+        typeItem.add("小白鼠");
+        typeItem.add("无皮猫");
+        typeItem.add("土狗");
+        typeItem.add("仓鼠");
+    }
+
+
+    /**
+     * 记录字数和限制最大输入字数
+     */
+    private void countWords() {
+        petAutograph.addTextChangedListener(new TextWatcher() {
+            //记录输入的字数
+            private CharSequence wordNum;
+            private int selectionStart;
+            private int selectionEnd;
+            @Override
+            public void beforeTextChanged(CharSequence s, int start, int count, int after) {
+
+                wordNum = s;
+                //判断大于最大值
+                if (wordNum.length() > mMaxNum) {
+                    int tempSelection = selectionEnd;
+                    petAutograph.setText(s);
+                    petAutograph.setSelection(tempSelection);//设置光标在最后
+                    //吐司最多输入300字
+                    Toast.makeText(PetActivity.this, "最多输入"+mMaxNum+"字", Toast.LENGTH_SHORT).show();
+
+                }
+            }
+
+            @Override
+            public void onTextChanged(CharSequence s, int start, int before, int count) {
+                //实时记录输入的字数
+                wordNum= s;
+            }
+
+            @Override
+            public void afterTextChanged(Editable s) {
+                int number = num + s.length();
+                //TextView显示剩余字数
+                tvNum.setText("" + number+"/" + mMaxNum);
+                selectionStart=petAutograph.getSelectionStart();
+                selectionEnd = petAutograph.getSelectionEnd();
+                //判断大于最大值
+                if (wordNum.length() > mMaxNum) {
+                    //删除多余输入的字（不会显示出来）
+                    s.delete(selectionStart - 1, selectionEnd);
+                    int tempSelection = selectionEnd;
+                    petAutograph.setText(s);
+                    petAutograph.setSelection(tempSelection);//设置光标在最后
+                    //吐司最多输入300字
+                    Toast.makeText(PetActivity.this, "最多输入"+mMaxNum+"字", Toast.LENGTH_SHORT).show();
+
+                }
+            }
+        });
+    }
+
+    public void close(View view) {
+        PetActivity.this.finish();
+    }
+
+    /**
+     * 上传图片
+     * 未测试
+     */
+    public void upPhoto(String path) {
+        pet.setPicturePath(image_path);
+        Log.e("up", "1");
+        File file = new File(path);
+        Log.e("up", "2");
+        String url = Cache.MY_URL + "UpDataPetInfoServlet";
+        OkHttpClient okHttpClient = new OkHttpClient();
+        if (file != null && file.exists()) {
+            RequestBody requestBody = new MultipartBody.Builder()
+                    .setType(MultipartBody.FORM)
+                    .addFormDataPart("file",
+                            Cache.userPhone +"" + Cache.myPetList.size() + ".jpg",
+                            RequestBody.create(MediaType.parse("image/png"), file))
+                    .build();
+            Request request = new Request.Builder()
+                    .url(url)
+                    .post(requestBody)
+                    .build();
+            Call call = okHttpClient.newCall(request);
+
+            Log.e("up", "3");
+            call.enqueue(new Callback() {
+                @Override
+                public void onFailure(Call call, IOException e) {
+                    //失败
+                    Log.e("up", "4b");
+                    Message msg = new Message();
+                    msg.what = 2;
+                    msg.obj = 1;
+                    Log.e("up", "5b");
+                    hd.sendMessage(msg);
+                    Log.e("up", "6b");
+                    e.printStackTrace();
+                }
+
+                @Override
+                public void onResponse(Call call, Response response) throws IOException {
+                    //上传成功
+                    Log.e("up", "4a");
+                    Message msg = new Message();
+                    String res = response.body().string();
+                    if (res.equals("true")) {
+                        msg.what = 1;
+                        msg.obj = 1;
+                        Log.e("updata", res);
+                    } else {
+                        msg.what = 2;
+                        msg.obj = 1;
+                        Log.e("updata", res);
+                    }
+                    hd.sendMessage(msg);
+
+                }
+            });
+
+        } else {
+            Toast.makeText(PetActivity.this, "请添加头像", Toast.LENGTH_SHORT);
+        }
+    }
+    private void upData() {
+        String type = petType.getText().toString();
+//        String age = petAge.getText().toString();
+        String autograph = petAutograph.getText().toString();
+        String name = petName.getText().toString();
+        Log.e("type:",type);
+        Log.e("age",agex+"岁");
+        Log.e("autogragh:",autograph);
+        Log.e("name:",name);
+        if(image_path != null &&  type != null && agex != 0 && autograph != null && name != null){
+            //发送
+//            pet.setPetId(Cache.myPetList.get(index).getPetId());
+            pet.setPicturePath(Cache.userPhone +""+ Cache.myPetList.size()+ ".jpg");
+            pet.setPetType(type);
+            pet.setPetAutograph(autograph);
+            pet.setPetName(name);
+            pet.setPetAge(agex);
+            pet.setUserId(Cache.user.getUserId());
+            Log.e("pet",pet.toString());
+            String str = new Gson().toJson(pet);
+            Log.e("petStr",str);
+            OkHttpClient okHttpClient = new OkHttpClient();
+
+            RequestBody requestBody = RequestBody.create(MediaType.parse(
+                    "text/plain;charset=UTF-8"),str);
+            //3.创建请求对象
+            Request request = new Request.Builder()
+                    .post(requestBody)
+                    .url(Cache.MY_URL + "AddPetServlet")
+                    .build();
+            //3.创建Call对象，发送请求，并接受响应
+            Call call = okHttpClient.newCall(request);
+            //异步网络请求（无需手动使用子线程）
+            call.enqueue(new Callback() {
+                @Override
+                public void onFailure(Call call, IOException e) {
+                    //失败
+                    Message msg = new Message();
+                    msg.what = 4;
+                    msg.obj = 3;
+                    Log.e("up","5b");
+                    hd.sendMessage(msg);
+                    Log.e("up","6b");
+                    e.printStackTrace();
+                }
+
+                @Override
+                public void onResponse(Call call, Response response) throws IOException {
+                    //上传成功
+                    Message msg = new Message();
+                    String res = response.body().string();
+                    if(res.equals("true")){
+                        msg.what = 3;
+                        msg.obj = 1;
+                        Log.e("updata",res);
+                    }else {
+                        msg.what = 2;
+                        msg.obj = 1;
+                        Log.e("updata",res);
+                    }
+                    hd.sendMessage(msg);
+
+                }
+            });
+        }else {
+            Toast.makeText(PetActivity.this,"有信息未填，请填写！",Toast.LENGTH_SHORT);
+        }
+    }
+
 
     public void onClicked(View view) {
-    }
-
-    public void close(View view) {
-        PetActivity.this.finish();
+        switch (view.getId()){
+            case R.id.btn_close_add_pet:
+                PetActivity.this.finish();
+                break;
+            case R.id.ll_pet_type1:
+                pvTypeOptions.show();
+                break;
+            case R.id.ll_pet_age1:
+                pvAgeOptions.show();
+                break;
+            case R.id.pet_photo1:
+                upPic();
+                break;
+            case R.id.pet_add:
+//                upData();
+                String type = petType.getText().toString();
+//        String age = petAge.getText().toString();
+                String autograph = petAutograph.getText().toString();
+                String name = petName.getText().toString();
+                Log.e("type:",type);
+                Log.e("age",agex+"岁");
+                Log.e("autogragh:",autograph);
+                Log.e("name:",name);
+                if(image_path != null){
+                    upPhoto(image_path);
+                }/*else {
+                    upData();
+                }*/
+                break;
+
+
+        }
+    }
+
+    private void upType() {
+        // 注意：自定义布局中，id为 optionspicker 或者 timepicker 的布局以及其子控件必须要有，否则会报空指针
+        // 具体可参考demo 里面的两个自定义布局
+        Log.e("upAge","start");
+        pvTypeOptions = new OptionsPickerBuilder(PetActivity.this, new OnOptionsSelectListener() {
+            @Override
+            public void onOptionsSelect(int options1, int options2, int options3, View v) {
+                //返回的分别是三个级别的选中位置
+                String tx = typeItem.get(options1);
+                petType.setText(tx);
+                Log.e("type:::::::::::::",tx);
+            }
+        })
+                .setLayoutRes(R.layout.picker_sex_bg, new CustomListener() {
+                    @Override
+                    public void customLayout(View v) {
+                        //自定义布局中的控件初始化及事件处理
+                        final TextView tvSubmit = v.findViewById(R.id.tv_finish);
+                        TextView tvCancel = v.findViewById(R.id.tv_cancel);
+                        TextView tyTitle = v.findViewById(R.id.tv_title);
+                        tyTitle.setText("宠物种类");
+                        tvSubmit.setOnClickListener(new View.OnClickListener() {
+                            @Override
+                            public void onClick(View v) {
+                                pvTypeOptions.returnData();
+                                pvTypeOptions.dismiss();
+                            }
+                        });
+                        tvCancel.setOnClickListener(new View.OnClickListener() {
+                            @Override
+                            public void onClick(View v) {
+                                pvTypeOptions.dismiss();
+                            }
+                        });
+
+                    }
+                })
+                .setLineSpacingMultiplier(1.5f)//滚轮字体间距
+                .setContentTextSize(22)//字体大小
+                .setOutSideCancelable(true)
+                .build();
+        pvTypeOptions.setPicker(typeItem);//添加数据
+    }
+
+//    private void upType() {
+//        // 注意：自定义布局中，id为 optionspicker 或者 timepicker 的布局以及其子控件必须要有，否则会报空指针
+//        // 具体可参考demo 里面的两个自定义布局
+//        Log.e("upAge","start");
+//        pvTypeOptions = new OptionsPickerBuilder(PetActivity.this, new OnOptionsSelectListener() {
+//            @Override
+//            public void onOptionsSelect(int options1, int options2, int options3, View v) {
+//                //返回的分别是三个级别的选中位置
+//                String tx = typeItem.get(options1);
+//                petType.setText(tx);
+//                Log.e("type:::::::::::::",tx);
+//            }
+//        })
+//                .setLayoutRes(R.layout.picker_sex_bg, new CustomListener() {
+//                    @Override
+//                    public void customLayout(View v) {
+//                        //自定义布局中的控件初始化及事件处理
+//                        final TextView tvSubmit = v.findViewById(R.id.tv_finish);
+//                        TextView tvCancel = v.findViewById(R.id.tv_cancel);
+//                        TextView tyTitle = v.findViewById(R.id.tv_title);
+//                        tyTitle.setText("宠物种类");
+//                        tvSubmit.setOnClickListener(new View.OnClickListener() {
+//                            @Override
+//                            public void onClick(View v) {
+//                                pvTypeOptions.returnData();
+//                                pvTypeOptions.dismiss();
+//                            }
+//                        });
+//                        tvCancel.setOnClickListener(new View.OnClickListener() {
+//                            @Override
+//                            public void onClick(View v) {
+//                                pvTypeOptions.dismiss();
+//                            }
+//                        });
+//
+//                    }
+//                })
+//                .setLineSpacingMultiplier(1.5f)//滚轮字体间距
+//                .setContentTextSize(22)//字体大小
+//                .setOutSideCancelable(true)
+//                .build();
+//        pvTypeOptions.setPicker(typeItem);//添加数据
+//    }
+
+    private void upAge() {
+        // 注意：自定义布局中，id为 optionspicker 或者 timepicker 的布局以及其子控件必须要有，否则会报空指针
+        // 具体可参考demo 里面的两个自定义布局
+        Log.e("upAge","start");
+        pvAgeOptions = new OptionsPickerBuilder(this, new OnOptionsSelectListener() {
+            @Override
+            public void onOptionsSelect(int options1, int options2, int options3, View v) {
+                //返回的分别是三个级别的选中位置
+                int tx = ageItem.get(options1);
+                petAge.setText(tx + "岁");
+                agex = tx;
+            }
+        })
+                .setLayoutRes(R.layout.picker_sex_bg, new CustomListener() {
+                    @Override
+                    public void customLayout(View v) {
+                        //自定义布局中的控件初始化及事件处理
+                        final TextView tvSubmit = v.findViewById(R.id.tv_finish);
+                        TextView tvCancel = v.findViewById(R.id.tv_cancel);
+                        TextView tyTitle = v.findViewById(R.id.tv_title);
+                        tyTitle.setText("宠物年龄");
+                        tvSubmit.setOnClickListener(new View.OnClickListener() {
+                            @Override
+                            public void onClick(View v) {
+                                pvAgeOptions.returnData();
+                                pvAgeOptions.dismiss();
+                            }
+                        });
+                        tvCancel.setOnClickListener(new View.OnClickListener() {
+                            @Override
+                            public void onClick(View v) {
+                                pvAgeOptions.dismiss();
+                            }
+                        });
+
+                    }
+                })
+                .setLineSpacingMultiplier(1.5f)//滚轮字体间距
+                .setContentTextSize(22)//字体大小
+                .setOutSideCancelable(true)
+                .build();
+        pvAgeOptions.setPicker(ageItem);//添加数据
+    }
+
+
+    /**
+     * 添加相片
+     */
+    private void upPic() {
+        //动态申请权限
+        verifyStoragePermissions(PetActivity.this);
+        PictureSelector.create(this)
+                .openGallery(PictureConfig.TYPE_IMAGE)
+                .imageEngine(GlideEngine.createGlideEngine())
+                .imageSpanCount(4)// 每行显示个数 int
+                .maxSelectNum(1)
+                .isWeChatStyle(true)
+                .selectionMode(PictureConfig.SINGLE)// 多选 or 单选 PictureConfig.MULTIPLE or PictureConfig.SINGLE
+                .isSingleDirectReturn(true)//PictureConfig.SINGLE模式下是否直接返回
+                .isPreviewImage(true)// 是否可预览图片 true or false
+                .isCamera(true)// 是否显示拍照按钮 true or false
+                .imageFormat(PictureMimeType.JPEG)// 拍照保存图片格式后缀,默认jpeg
+                .isZoomAnim(true)// 图片列表点击 缩放效果 默认true
+                .setOutputCameraPath(Const.getImgPath())// 自定义拍照保存路径,可不填
+                .isEnableCrop(true)// 是否裁剪 true or false
+                .isCompress(true)// 是否压缩 true or false
+                .compressSavePath(Const.getImgPath())//压缩图片保存地址
+                .freeStyleCropEnabled(true)// 裁剪框是否可拖拽 true or false
+                .showCropGrid(true)// 是否显示裁剪矩形网格 圆形裁剪时建议设为false    true or false
+                .synOrAsy(false)
+                .forResult(PictureConfig.CHOOSE_REQUEST);//结果回调onActivityResult code
+    }
+
+    //接受回调
+    @Override
+    public void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {
+        super.onActivityResult(requestCode, resultCode, data);
+        if (resultCode == -1 && data != null) {
+            switch (requestCode) {
+                case PictureConfig.CHOOSE_REQUEST:
+                    List<LocalMedia> selectList = PictureSelector.obtainMultipleResult(data);
+                    image_path = selectList.get(0).getCompressPath();
+                    Message msg = new Message();
+                    msg.what = 5;
+                    msg.obj = image_path;
+                    hd.sendMessage(msg);
+                    Log.e("image_path",image_path);
+                    //上传图片
+                    Cache.myPetList.get(index).setPicturePath(image_path);
+//                    Cache.user.setPicturePath(image_path);
+                    break;
+            }
+        }
+    }
+
+    //然后通过一个函数来申请权限
+    public static void verifyStoragePermissions(Activity activity) {
+        try {
+            //检测是否有写的权限
+            int permission = ActivityCompat.checkSelfPermission(activity,
+                    "android.permission.WRITE_EXTERNAL_STORAGE");
+            if (permission != PackageManager.PERMISSION_GRANTED) {
+                // 没有写的权限，去申请写的权限，会弹出对话框
+                ActivityCompat.requestPermissions(activity, PERMISSIONS_STORAGE,REQUEST_EXTERNAL_STORAGE);
+            }
+        } catch (Exception e) {
+            e.printStackTrace();
+        }
+    }
+
+    /**
+     * 隐藏键盘
+     * @param ev
+     * @return
+     */
+    @Override
+    public boolean dispatchTouchEvent(MotionEvent ev) {
+        if (ev.getAction() == MotionEvent.ACTION_DOWN) {
+            View v = getCurrentFocus();
+            if (isShouldHideKeyboard(v, ev)) {
+                hideKeyboard(v.getWindowToken());
+            }
+        }
+        return super.dispatchTouchEvent(ev);
+    }
+
+    /**
+     * 根据EditText所在坐标和用户点击的坐标相对比，来判断是否隐藏键盘，因为当用户点击EditText时则不能隐藏
+     *
+     * @param v
+     * @param event
+     * @return
+     */
+    private boolean isShouldHideKeyboard(View v, MotionEvent event) {
+        if (v != null && (v instanceof EditText)) {
+            int[] l = {0, 0};
+            v.getLocationInWindow(l);
+            int left = l[0],
+                    top = l[1],
+                    bottom = top + v.getHeight(),
+                    right = left + v.getWidth();
+            if (event.getX() > left && event.getX() < right
+                    && event.getY() > top && event.getY() < bottom) {
+                // 点击EditText的事件，忽略它。
+                return false;
+            } else {
+                return true;
+            }
+        }
+        // 如果焦点不是EditText则忽略，这个发生在视图刚绘制完，第一个焦点不在EditText上，和用户用轨迹球选择其他的焦点
+        return false;
+    }
+
+    /**
+     * 获取InputMethodManager，隐藏软键盘
+     * @param token
+     */
+    private void hideKeyboard(IBinder token) {
+        if (token != null) {
+            InputMethodManager im = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
+            im.hideSoftInputFromWindow(token, InputMethodManager.HIDE_NOT_ALWAYS);
+        }
+    }
+
+
+
+    @Override
+    protected void onResume() {
+        super.onResume();
+        initAge();
+        initType();
     }
 }
\ No newline at end of file
Index: app/src/main/java/com/example/pet/other/entity/Pet.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.other.entity;\r\n\r\nimport android.graphics.Bitmap;\r\n\r\nimport java.io.Serializable;\r\n\r\npublic class Pet implements Serializable {\r\n    private int  petId;\r\n    private Bitmap picture;\r\n    private String petName;\r\n    private String petType;\r\n    private int petAge;\r\n    private String petWeight;\r\n    private int userId;\r\n    private String petAutograph;\r\n    private String picturePath;\r\n    private String phone;\r\n\r\n    public String getPhone() {\r\n        return phone;\r\n    }\r\n\r\n    public void setPhone(String phone) {\r\n        this.phone = phone;\r\n    }\r\n\r\n    public String getPicturePath() {\r\n        return picturePath;\r\n    }\r\n\r\n    public void setPicturePath(String picturePath) {\r\n        this.picturePath = picturePath;\r\n    }\r\n\r\n    public String getPetAutograph() {\r\n        return petAutograph;\r\n    }\r\n\r\n    public void setPetAutograph(String petAutograph) {\r\n        this.petAutograph = petAutograph;\r\n    }\r\n\r\n    public Pet() {\r\n    }\r\n\r\n    public int getPetId() {\r\n        return petId;\r\n    }\r\n\r\n    public void setPetId(int petId) {\r\n        this.petId = petId;\r\n    }\r\n\r\n    public Bitmap getPicture() {\r\n        return picture;\r\n    }\r\n\r\n    public void setPicture(Bitmap picture) {\r\n        this.picture = picture;\r\n    }\r\n\r\n    public String getPetName() {\r\n        return petName;\r\n    }\r\n\r\n    public void setPetName(String petName) {\r\n        this.petName = petName;\r\n    }\r\n\r\n    public String getPetType() {\r\n        return petType;\r\n    }\r\n\r\n    public void setPetType(String petType) {\r\n        this.petType = petType;\r\n    }\r\n\r\n    public int getPetAge() {\r\n        return petAge;\r\n    }\r\n\r\n    public void setPetAge(int petAge) {\r\n        this.petAge = petAge;\r\n    }\r\n\r\n    public String getPetWeight() {\r\n        return petWeight;\r\n    }\r\n\r\n    public void setPetWeight(String petWeight) {\r\n        this.petWeight = petWeight;\r\n    }\r\n\r\n    public int getUserId() {\r\n        return userId;\r\n    }\r\n\r\n    public void setUserId(int userId) {\r\n        this.userId = userId;\r\n    }\r\n\r\n\r\n    @Override\r\n    public String toString() {\r\n        return \"Pet{\" +\r\n                \"petId=\" + petId +\r\n                \", petName='\" + petName + '\\'' +\r\n                \", petType='\" + petType + '\\'' +\r\n                \", petAge=\" + petAge +\r\n                \", petWeight='\" + petWeight + '\\'' +\r\n                \", userId=\" + userId +\r\n                \", petAutograph='\" + petAutograph + '\\'' +\r\n                \", picturePath='\" + picturePath + '\\'' +\r\n                \", phone='\" + phone + '\\'' +\r\n                '}';\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/other/entity/Pet.java	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ app/src/main/java/com/example/pet/other/entity/Pet.java	(date 1607599506494)
@@ -14,15 +14,15 @@
     private int userId;
     private String petAutograph;
     private String picturePath;
-    private String phone;
-
-    public String getPhone() {
-        return phone;
-    }
-
-    public void setPhone(String phone) {
-        this.phone = phone;
-    }
+//    private String phone;
+//
+//    public String getPhone() {
+//        return phone;
+//    }
+//
+//    public void setPhone(String phone) {
+//        this.phone = phone;
+//    }
 
     public String getPicturePath() {
         return picturePath;
@@ -111,7 +111,6 @@
                 ", userId=" + userId +
                 ", petAutograph='" + petAutograph + '\'' +
                 ", picturePath='" + picturePath + '\'' +
-                ", phone='" + phone + '\'' +
                 '}';
     }
 }
Index: app/src/main/res/layout/activity_pet.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:orientation=\"vertical\"\r\n    android:background=\"#fff\">\r\n    <!--顶栏-->\r\n    <RelativeLayout\r\n\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginLeft=\"25dp\"\r\n        android:layout_marginRight=\"25dp\">\r\n        <Button\r\n            android:textColor=\"@color/red\"\r\n            android:id=\"@+id/pet_update\"\r\n            android:layout_alignParentBottom=\"true\"\r\n            android:background=\"@drawable/edit\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:text=\"修改\" />\r\n\r\n        <ScrollView\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"match_parent\"\r\n            android:layout_above=\"@id/pet_update\">\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"match_parent\"\r\n                android:orientation=\"vertical\">\r\n\r\n                <ImageView\r\n                    android:id=\"@+id/pet_photo\"\r\n                    android:layout_width=\"250dp\"\r\n                    android:layout_height=\"200dp\"\r\n                    android:layout_gravity=\"center\"\r\n                    android:layout_marginTop=\"21dp\"\r\n                    android:background=\"@drawable/hashiqi\" />\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"50dp\"\r\n                    android:layout_marginTop=\"50dp\"\r\n                    android:background=\"#fff\"\r\n                    >\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:layout_marginRight=\"25sp\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:text=\"爱称\"\r\n                        android:textColor=\"#000\"\r\n                        android:textSize=\"12sp\" />\r\n\r\n                    <LinearLayout\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:background=\"@drawable/bg_myinfo\"\r\n                        android:orientation=\"vertical\">\r\n\r\n                        <EditText\r\n                            android:id=\"@+id/pet_name\"\r\n                            android:layout_width=\"match_parent\"\r\n                            android:layout_height=\"match_parent\"\r\n                            android:background=\"@null\"\r\n                            android:gravity=\"center_vertical\"\r\n                            android:hint=\"有光\"\r\n                            android:textSize=\"12sp\" />\r\n                    </LinearLayout>\r\n\r\n\r\n                </LinearLayout>\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"50dp\"\r\n                    android:background=\"#fff\"\r\n                    >\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:layout_marginRight=\"25sp\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:text=\"种类\"\r\n                        android:textColor=\"#000\"\r\n                        android:textSize=\"12sp\" />\r\n\r\n                    <LinearLayout\r\n                        android:id=\"@+id/ll_pet_type\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:background=\"@drawable/bg_myinfo\"\r\n                        android:orientation=\"vertical\">\r\n\r\n                        <TextView\r\n                            android:id=\"@+id/pet_type\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"match_parent\"\r\n                            android:background=\"@null\"\r\n                            android:gravity=\"center_vertical\"\r\n                            android:hint=\"哈士奇\"\r\n                            android:textColor=\"@color/black\"\r\n                            android:textSize=\"12sp\" />\r\n                    </LinearLayout>\r\n\r\n\r\n                </LinearLayout>\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"50dp\"\r\n                    android:background=\"#fff\"\r\n                    >\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:layout_marginRight=\"25sp\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:text=\"年龄\"\r\n                        android:textColor=\"#000\"\r\n                        android:textSize=\"12sp\" />\r\n\r\n                    <LinearLayout\r\n                        android:id=\"@+id/ll_pet_age\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:background=\"@drawable/bg_myinfo\"\r\n                        android:orientation=\"vertical\">\r\n\r\n                        <EditText\r\n                            android:id=\"@+id/pet_age\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"match_parent\"\r\n                            android:background=\"@null\"\r\n                            android:gravity=\"center_vertical\"\r\n                            android:hint=\"4岁\"\r\n                            android:textColor=\"@color/black\"\r\n                            android:textSize=\"12sp\" />\r\n                    </LinearLayout>\r\n                </LinearLayout>\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"@drawable/bg_myinfo\"\r\n                    android:orientation=\"vertical\">\r\n                    <TextView\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_marginTop=\"25sp\"\r\n                        android:layout_marginBottom=\"20dp\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:text=\"宠物简介\"\r\n                        android:textColor=\"#000\"\r\n                        android:textSize=\"12sp\" />\r\n                    <RelativeLayout\r\n                        android:layout_marginBottom=\"30dp\"\r\n                        android:background=\"@drawable/bg_myinfo\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"100dp\">\r\n\r\n                        <EditText\r\n                            android:id=\"@+id/pet_autograph\"\r\n                            android:layout_width=\"match_parent\"\r\n                            android:layout_height=\"100dp\"\r\n                            android:background=\"@null\"\r\n                            android:enabled=\"true\"\r\n                            android:gravity=\"start\"\r\n                            android:hint=\"阿巴阿巴阿巴\"\r\n                            android:inputType=\"textMultiLine\"\r\n                            android:maxLines=\"6\"\r\n                            android:minLines=\"6\"\r\n                            android:scrollbars=\"vertical\"\r\n                            android:textSize=\"12sp\" />\r\n                        <TextView\r\n                            android:id=\"@+id/tv_input\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:layout_alignParentBottom=\"true\"\r\n                            android:layout_alignParentRight=\"true\"\r\n                            android:layout_marginRight=\"10dp\"\r\n                            android:text=\"0/200\"/>\r\n                    </RelativeLayout>\r\n                </LinearLayout>\r\n            </LinearLayout>\r\n        </ScrollView>\r\n\r\n    </RelativeLayout>\r\n\r\n\r\n</LinearLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_pet.xml	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ app/src/main/res/layout/activity_pet.xml	(date 1607565116840)
@@ -8,9 +8,7 @@
     <RelativeLayout
 
         android:layout_width="match_parent"
-        android:layout_height="wrap_content"
-        android:layout_marginLeft="25dp"
-        android:layout_marginRight="25dp">
+        android:layout_height="wrap_content">
         <Button
             android:textColor="@color/red"
             android:id="@+id/pet_update"
@@ -27,15 +25,16 @@
             <LinearLayout
                 android:layout_width="match_parent"
                 android:layout_height="match_parent"
-                android:orientation="vertical">
+                android:orientation="vertical"
+                android:layout_marginLeft="25dp"
+                android:layout_marginRight="25dp">
 
                 <ImageView
                     android:id="@+id/pet_photo"
                     android:layout_width="250dp"
                     android:layout_height="200dp"
                     android:layout_gravity="center"
-                    android:layout_marginTop="21dp"
-                    android:background="@drawable/hashiqi" />
+                    android:layout_marginTop="21dp" />
 
                 <LinearLayout
                     android:layout_width="match_parent"
Index: app/src/main/java/com/example/pet/my/editinfo/EditInfo.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.my.editinfo;\r\n\r\nimport androidx.annotation.Nullable;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.appcompat.widget.Toolbar;\r\nimport androidx.core.app.ActivityCompat;\r\n\r\nimport android.app.Activity;\r\nimport android.content.ContentResolver;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.content.pm.PackageManager;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.BitmapFactory;\r\nimport android.graphics.Rect;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.os.Environment;\r\nimport android.os.Handler;\r\nimport android.os.IBinder;\r\nimport android.os.Looper;\r\nimport android.os.Message;\r\nimport android.provider.MediaStore;\r\nimport android.text.Editable;\r\nimport android.text.TextWatcher;\r\nimport android.util.Log;\r\nimport android.view.Gravity;\r\nimport android.view.MotionEvent;\r\nimport android.view.View;\r\nimport android.view.inputmethod.InputMethodManager;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.PopupWindow;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.bigkoo.pickerview.builder.OptionsPickerBuilder;\r\nimport com.bigkoo.pickerview.builder.TimePickerBuilder;\r\nimport com.bigkoo.pickerview.listener.CustomListener;\r\nimport com.bigkoo.pickerview.listener.OnOptionsSelectListener;\r\nimport com.bigkoo.pickerview.listener.OnTimeSelectListener;\r\nimport com.bigkoo.pickerview.view.OptionsPickerView;\r\nimport com.bigkoo.pickerview.view.TimePickerView;\r\nimport com.example.pet.R;\r\nimport com.example.pet.my.SetPassword;\r\nimport com.example.pet.other.Cache;\r\nimport com.example.pet.other.entity.User;\r\nimport com.google.gson.Gson;\r\nimport com.luck.picture.lib.PictureSelector;\r\nimport com.luck.picture.lib.config.PictureConfig;\r\nimport com.luck.picture.lib.config.PictureMimeType;\r\nimport com.luck.picture.lib.entity.LocalMedia;\r\n\r\nimport java.io.ByteArrayOutputStream;\r\nimport java.io.File;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.net.MalformedURLException;\r\nimport java.net.URL;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.ArrayList;\r\nimport java.util.Calendar;\r\nimport java.util.Date;\r\nimport java.util.List;\r\n\r\nimport cn.jiguang.net.HttpUtils;\r\nimport de.hdodenhof.circleimageview.CircleImageView;\r\nimport okhttp3.Call;\r\nimport okhttp3.Callback;\r\nimport okhttp3.MediaType;\r\nimport okhttp3.MultipartBody;\r\nimport okhttp3.OkHttpClient;\r\nimport okhttp3.Request;\r\nimport okhttp3.RequestBody;\r\nimport okhttp3.Response;\r\n\r\nimport static com.luck.picture.lib.config.PictureConfig.REQUEST_CAMERA;\r\n\r\npublic class EditInfo extends AppCompatActivity {\r\n    private User user = new User();\r\n    private TextView upSex;\r\n    private PopupWindow popupWindow;\r\n    private Toolbar toolbar;\r\n    private CircleImageView upPhoto;\r\n    private TextView upBrithday;\r\n    private EditText upName;\r\n    private TimePickerView pvTime;\r\n    private OptionsPickerView pvCustomOptions;\r\n    private ArrayList<String> cardItem = new ArrayList<>();\r\n    //输入框初始值\r\n    private int num = 0;\r\n    //输入框最大值\r\n    public int mMaxNum=200;\r\n    public EditText etInput;\r\n    private TextView tvInput;\r\n    private String image_path;\r\n    private static final int REQUEST_EXTERNAL_STORAGE = 1;\r\n    private static String[] PERMISSIONS_STORAGE = {\r\n            \"android.permission.READ_EXTERNAL_STORAGE\",\r\n            \"android.permission.WRITE_EXTERNAL_STORAGE\",\r\n            \"android.permission.CAMER\"};\r\n\r\n    Handler hd = new Handler() {\r\n        @Override\r\n        public void handleMessage(Message msg) {\r\n            if(msg.what == 1){\r\n                Toast.makeText(EditInfo.this,\"上传成功\",Toast.LENGTH_SHORT);\r\n                upData();\r\n            }else if(msg.what == 2){\r\n                Log.e(\"up\",\"6b\");\r\n                Toast.makeText(EditInfo.this,\"上传失败了\",Toast.LENGTH_SHORT);\r\n            }else if(msg.what == 3){\r\n                Toast.makeText(EditInfo.this,\"上传成功\",Toast.LENGTH_SHORT);\r\n                EditInfo.this.finish();\r\n            }else {\r\n                Log.e(\"up\",\"6b\");\r\n                Toast.makeText(EditInfo.this,\"上传失败了\",Toast.LENGTH_SHORT);\r\n            }\r\n        }\r\n    };\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_edit_info);\r\n//        if (Build.VERSION.SDK_INT >= 21) {   //只有5.0及以上系统才支持，因此这里先进行了一层if判断\r\n//            View decorView = getWindow().getDecorView();\r\n//            int option = View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN\r\n//                    | View.SYSTEM_UI_FLAG_LAYOUT_STABLE    //设置为全屏显示，必须这两行代码一起才能生效\r\n//                    |View.SYSTEM_UI_FLAG_LIGHT_STATUS_BAR;  //因为背景为浅色，设置通知栏字体颜色为深色\r\n//            decorView.setSystemUiVisibility(option);\r\n//            getWindow().setStatusBarColor(Color.TRANSPARENT);//设置为透明\r\n//        }\r\n        //设置控件内容\r\n        setView();\r\n        initData();\r\n        //加载数据\r\n        upSex();\r\n        upBri();\r\n        countWords();\r\n    }\r\n\r\n    private void initData() {\r\n        cardItem.add(\"未知\");\r\n        cardItem.add(\"男\");\r\n        cardItem.add(\"女\");\r\n        Log.e(\"initData\",\"start\");\r\n        if(Cache.user.getPicturePath() != null){\r\n            upPhoto.setImageBitmap(Cache.user.getPhoto());\r\n        }\r\n        if(Cache.user.getUserName() != null){\r\n            upName.setText(Cache.user.getUserName());\r\n        }\r\n        if(Cache.user.getUserSex() != null){\r\n            upSex.setText(Cache.user.getUserSex());\r\n        }\r\n        if(Cache.user.getUserBrithday() != null){\r\n            upBrithday.setText(Cache.user.getUserBrithday());\r\n        }\r\n        if(Cache.user.getUserAutograph() != null){\r\n            etInput.setText(Cache.user.getUserAutograph());\r\n        }\r\n        Log.e(\"initData\",\"over\");\r\n    }\r\n\r\n    private void setView() {\r\n        upSex = findViewById(R.id.edit_info_sex);\r\n        toolbar = findViewById(R.id.edit_toolbar);\r\n        toolbar.setNavigationOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                EditInfo.this.finish();\r\n            }\r\n        });\r\n        upBrithday = findViewById(R.id.upBrithday);\r\n        upName = findViewById(R.id.upName);\r\n        upPhoto = findViewById(R.id.upPhoto);\r\n        etInput = findViewById(R.id.et_input);\r\n        tvInput = findViewById(R.id.tv_input);\r\n\r\n\r\n\r\n    }\r\n\r\n    public void onClicked(View view) {\r\n        switch(view.getId()){\r\n            case R.id.upPhoto:\r\n                //上传头像\r\n                upPic();\r\n                break;\r\n            case R.id.upName:\r\n                break;\r\n            case R.id.ll_upSex:\r\n                pvCustomOptions.show();\r\n                break;\r\n            case R.id.ll_upBrithday:\r\n                pvTime.show();\r\n                break;\r\n            case R.id.tv_save:\r\n                //保存信息\r\n                if(image_path == null){\r\n                    upData();\r\n                }else {\r\n                    upPhoto(image_path);\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    private void upSex() {\r\n        // 注意：自定义布局中，id为 optionspicker 或者 timepicker 的布局以及其子控件必须要有，否则会报空指针\r\n        // 具体可参考demo 里面的两个自定义布局\r\n        pvCustomOptions = new OptionsPickerBuilder(this, new OnOptionsSelectListener() {\r\n            @Override\r\n            public void onOptionsSelect(int options1, int options2, int options3, View v) {\r\n               //返回的分别是三个级别的选中位置\r\n                String tx = cardItem.get(options1);\r\n                upSex.setText(tx);\r\n                Cache.user.setUserSex(tx);\r\n                user.setUserSex(tx);\r\n            }\r\n        })\r\n                .setLayoutRes(R.layout.picker_sex_bg, new CustomListener() {\r\n                    @Override\r\n                    public void customLayout(View v) {\r\n                        //自定义布局中的控件初始化及事件处理\r\n                        final TextView tvSubmit = v.findViewById(R.id.tv_finish);\r\n                        TextView tvCancel = v.findViewById(R.id.tv_cancel);\r\n                        TextView tyTitle = v.findViewById(R.id.tv_title);\r\n                        tyTitle.setText(\"性别\");\r\n                        tvSubmit.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvCustomOptions.returnData();\r\n                                pvCustomOptions.dismiss();\r\n                            }\r\n                        });\r\n                        tvCancel.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvCustomOptions.dismiss();\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                })\r\n                .setLineSpacingMultiplier(1.5f)//滚轮字体间距\r\n                .setContentTextSize(22)//字体大小\r\n                .setOutSideCancelable(true)\r\n                .build();\r\n        pvCustomOptions.setPicker(cardItem);//添加数据\r\n    }\r\n\r\n    private void upBri() {\r\n        Calendar selectedDate = Calendar.getInstance();//系统当前时间\r\n        Calendar startDate = Calendar.getInstance();\r\n        startDate.set(1900, 1, 1);\r\n        Calendar endDate = Calendar.getInstance();\r\n        pvTime = new TimePickerBuilder(this, new OnTimeSelectListener() {\r\n            @Override\r\n            public void onTimeSelect(Date date, View v) {\r\n                upBrithday.setText(getTimes(date));\r\n                Cache.user.setUserBrithday(getTimes(date));\r\n                user.setUserBrithday(getTimes(date));\r\n            }\r\n        })\r\n                .setDate(selectedDate)\r\n                .setRangDate(startDate,endDate)\r\n                .setLayoutRes(R.layout.picker_time_bg, new CustomListener() {\r\n                    @Override\r\n                    public void customLayout(View v) {\r\n                        TextView tvSubmit = v.findViewById(R.id.tv_finish);\r\n                        TextView tvCannel = v.findViewById(R.id.tv_cancel);\r\n                        tvSubmit.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvTime.returnData();\r\n                                pvTime.dismiss();\r\n                            }\r\n                        });\r\n                        tvCannel.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvTime.dismiss();\r\n                            }\r\n                        });\r\n                    }\r\n                })\r\n                .setContentTextSize(22)//字体大小\r\n                .setOutSideCancelable(true)\r\n                .setType(new boolean[]{true, true, true, false, false, false})\r\n                .setLabel(\"年\", \"月\", \"日\", \"时\", \"分\", \"秒\")\r\n                .setLineSpacingMultiplier(1.5f)\r\n                .setTextXOffset(0, 0, 0, 40, 0, -40)\r\n                .isCenterLabel(false) //是否只显示中间选中项的label文字，false则每项item全部都带有label。\r\n                .setDividerColor(0xFF24AD9D)\r\n                .build();\r\n    }\r\n\r\n    //格式化时间\r\n    private String getTimes(Date date) {\r\n        SimpleDateFormat format = new SimpleDateFormat(\"yyyy-MM-dd\");\r\n        return format.format(date);\r\n    }\r\n\r\n    /**\r\n     * 隐藏键盘\r\n     * @param ev\r\n     * @return\r\n     */\r\n    @Override\r\n    public boolean dispatchTouchEvent(MotionEvent ev) {\r\n        if (ev.getAction() == MotionEvent.ACTION_DOWN) {\r\n            View v = getCurrentFocus();\r\n            if (isShouldHideKeyboard(v, ev)) {\r\n                hideKeyboard(v.getWindowToken());\r\n            }\r\n        }\r\n        return super.dispatchTouchEvent(ev);\r\n    }\r\n\r\n    /**\r\n     * 根据EditText所在坐标和用户点击的坐标相对比，来判断是否隐藏键盘，因为当用户点击EditText时则不能隐藏\r\n     *\r\n     * @param v\r\n     * @param event\r\n     * @return\r\n     */\r\n    private boolean isShouldHideKeyboard(View v, MotionEvent event) {\r\n        if (v != null && (v instanceof EditText)) {\r\n            int[] l = {0, 0};\r\n            v.getLocationInWindow(l);\r\n            int left = l[0],\r\n                    top = l[1],\r\n                    bottom = top + v.getHeight(),\r\n                    right = left + v.getWidth();\r\n            if (event.getX() > left && event.getX() < right\r\n                    && event.getY() > top && event.getY() < bottom) {\r\n                // 点击EditText的事件，忽略它。\r\n                return false;\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n        // 如果焦点不是EditText则忽略，这个发生在视图刚绘制完，第一个焦点不在EditText上，和用户用轨迹球选择其他的焦点\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 获取InputMethodManager，隐藏软键盘\r\n     * @param token\r\n     */\r\n    private void hideKeyboard(IBinder token) {\r\n        if (token != null) {\r\n            InputMethodManager im = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);\r\n            im.hideSoftInputFromWindow(token, InputMethodManager.HIDE_NOT_ALWAYS);\r\n        }\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * 记录字数和限制最大输入字数\r\n     */\r\n    private void countWords() {\r\n        etInput.addTextChangedListener(new TextWatcher() {\r\n            //记录输入的字数\r\n            private CharSequence wordNum;\r\n            private int selectionStart;\r\n            private int selectionEnd;\r\n            @Override\r\n            public void beforeTextChanged(CharSequence s, int start, int count, int after) {\r\n\r\n            }\r\n\r\n            @Override\r\n            public void onTextChanged(CharSequence s, int start, int before, int count) {\r\n                //实时记录输入的字数\r\n                wordNum= s;\r\n            }\r\n\r\n            @Override\r\n            public void afterTextChanged(Editable s) {\r\n\r\n                Cache.user.setUserAutograph(Cache.user.getUserAutograph() + s);\r\n                int number = num + s.length();\r\n                //TextView显示剩余字数\r\n                tvInput.setText(\"\" + number+\"/\" + mMaxNum);\r\n                selectionStart=etInput.getSelectionStart();\r\n                selectionEnd = etInput.getSelectionEnd();\r\n                //判断大于最大值\r\n                if (wordNum.length() > mMaxNum) {\r\n                    //删除多余输入的字（不会显示出来）\r\n                    s.delete(selectionStart - 1, selectionEnd);\r\n                    int tempSelection = selectionEnd;\r\n                    etInput.setText(s);\r\n                    etInput.setSelection(tempSelection);//设置光标在最后\r\n                    //吐司最多输入300字\r\n                    Toast.makeText(EditInfo.this, \"最多输入\"+mMaxNum+\"字\", Toast.LENGTH_SHORT).show();\r\n\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    private void upPic() {\r\n        //动态申请权限\r\n        verifyStoragePermissions(this);\r\n        PictureSelector.create(this)\r\n                .openGallery(PictureConfig.TYPE_IMAGE)\r\n                .imageEngine(GlideEngine.createGlideEngine())\r\n                .imageSpanCount(4)// 每行显示个数 int\r\n                .maxSelectNum(1)\r\n                .isWeChatStyle(true)\r\n                .selectionMode(PictureConfig.SINGLE)// 多选 or 单选 PictureConfig.MULTIPLE or PictureConfig.SINGLE\r\n                .isSingleDirectReturn(true)//PictureConfig.SINGLE模式下是否直接返回\r\n                .isPreviewImage(true)// 是否可预览图片 true or false\r\n                .isCamera(true)// 是否显示拍照按钮 true or false\r\n                .imageFormat(PictureMimeType.JPEG)// 拍照保存图片格式后缀,默认jpeg\r\n                .isZoomAnim(true)// 图片列表点击 缩放效果 默认true\r\n                .setOutputCameraPath(Const.getImgPath())// 自定义拍照保存路径,可不填\r\n                .isEnableCrop(true)// 是否裁剪 true or false\r\n                .isCompress(true)// 是否压缩 true or false\r\n                .compressSavePath(Const.getImgPath())//压缩图片保存地址\r\n                .freeStyleCropEnabled(true)// 裁剪框是否可拖拽 true or false\r\n                .showCropGrid(true)// 是否显示裁剪矩形网格 圆形裁剪时建议设为false    true or false\r\n                .forResult(PictureConfig.CHOOSE_REQUEST);//结果回调onActivityResult code\r\n    }\r\n\r\n    //接受回调\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        if (resultCode == -1 && data != null) {\r\n            switch (requestCode) {\r\n                case PictureConfig.CHOOSE_REQUEST:\r\n                    List<LocalMedia> selectList = PictureSelector.obtainMultipleResult(data);\r\n                    image_path = selectList.get(0).getCompressPath();\r\n                    upPhoto.setImageURI(Uri.parse(image_path));\r\n                    //上传图片\r\n                    Cache.user.setPicturePath(image_path);\r\n                    user.setPicturePath(image_path);\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 上传图片\r\n     * 未测试\r\n     */\r\n    public void upPhoto(String path){\r\n        Cache.user.setUserName(upName.getText().toString());\r\n        Log.e(\"name\",upName.getText().toString());\r\n        Log.e(\"up\",\"1\");\r\n        File file = new File(path);\r\n        Log.e(\"up\",\"2\");\r\n        String url = Cache.MY_URL + \"UpdataUserInfoServlet\";\r\n        OkHttpClient okHttpClient = new OkHttpClient();\r\n        if(file != null && file.exists()){\r\n            RequestBody requestBody = new MultipartBody.Builder()\r\n                    .setType(MultipartBody.FORM)\r\n                    .addFormDataPart(\"file\",\r\n                            Cache.userPhone + \".jpg\",\r\n                            RequestBody.create(MediaType.parse(\"image/png\"),file))\r\n                    .addFormDataPart(\"phone\",Cache.userPhone)\r\n                    .build();\r\n            Request request = new Request.Builder()\r\n                    .url(url)\r\n                    .post(requestBody)\r\n                    .build();\r\n            Call call = okHttpClient.newCall(request);\r\n\r\n            Log.e(\"up\",\"3\");\r\n            call.enqueue(new Callback() {\r\n                @Override\r\n                public void onFailure(Call call, IOException e) {\r\n                    //失败\r\n                    Log.e(\"up\",\"4b\");\r\n                    Message msg = new Message();\r\n                    msg.what = 2;\r\n                    msg.obj = 1;\r\n                    Log.e(\"up\",\"5b\");\r\n                    hd.sendMessage(msg);\r\n                    Log.e(\"up\",\"6b\");\r\n                    e.printStackTrace();\r\n                }\r\n\r\n                @Override\r\n                public void onResponse(Call call, Response response) throws IOException {\r\n                    //上传成功\r\n                    Log.e(\"up\",\"4a\");\r\n                    Message msg = new Message();\r\n                    String res = response.body().string();\r\n                    if(res.equals(\"true\")){\r\n                        msg.what = 1;\r\n                        msg.obj = 1;\r\n                        Log.e(\"updata\",res);\r\n                    }else {\r\n                        msg.what = 2;\r\n                        msg.obj = 1;\r\n                        Log.e(\"updata\",res);\r\n                    }\r\n                    hd.sendMessage(msg);\r\n\r\n                }\r\n            });\r\n\r\n        }else {\r\n            Toast.makeText(EditInfo.this,\"请添加头像\",Toast.LENGTH_SHORT);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 上传数据\r\n     */\r\n    public void upData(){\r\n        OkHttpClient okHttpClient = new OkHttpClient();\r\n        //创建请求体对象\r\n        user.setUserPhone(Cache.userPhone);\r\n        String name = upName.getText().toString();\r\n        if(name == null){\r\n            user.setUserName(\"\");\r\n        }else {\r\n            user.setUserName(name);\r\n        }\r\n        String autograph = etInput.getText().toString();\r\n        if(autograph == null){\r\n            user.setUserAutograph(\"\");\r\n        }else {\r\n            user.setUserAutograph(autograph);\r\n        }\r\n        String path = Cache.user.getPicturePath();\r\n        if(path == null){\r\n            user.setPicturePath(\"\");\r\n        }else {\r\n            user.setPicturePath(path);\r\n        }\r\n        String sex = upSex.getText().toString();\r\n        if(sex == null){\r\n            user.setUserSex(\"未知\");\r\n        }else {\r\n            user.setUserSex(sex);\r\n        }\r\n        String brithday = upBrithday.getText().toString();\r\n        if(brithday == null){\r\n            Calendar selectedDate = Calendar.getInstance();//系统当前时间\r\n            user.setUserBrithday(getTimes(selectedDate.getTime()));\r\n        }else {\r\n            user.setUserBrithday(brithday);\r\n        }\r\n\r\n        RequestBody requestBody = RequestBody.create(MediaType.parse(\r\n                \"text/plain;charset=UTF-8\"),new Gson().toJson(user));\r\n        //3.创建请求对象\r\n        Request request = new Request.Builder()\r\n                .post(requestBody)\r\n                .url(Cache.MY_URL + \"UpDataUserInfo2Servlet\")\r\n                .build();\r\n        //3.创建Call对象，发送请求，并接受响应\r\n        Call call = okHttpClient.newCall(request);\r\n        //异步网络请求（无需手动使用子线程）\r\n        call.enqueue(new Callback() {\r\n            @Override\r\n            public void onFailure(Call call, IOException e) {\r\n                //失败\r\n                Message msg = new Message();\r\n                msg.what = 4;\r\n                msg.obj = 3;\r\n                Log.e(\"up\",\"5b\");\r\n                hd.sendMessage(msg);\r\n                Log.e(\"up\",\"6b\");\r\n                e.printStackTrace();\r\n            }\r\n\r\n            @Override\r\n            public void onResponse(Call call, Response response) throws IOException {\r\n                //上传成功\r\n                Message msg = new Message();\r\n                String res = response.body().string();\r\n                if(res.equals(\"true\")){\r\n                    msg.what = 3;\r\n                    msg.obj = 1;\r\n                    Log.e(\"updata\",res);\r\n                }else {\r\n                    msg.what = 2;\r\n                    msg.obj = 1;\r\n                    Log.e(\"updata\",res);\r\n                }\r\n                hd.sendMessage(msg);\r\n\r\n            }\r\n        });\r\n    }\r\n\r\n    //然后通过一个函数来申请权限\r\n    public static void verifyStoragePermissions(Activity activity) {\r\n        try {\r\n            //检测是否有写的权限\r\n            int permission = ActivityCompat.checkSelfPermission(activity,\r\n                    \"android.permission.WRITE_EXTERNAL_STORAGE\");\r\n            if (permission != PackageManager.PERMISSION_GRANTED) {\r\n                // 没有写的权限，去申请写的权限，会弹出对话框\r\n                ActivityCompat.requestPermissions(activity, PERMISSIONS_STORAGE,REQUEST_EXTERNAL_STORAGE);\r\n            }\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/my/editinfo/EditInfo.java	(revision 4494888c939e5fd8ef238b7b9016df71aa669b94)
+++ app/src/main/java/com/example/pet/my/editinfo/EditInfo.java	(date 1607603613864)
@@ -43,6 +43,7 @@
 import com.bigkoo.pickerview.view.OptionsPickerView;
 import com.bigkoo.pickerview.view.TimePickerView;
 import com.example.pet.R;
+import com.example.pet.my.PetActivity;
 import com.example.pet.my.SetPassword;
 import com.example.pet.other.Cache;
 import com.example.pet.other.entity.User;
@@ -111,6 +112,11 @@
                 Log.e("up","6b");
                 Toast.makeText(EditInfo.this,"上传失败了",Toast.LENGTH_SHORT);
             }else if(msg.what == 3){
+                Cache.user.setPicturePath(Cache.userPhone + ".jpg");
+                Cache.user.setUserBrithday(upBrithday.getText().toString());
+                Cache.user.setUserSex(upSex.getText().toString());
+                Cache.user.setUserName(upName.getText().toString());
+                Cache.user.setUserAutograph(etInput.getText().toString());
                 Toast.makeText(EditInfo.this,"上传成功",Toast.LENGTH_SHORT);
                 EditInfo.this.finish();
             }else {
@@ -216,7 +222,7 @@
                //返回的分别是三个级别的选中位置
                 String tx = cardItem.get(options1);
                 upSex.setText(tx);
-                Cache.user.setUserSex(tx);
+//                Cache.user.setUserSex(tx);
                 user.setUserSex(tx);
             }
         })
@@ -260,7 +266,7 @@
             @Override
             public void onTimeSelect(Date date, View v) {
                 upBrithday.setText(getTimes(date));
-                Cache.user.setUserBrithday(getTimes(date));
+//                Cache.user.setUserBrithday(getTimes(date));
                 user.setUserBrithday(getTimes(date));
             }
         })
@@ -371,6 +377,16 @@
             @Override
             public void beforeTextChanged(CharSequence s, int start, int count, int after) {
 
+                wordNum = s;
+                //判断大于最大值
+                if (wordNum.length() > mMaxNum) {
+                    int tempSelection = selectionEnd;
+                    etInput.setText(s);
+                    etInput.setSelection(tempSelection);//设置光标在最后
+                    //吐司最多输入300字
+                    Toast.makeText(EditInfo.this, "最多输入"+mMaxNum+"字", Toast.LENGTH_SHORT).show();
+
+                }
             }
 
             @Override
@@ -381,8 +397,6 @@
 
             @Override
             public void afterTextChanged(Editable s) {
-
-                Cache.user.setUserAutograph(Cache.user.getUserAutograph() + s);
                 int number = num + s.length();
                 //TextView显示剩余字数
                 tvInput.setText("" + number+"/" + mMaxNum);
@@ -425,6 +439,7 @@
                 .compressSavePath(Const.getImgPath())//压缩图片保存地址
                 .freeStyleCropEnabled(true)// 裁剪框是否可拖拽 true or false
                 .showCropGrid(true)// 是否显示裁剪矩形网格 圆形裁剪时建议设为false    true or false
+                .synOrAsy(false)
                 .forResult(PictureConfig.CHOOSE_REQUEST);//结果回调onActivityResult code
     }
 
@@ -439,7 +454,7 @@
                     image_path = selectList.get(0).getCompressPath();
                     upPhoto.setImageURI(Uri.parse(image_path));
                     //上传图片
-                    Cache.user.setPicturePath(image_path);
+//                    Cache.user.setPicturePath(image_path);
                     user.setPicturePath(image_path);
                     break;
             }
@@ -451,7 +466,7 @@
      * 未测试
      */
     public void upPhoto(String path){
-        Cache.user.setUserName(upName.getText().toString());
+//        Cache.user.setUserName(upName.getText().toString());
         Log.e("name",upName.getText().toString());
         Log.e("up","1");
         File file = new File(path);
diff --git .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_5_14_54__Default_Changelist_.xml .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_5_14_54__Default_Changelist_.xml
