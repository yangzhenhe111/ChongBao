Index: app/src/main/res/layout/activity_main.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<RelativeLayout android:layout_width=\"match_parent\"\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    android:layout_height=\"match_parent\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    tools:context=\".MainActivity\">\r\n    <LinearLayout\r\n        android:id=\"@+id/tabs\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_alignParentBottom=\"true\"\r\n        android:orientation=\"horizontal\"\r\n        android:padding=\"10dp\">\r\n        <LinearLayout\r\n            android:id=\"@+id/ll_forum\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\"\r\n            android:gravity=\"center\"\r\n            android:layout_weight=\"1\">\r\n            <ImageView\r\n                android:id=\"@+id/iv_forum\"\r\n                android:layout_width=\"27dp\"\r\n                android:layout_height=\"27dp\"\r\n                android:src=\"@drawable/onee\"/>\r\n            <TextView\r\n                android:id=\"@+id/tv_forum\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"center_horizontal\"\r\n                android:text=\"宠物圈\"/>\r\n        </LinearLayout>\r\n        <LinearLayout\r\n            android:id=\"@+id/ll_nursing\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\"\r\n            android:gravity=\"center\"\r\n            android:layout_weight=\"1\">\r\n            <ImageView\r\n                android:id=\"@+id/iv_nursing\"\r\n                android:layout_width=\"30dp\"\r\n                android:layout_height=\"30dp\"\r\n                android:src=\"@drawable/twoo\"/>\r\n            <TextView\r\n                android:id=\"@+id/tv_nursing\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"center_horizontal\"\r\n                android:text=\"@string/tabs_nursing\"/>\r\n        </LinearLayout>\r\n        <LinearLayout\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_weight=\"1\"\r\n            android:gravity=\"center\">\r\n            <ImageView\r\n                android:onClick=\"pop\"\r\n                android:layout_width=\"40dp\"\r\n                android:layout_marginRight=\"15dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:background=\"@drawable/jia\"\r\n                android:layout_height=\"40dp\" />\r\n\r\n        </LinearLayout>\r\n        <LinearLayout\r\n            android:id=\"@+id/ll_chat\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\"\r\n            android:gravity=\"center\"\r\n            android:layout_weight=\"1\">\r\n\r\n            <ImageView\r\n                android:id=\"@+id/iv_chat\"\r\n                android:layout_width=\"27dp\"\r\n                android:layout_height=\"27dp\"\r\n                android:src=\"@drawable/three\" />\r\n            <TextView\r\n                android:id=\"@+id/tv_chat\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"center_horizontal\"\r\n                android:text=\"消息\"/>\r\n        </LinearLayout>\r\n        <LinearLayout\r\n            android:id=\"@+id/ll_my\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\"\r\n            android:gravity=\"center\"\r\n            android:layout_weight=\"1\">\r\n            <ImageView\r\n                android:id=\"@+id/iv_my\"\r\n                android:layout_width=\"27dp\"\r\n                android:layout_height=\"27dp\"\r\n                android:src=\"@drawable/four\"/>\r\n            <TextView\r\n                android:id=\"@+id/tv_my\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:gravity=\"center_horizontal\"\r\n                android:text=\"@string/tabs_my\"/>\r\n        </LinearLayout>\r\n    </LinearLayout>\r\n\r\n    <androidx.viewpager.widget.ViewPager\r\n        android:layout_above=\"@+id/tabs\"\r\n        android:id=\"@+id/viewpager\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"match_parent\">\r\n    </androidx.viewpager.widget.ViewPager>\r\n</RelativeLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_main.xml	(revision f4aaf511276e0f60eb82edaef0144fc6ff002c53)
+++ app/src/main/res/layout/activity_main.xml	(date 1607766235163)
@@ -40,8 +40,8 @@
             android:layout_weight="1">
             <ImageView
                 android:id="@+id/iv_nursing"
-                android:layout_width="30dp"
-                android:layout_height="30dp"
+                android:layout_width="27dp"
+                android:layout_height="27dp"
                 android:src="@drawable/twoo"/>
             <TextView
                 android:id="@+id/tv_nursing"
@@ -52,16 +52,18 @@
         </LinearLayout>
         <LinearLayout
             android:layout_width="wrap_content"
-            android:layout_height="wrap_content"
+            android:layout_height="match_parent"
             android:layout_weight="1"
-            android:gravity="center">
+            android:gravity="center"
+            android:layout_gravity="center"
+            android:onClick="pop">
+
             <ImageView
-                android:onClick="pop"
-                android:layout_width="40dp"
-                android:layout_marginRight="15dp"
+                android:layout_width="33dp"
+                android:layout_height="27dp"
                 android:layout_gravity="center"
-                android:background="@drawable/jia"
-                android:layout_height="40dp" />
+                android:layout_marginRight="15dp"
+                android:background="@drawable/jia" />
 
         </LinearLayout>
         <LinearLayout
Index: .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_5_14_54__Default_Changelist_.xml
===================================================================
--- .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_5_14_54__Default_Changelist_.xml	(revision f4aaf511276e0f60eb82edaef0144fc6ff002c53)
+++ .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_5_14_54__Default_Changelist_.xml	(revision f4aaf511276e0f60eb82edaef0144fc6ff002c53)
@@ -1,4 +0,0 @@
-<changelist name="Uncommitted_changes_before_Update_at_2020_12_5_14_54_[Default_Changelist]" date="1607151289808" recycled="true" deleted="true">
-  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_2020_12_5_14_54_[Default_Changelist]/shelved.patch" />
-  <option name="DESCRIPTION" value="Uncommitted changes before Update at 2020/12/5 14:54 [Default Changelist]" />
-</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_5_14_54_[Default_Changelist]/shelved.patch
===================================================================
--- .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_5_14_54_[Default_Changelist]/shelved.patch	(revision f4aaf511276e0f60eb82edaef0144fc6ff002c53)
+++ .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_5_14_54_[Default_Changelist]/shelved.patch	(revision f4aaf511276e0f60eb82edaef0144fc6ff002c53)
@@ -1,68 +0,0 @@
-Index: app/src/main/java/com/example/pet/forum/ForumFragment.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.pet.forum;\r\nimport android.content.Intent;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.BitmapFactory;\r\nimport android.media.Image;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\nimport android.os.Message;\r\nimport android.text.TextPaint;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageView;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.ListView;\r\nimport android.widget.PopupWindow;\r\nimport android.widget.RelativeLayout;\r\nimport android.widget.Switch;\r\nimport android.widget.TextView;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport com.example.pet.R;\r\nimport com.example.pet.other.Cache;\r\nimport com.example.pet.other.entity.Tips;\r\nimport com.youth.banner.Banner;\r\nimport com.youth.banner.BannerConfig;\r\nimport com.youth.banner.listener.OnBannerListener;\r\n\r\nimport org.json.JSONArray;\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\nimport java.io.BufferedReader;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.io.InputStreamReader;\r\nimport java.net.HttpURLConnection;\r\nimport java.net.MalformedURLException;\r\nimport java.net.ProtocolException;\r\nimport java.net.URL;\r\nimport java.net.URLConnection;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\nimport java.util.Map;\r\nimport java.util.concurrent.CountDownLatch;\r\n\r\npublic class ForumFragment extends Fragment {\r\n\r\n    private EditText et_search;\r\n    private Button btn_search;\r\n    private Button btn_publish;\r\n    private RelativeLayout forum_food;\r\n    private RelativeLayout forum_articles;\r\n    private RelativeLayout forum_daily;\r\n    private RelativeLayout forum_cosmetology;\r\n    private RelativeLayout forum_train;\r\n    private RelativeLayout forum_deworming;\r\n    private RelativeLayout forum_disease;\r\n    private RelativeLayout forum_randomtalk;\r\n    private RelativeLayout forum_question;\r\n    private RelativeLayout forum_sharephotos;\r\n    private TextView tv_food;\r\n    private TextView tv_articles;\r\n    private TextView tv_daily;\r\n    private TextView tv_cosmetology;\r\n    private TextView tv_train;\r\n    private TextView tv_deworming;\r\n    private TextView tv_disease;\r\n    private TextView tv_randomtalk;\r\n    private TextView tv_question;\r\n    private TextView tv_sharephotos;\r\n    private TextView tv_newest;\r\n    private TextView tv_hot;\r\n    private TextView tv_essence;\r\n    private ListView lv_tips;\r\n    private Banner banner;\r\n    private ArrayList<Tips> arrayList = new ArrayList<>();\r\n    private ArrayList<Tips> tipsArrayList;\r\n\r\n    private Handler handler = new Handler(){\r\n        @Override\r\n        public void handleMessage(@NonNull Message message) {\r\n            switch (message.what){\r\n                case 1:\r\n                    Log.e(\"handler\", \"gethere----------------------\");\r\n                    init((ArrayList) message.obj);\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(@NonNull final LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\r\n        View view = inflater.inflate(R.layout.fragment_forum,container,false);\r\n        getAllTips();\r\n        et_search = view.findViewById(R.id.et_main_search);\r\n        btn_search = view.findViewById(R.id.btn_main_search);\r\n        btn_search.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n\r\n            }\r\n        });\r\n        btn_publish = view.findViewById(R.id.btn_publish_articles);\r\n        btn_publish.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),PublishActivity.class);\r\n                startActivity(intent);\r\n                getActivity().finish();\r\n            }\r\n        });\r\n        tv_food = view.findViewById(R.id.tv_food);\r\n        tv_articles = view.findViewById(R.id.tv_articles);\r\n        tv_daily = view.findViewById(R.id.tv_daily);\r\n        tv_cosmetology = view.findViewById(R.id.tv_cosmetology);\r\n        tv_train = view.findViewById(R.id.tv_train);\r\n        tv_deworming = view.findViewById(R.id.tv_deworming);\r\n        tv_disease = view.findViewById(R.id.tv_disease);\r\n        tv_randomtalk = view.findViewById(R.id.tv_randomtalk);\r\n        tv_question = view.findViewById(R.id.tv_question);\r\n        tv_sharephotos = view.findViewById(R.id.tv_sharephotos);\r\n        final String food = tv_food.getText().toString();\r\n        final String articles = tv_articles.getText().toString();\r\n        final String daily = tv_daily.getText().toString();\r\n        final String cosmetology = tv_cosmetology.getText().toString();\r\n        final String train = tv_train.getText().toString();\r\n        final String deworming = tv_deworming.getText().toString();\r\n        final String disease = tv_disease.getText().toString();\r\n        final String randomtalk = tv_randomtalk.getText().toString();\r\n        final String question = tv_question.getText().toString();\r\n        final String sharephotos = tv_sharephotos.getText().toString();\r\n        forum_food = view.findViewById(R.id.forum_food);\r\n        forum_food.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                intent.putExtra(\"classified\",food);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_articles = view.findViewById(R.id.forum_articles);\r\n        forum_articles.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                intent.putExtra(\"classified\",articles);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_daily = view.findViewById(R.id.forum_daily);\r\n        forum_daily.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                intent.putExtra(\"classified\",daily);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_cosmetology = view.findViewById(R.id.forum_cosmetology);\r\n        forum_cosmetology.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                intent.putExtra(\"classified\",cosmetology);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_train = view.findViewById(R.id.forum_train);\r\n        forum_train.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                intent.putExtra(\"classified\",train);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_deworming = view.findViewById(R.id.forum_deworming);\r\n        forum_deworming.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                intent.putExtra(\"classified\",deworming);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_disease = view.findViewById(R.id.forum_disease);\r\n        forum_disease.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                intent.putExtra(\"classified\",disease);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_randomtalk = view.findViewById(R.id.forum_randomtalk);\r\n        forum_randomtalk.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                intent.putExtra(\"classified\",randomtalk);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_question = view.findViewById(R.id.forum_question);\r\n        forum_question.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                intent.putExtra(\"classified\",question);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        forum_sharephotos = view.findViewById(R.id.forum_sharephotos);\r\n        forum_sharephotos.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),ClassifiedForumActivity.class);\r\n                intent.putExtra(\"classified\",sharephotos);\r\n                getContext().startActivity(intent);\r\n            }\r\n        });\r\n        tv_newest = view.findViewById(R.id.forum_newest);\r\n        TextPaint base = tv_newest.getPaint();\r\n        base.setFakeBoldText(true);\r\n        tv_hot = view.findViewById(R.id.forum_hot);\r\n        tv_essence = view.findViewById(R.id.forum_essence);\r\n        tv_newest.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                tv_newest.setBackgroundColor(getResources().getColor(R.color.Blue));\r\n                tv_hot.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_essence.setBackgroundColor(getResources().getColor(R.color.White));\r\n                TextPaint newest = tv_newest.getPaint();\r\n                newest.setFakeBoldText(true);\r\n                TextPaint hot = tv_hot.getPaint();\r\n                hot.setFakeBoldText(false);\r\n                TextPaint essence = tv_essence.getPaint();\r\n                essence.setFakeBoldText(false);\r\n            }\r\n        });\r\n        tv_hot.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                tv_newest.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_hot.setBackgroundColor(getResources().getColor(R.color.Orange));\r\n                tv_essence.setBackgroundColor(getResources().getColor(R.color.White));\r\n                TextPaint newest = tv_newest.getPaint();\r\n                newest.setFakeBoldText(false);\r\n                TextPaint hot = tv_hot.getPaint();\r\n                hot.setFakeBoldText(true);\r\n                TextPaint essence = tv_essence.getPaint();\r\n                essence.setFakeBoldText(false);\r\n            }\r\n        });\r\n        tv_essence.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                tv_newest.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_hot.setBackgroundColor(getResources().getColor(R.color.White));\r\n                tv_essence.setBackgroundColor(getResources().getColor(R.color.Purple));\r\n                TextPaint newest = tv_newest.getPaint();\r\n                newest.setFakeBoldText(false);\r\n                TextPaint hot = tv_hot.getPaint();\r\n                hot.setFakeBoldText(false);\r\n                TextPaint essence = tv_essence.getPaint();\r\n                essence.setFakeBoldText(true);\r\n            }\r\n        });\r\n\r\n        ArrayList<Integer> images = new ArrayList<>();\r\n        ArrayList<String> title = new ArrayList<>();\r\n        title.add(\"新手推荐文章1\");\r\n        title.add(\"新手推荐文章2\");\r\n        title.add(\"新手推荐文章3\");\r\n        title.add(\"新手推荐文章4\");\r\n        title.add(\"新手推荐文章5\");\r\n        images.add(R.drawable.recommend1);\r\n        images.add(R.drawable.recommend2);\r\n        images.add(R.drawable.recommend3);\r\n        images.add(R.drawable.recommend4);\r\n        images.add(R.drawable.recommend5);\r\n\r\n        banner = view.findViewById(R.id.banner);\r\n        banner.setBannerStyle(BannerConfig.CIRCLE_INDICATOR_TITLE_INSIDE);\r\n        banner.setBannerTitles(title);\r\n        banner.setImageLoader(new GlideImageLoader());\r\n        banner.setImages(images);\r\n        banner.start();\r\n\r\n        banner.setOnBannerListener(new OnBannerListener() {\r\n            @Override\r\n            public void OnBannerClick(int position) {\r\n                Intent intent;\r\n                switch (position){\r\n                    case 0:\r\n                        intent = new Intent(getContext(),TipsActivity.class);\r\n                        startActivity(intent);\r\n                        break;\r\n                    case 1:\r\n                        intent = new Intent(getContext(),TipsActivity.class);\r\n                        startActivity(intent);\r\n                        break;\r\n                    case 2:\r\n                        intent = new Intent(getContext(),TipsActivity.class);\r\n                        startActivity(intent);\r\n                        break;\r\n                }\r\n                Log.e(\"点击了第几张轮播图:\",position+\"\");\r\n            }\r\n        });\r\n\r\n        lv_tips = view.findViewById(R.id.lv_tips);\r\n        return view;\r\n    }\r\n\r\n    public void init(ArrayList arrayList){\r\n        Log.e(\"init方法\", \"----------------------------\");\r\n        getImages(arrayList);\r\n        getHeadImages(arrayList);\r\n    }\r\n\r\n    public void getImages(final ArrayList<Tips> arrayList) {\r\n        final CountDownLatch latch = new CountDownLatch(arrayList.size());\r\n\r\n        for (int i = 0; i < arrayList.size(); i ++ ) {\r\n            final Tips tips = arrayList.get(i);\r\n            new Thread(){\r\n                @Override\r\n                public void run() {\r\n                    try {\r\n                        String path = tips.getImagepath();\r\n                        URL url = new URL(Cache.MY_URL + \"GetImageByPath?path=\" + path);\r\n                        HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();\r\n                        InputStream in = urlConnection.getInputStream();\r\n                        Bitmap bitmap = BitmapFactory.decodeStream(in);\r\n                        tips.setThumbnail(bitmap);\r\n                        in.close();\r\n                        latch.countDown();\r\n                    } catch (MalformedURLException e) {\r\n                        e.printStackTrace();\r\n                    } catch (IOException e) {\r\n                        e.printStackTrace();\r\n                    }\r\n\r\n                }\r\n            }.start();\r\n        }\r\n        try {\r\n            latch.await();\r\n            initAdapter();\r\n        } catch (InterruptedException e) {\r\n            e.printStackTrace();\r\n        }\r\n\r\n    }\r\n\r\n    public void getHeadImages(final ArrayList<Tips> arrayList) {\r\n        final CountDownLatch latch = new CountDownLatch(arrayList.size());\r\n\r\n        for (int i = 0; i < arrayList.size(); i ++ ) {\r\n            final Tips tips = arrayList.get(i);\r\n            new Thread(){\r\n                @Override\r\n                public void run() {\r\n                    try {\r\n                        String path = tips.getHeadImagepath();\r\n                        URL url = new URL(Cache.MY_URL + \"GetImageByPath?path=\" + path);\r\n                        HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();\r\n                        InputStream in = urlConnection.getInputStream();\r\n                        Bitmap bitmap = BitmapFactory.decodeStream(in);\r\n                        tips.setUserHead(bitmap);\r\n                        in.close();\r\n                        latch.countDown();\r\n                    } catch (MalformedURLException e) {\r\n                        e.printStackTrace();\r\n                    } catch (IOException e) {\r\n                        e.printStackTrace();\r\n                    }\r\n\r\n                }\r\n            }.start();\r\n        }\r\n        try {\r\n            latch.await();\r\n            initAdapter();\r\n        } catch (InterruptedException e) {\r\n            e.printStackTrace();\r\n        }\r\n\r\n    }\r\n\r\n    public void initAdapter() {\r\n        Log.e(\"initAdapter方法\", \"-------------------------\");\r\n        MainForumTipsAdapter mainForumTipsAdapter = new MainForumTipsAdapter(getContext(),arrayList,R.layout.forum_tips_item);\r\n        lv_tips.setAdapter(mainForumTipsAdapter);\r\n    }\r\n\r\n    public void getAllTips(){\r\n        new Thread(){\r\n            @Override\r\n            public void run() {\r\n                try {\r\n                    URL url = new URL(Cache.MY_URL + \"GetAllPostServlet\");\r\n                    HttpURLConnection connection = (HttpURLConnection) url.openConnection();\r\n                    connection.setRequestMethod(\"GET\");\r\n                    InputStream input = connection.getInputStream();\r\n                    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(input));\r\n                    StringBuffer stringBuffer = new StringBuffer();\r\n                    String line;\r\n                    while ((line=bufferedReader.readLine())!=null){\r\n                        stringBuffer.append(line);\r\n                    }\r\n                    JSONArray jsonArray = new JSONArray(stringBuffer.toString());\r\n                    System.out.println(jsonArray);\r\n                    for (int i=0;i<jsonArray.length();i++){\r\n                        JSONObject jsonObject = jsonArray.getJSONObject(i);\r\n                        int post_id = jsonObject.getInt(\"post_id\");\r\n                        String post_title = jsonObject.getString(\"post_title\");\r\n                        String post_time = jsonObject.getString(\"post_time\");\r\n                        String post_text = jsonObject.getString(\"post_text\");\r\n                        String topic = jsonObject.getString(\"post_topic\");\r\n                        String user_name = jsonObject.getString(\"user_name\");\r\n                        int count_likes = jsonObject.getInt(\"likes\");\r\n                        int count_comments = jsonObject.getInt(\"comments\");\r\n                        int count_forwards = jsonObject.getInt(\"forwards\");\r\n                        String img_path = jsonObject.getString(\"picture_path\");\r\n                        String head_img_path = jsonObject.getString(\"user_picture_path\");\r\n                        Tips tips = new Tips();\r\n                        tips.setId(post_id);\r\n                        tips.setTitle(post_title);\r\n                        tips.setText(post_text);\r\n                        tips.setTime(post_time);\r\n                        tips.setUserName(user_name);\r\n                        tips.setTopic(topic);\r\n                        tips.setLikes(count_likes);\r\n                        tips.setComments(count_comments);\r\n                        tips.setForwards(count_forwards);\r\n                        tips.setImagepath(img_path);\r\n                        tips.setHeadImagepath(head_img_path);\r\n                        arrayList.add(tips);\r\n\r\n                        Log.e(\"post_id\", i + \"\");\r\n\r\n                    }\r\n                    Log.e(\"pppppppppppppppppppppp\", \"------------------\");\r\n                    Message message = handler.obtainMessage();\r\n                    message.what = 1;\r\n                    message.obj = arrayList;\r\n                    handler.sendMessage(message);\r\n                } catch (MalformedURLException e) {\r\n                    e.printStackTrace();\r\n                } catch (ProtocolException e) {\r\n                    e.printStackTrace();\r\n                } catch (IOException e) {\r\n                    e.printStackTrace();\r\n                } catch (JSONException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            }\r\n        }.start();\r\n    }\r\n\r\n    public void search(){\r\n        new Thread(){\r\n            @Override\r\n            public void run() {\r\n                String search = et_search.getText().toString();\r\n            }\r\n        };\r\n    }\r\n\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
---- app/src/main/java/com/example/pet/forum/ForumFragment.java	(revision 29610c26ecd19152f25749af58dc7f11ca559eb9)
-+++ app/src/main/java/com/example/pet/forum/ForumFragment.java	(date 1607073157706)
-@@ -82,7 +82,7 @@
-     private ListView lv_tips;
-     private Banner banner;
-     private ArrayList<Tips> arrayList = new ArrayList<>();
--    private ArrayList<Tips> tipsArrayList;
-+    private int fenlei;
- 
-     private Handler handler = new Handler(){
-         @Override
-@@ -256,6 +256,7 @@
-                 hot.setFakeBoldText(false);
-                 TextPaint essence = tv_essence.getPaint();
-                 essence.setFakeBoldText(false);
-+                fenlei = 1;
-             }
-         });
-         tv_hot.setOnClickListener(new View.OnClickListener() {
-@@ -270,6 +271,7 @@
-                 hot.setFakeBoldText(true);
-                 TextPaint essence = tv_essence.getPaint();
-                 essence.setFakeBoldText(false);
-+                fenlei = 2;
-             }
-         });
-         tv_essence.setOnClickListener(new View.OnClickListener() {
-@@ -284,6 +286,7 @@
-                 hot.setFakeBoldText(false);
-                 TextPaint essence = tv_essence.getPaint();
-                 essence.setFakeBoldText(true);
-+                fenlei = 3;
-             }
-         });
- 
-@@ -420,7 +423,7 @@
-             @Override
-             public void run() {
-                 try {
--                    URL url = new URL(Cache.MY_URL + "GetAllPostServlet");
-+                    URL url = new URL(Cache.MY_URL + "GetAllPostServlet?fenlei="+fenlei);
-                     HttpURLConnection connection = (HttpURLConnection) url.openConnection();
-                     connection.setRequestMethod("GET");
-                     InputStream input = connection.getInputStream();
-Index: app/src/main/java/com/example/pet/forum/MainForumTipsAdapter.java
-IDEA additional info:
-Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
-<+>package com.example.pet.forum;\r\n\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.os.Build;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.BaseAdapter;\r\nimport android.widget.Button;\r\nimport android.widget.ImageView;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.example.pet.R;\r\nimport com.example.pet.other.entity.Tips;\r\n\r\nimport java.util.ArrayList;\r\n\r\npublic class MainForumTipsAdapter extends BaseAdapter {\r\n\r\n    private Context context;\r\n    private ArrayList<Tips> tipsArrayList = new ArrayList<>();\r\n    private int tipslayout;\r\n\r\n    public MainForumTipsAdapter(Context context, ArrayList<Tips> tipsArrayList, int tipslayout) {\r\n        this.context = context;\r\n        this.tipsArrayList = tipsArrayList;\r\n        this.tipslayout = tipslayout;\r\n    }\r\n\r\n    public Context getContext(){\r\n        return context;\r\n    }\r\n\r\n    @Override\r\n    public int getCount() {\r\n        if (tipsArrayList == null){\r\n            return 0;\r\n        }\r\n        return tipsArrayList.size();\r\n    }\r\n\r\n    @Override\r\n    public Object getItem(int position) {\r\n        if (tipsArrayList == null){\r\n            return null;\r\n        }\r\n        return tipsArrayList.get(position);\r\n    }\r\n\r\n    @Override\r\n    public long getItemId(int position) {\r\n        return position;\r\n    }\r\n\r\n    @Override\r\n    public View getView(final int position, View convertView, ViewGroup parent) {\r\n        if (convertView == null){\r\n            convertView = LayoutInflater.from(context).inflate(tipslayout,null);\r\n        }\r\n        ImageView landlordhead = convertView.findViewById(R.id.iv_tips_landlordhead);\r\n        landlordhead.setImageBitmap(tipsArrayList.get(position).getUserHead());\r\n        landlordhead.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),LandlordActivity.class);\r\n                getContext().startActivity(intent);\r\n\r\n            }\r\n        });\r\n        TextView landlordname = convertView.findViewById(R.id.tv_tips_landlordname);\r\n        landlordname.setText(tipsArrayList.get(position).getUserName());\r\n        TextView tipstime = convertView.findViewById(R.id.tv_tips_tipstime);\r\n        tipstime.setText(tipsArrayList.get(position).getTime());\r\n        Button tipstopic = convertView.findViewById(R.id.btn_tips_topic);\r\n        tipstopic.setText(tipsArrayList.get(position).getTopic());\r\n        TextView tipstitle = convertView.findViewById(R.id.tv_tips_tipstitle);\r\n        tipstitle.setText(tipsArrayList.get(position).getTitle());\r\n        ImageView tipsthumbnail = convertView.findViewById(R.id.iv_tips_thumbnail);\r\n        tipsthumbnail.setImageBitmap(tipsArrayList.get(position).getThumbnail());\r\n        TextView tipstext = convertView.findViewById(R.id.tv_tips_text);\r\n        String str = tipsArrayList.get(position).getText();\r\n        int i = 40;\r\n        str = str.substring(0,i) + \"...\";\r\n        tipstext.setText(str);\r\n        TextView tipslikes = convertView.findViewById(R.id.tv_tips_like);\r\n        tipslikes.setText(\"\"+tipsArrayList.get(position).getLikes());\r\n        TextView tipscomments = convertView.findViewById(R.id.tv_tips_comment);\r\n        tipscomments.setText(\"\"+tipsArrayList.get(position).getComments());\r\n        TextView tipsforwards = convertView.findViewById(R.id.tv_tips_forward);\r\n        tipsforwards.setText(\"\"+tipsArrayList.get(position).getForwards());\r\n        LinearLayout totips = convertView.findViewById(R.id.btn_tips_totips);\r\n        totips.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),TipsActivity.class);\r\n                int i = tipsArrayList.get(position).getId();\r\n                String id = Integer.toString(i);\r\n                Log.e(\"St id\", id);\r\n                intent.putExtra(\"tipsid\",id);\r\n                context.startActivity(intent);\r\n            }\r\n        });\r\n        LinearLayout tipslike = convertView.findViewById(R.id.tips_like);\r\n        final ImageView iv_like = convertView.findViewById(R.id.iv_tips_like);\r\n        tipslike.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {\r\n                    if (iv_like.getDrawable().getConstantState().equals(getContext().getDrawable(R.drawable.like1).getConstantState())){\r\n                        iv_like.setImageResource(R.drawable.like2);\r\n                    }else{\r\n                        Toast toast = Toast.makeText(context,\"您已经点赞过了\"\r\n                                , Toast.LENGTH_SHORT);\r\n                        toast.show();\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        LinearLayout tipscomment = convertView.findViewById(R.id.tips_comment);\r\n        tipscomment.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent();\r\n                intent.setClass(getContext(),TipsActivity.class);\r\n                intent.putExtra(\"tipsid\",tipsArrayList.get(position).getId());\r\n                context.startActivity(intent);\r\n            }\r\n        });\r\n        LinearLayout tipsforward = convertView.findViewById(R.id.tips_forward);\r\n        final ImageView iv_forward = convertView.findViewById(R.id.iv_tips_forward);\r\n        tipsforward.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {\r\n                    if (iv_forward.getDrawable().getConstantState().equals(getContext().getDrawable(R.drawable.forward1).getConstantState())){\r\n                        iv_forward.setImageResource(R.drawable.forward2);\r\n                    }else{\r\n                        Toast toast = Toast.makeText(context,\"您已经转发过了\"\r\n                                , Toast.LENGTH_SHORT);\r\n                        toast.show();\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return convertView;\r\n    }\r\n}\r\n
-Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
-<+>UTF-8
-===================================================================
---- app/src/main/java/com/example/pet/forum/MainForumTipsAdapter.java	(revision 29610c26ecd19152f25749af58dc7f11ca559eb9)
-+++ app/src/main/java/com/example/pet/forum/MainForumTipsAdapter.java	(date 1607061008433)
-@@ -18,6 +18,7 @@
- import com.example.pet.other.entity.Tips;
- 
- import java.util.ArrayList;
-+import java.util.concurrent.TimeUnit;
- 
- public class MainForumTipsAdapter extends BaseAdapter {
- 
Index: app/src/main/AndroidManifest.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    package=\"com.example.pet\">\r\n\r\n    <permission\r\n        android:name=\"${applicationId}.permission.JPUSH_MESSAGE\"\r\n        android:protectionLevel=\"signature\" />\r\n\r\n    <uses-permission android:name=\"com.android.launcher.permission.READ_SETTINGS\" />\r\n    <uses-permission android:name=\"${applicationId}.permission.JPUSH_MESSAGE\" />\r\n    <uses-permission android:name=\"android.permission.RECEIVE_USER_PRESENT\" />\r\n    <uses-permission android:name=\"android.permission.READ_EXTERNAL_STORAGE\" />\r\n    <uses-permission android:name=\"android.permission.INTERNET\" />\r\n    <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\" />\r\n    <uses-permission\r\n        android:name=\"android.permission.MOUNT_UNMOUNT_FILESYSTEMS\"\r\n        tools:ignore=\"ProtectedPermissions\" />\r\n    <uses-permission android:name=\"android.permission.CAMERA\" />\r\n    <uses-permission android:name=\"com.android.launcher.permission.READ_SETTINGS\" />\r\n    <uses-permission android:name=\"android.permission.WAKE_LOCK\" />\r\n    <uses-permission android:name=\"android.permission.CHANGE_WIFI_STATE\" />\r\n    <uses-permission android:name=\"android.permission.ACCESS_WIFI_STATE\" />\r\n    <uses-permission android:name=\"android.permission.FOREGROUND_SERVICE\" />\r\n    <uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\" />\r\n    <uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\" />\r\n    <uses-permission android:name=\"android.permission.READ_PHONE_STATE\" />\r\n    <uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\" />\r\n\r\n    <application\r\n        android:name=\".other.DebugApp\"\r\n        android:allowBackup=\"true\"\r\n        android:icon=\"@drawable/lastlogo\"\r\n        android:label=\"@string/app_name\"\r\n        android:networkSecurityConfig=\"@xml/network_security_config\"\r\n        android:roundIcon=\"@drawable/lastlogo\"\r\n        android:supportsRtl=\"true\"\r\n        android:sharedUserId=\"android.uid.system\"\r\n        android:largeHeap=\"true\"\r\n        android:theme=\"@style/AppTheme\"\r\n        android:usesCleartextTraffic=\"true\">\r\n        <activity android:name=\".my.NewPet\">\r\n\r\n        </activity>\r\n\r\n        <activity android:name=\".my.AcountSecurity\" />\r\n        <activity android:name=\".my.ConnectUs\" />\r\n        <activity android:name=\".my.order.MyOrderActivity\" />\r\n        <activity android:name=\".my.OrderComplete\" />\r\n        <activity\r\n            android:name=\".my.editinfo.EditInfo\"\r\n            android:windowSoftInputMode=\"adjustPan|adjustUnspecified|stateHidden\" />\r\n        <activity android:name=\".my.FunIntroduction\" />\r\n        <activity android:name=\".my.AboutUsLaw\" />\r\n        <activity android:name=\".my.Agreement\" />\r\n        <activity android:name=\".my.Order2\" />\r\n        <activity android:name=\".my.Register\" />\r\n        <activity android:name=\".my.Update\" />\r\n        <activity android:name=\".my.Check\" />\r\n        <activity android:name=\".my.Login\" />\r\n        <activity android:name=\".my.PetActivity\" />\r\n        <activity android:name=\".my.History\" />\r\n        <activity android:name=\".my.AboutUs\" />\r\n        <activity android:name=\".my.Setting\" />\r\n        <activity android:name=\".my.Post\" />\r\n        <activity android:name=\".forum.LandlordActivity\" />\r\n        <activity android:name=\".forum.TipsActivity\" />\r\n        <activity android:name=\".forum.ClassifiedForumActivity\" />\r\n        <activity android:name=\".forum.TopicActivity\" />\r\n        <activity android:name=\".chat.ChatView\" />\r\n        <activity android:name=\".chat.Booking\" />\r\n        <activity android:name=\".forum.PublishActivity\" />\r\n        <activity android:name=\".nursing.CancelActivity\" />\r\n        <activity android:name=\".nursing.JiedanActivity\" />\r\n        <activity android:name=\".nursing.ChoiceActivity\" />\r\n        <activity android:name=\".nursing.XuzhiActivity\" />\r\n        <activity android:name=\".nursing.Choice2Activity\" />\r\n        <activity android:name=\".nursing.ChangehisActivity\" />\r\n        <activity android:name=\".nursing.EndActivity\" />\r\n        <activity android:name=\".nursing.StartActivity\" />\r\n        <activity android:name=\".nursing.NeworderActivity\" />\r\n        <activity android:name=\".nursing.CostActivity\" />\r\n        <activity android:name=\".forum.SearchResult\"/>\r\n        <activity android:name=\".forum.New_post_detail\"/>\r\n        <activity android:name=\".MainActivity\">\r\n\r\n        </activity>\r\n<activity android:name=\".my.AcountManage\"/>\r\n        <meta-data\r\n            android:name=\"com.baidu.lbsapi.API_KEY\"\r\n            android:value=\"Gy6t4iVa5bjCYSlblHYFLNKNCFmABmH3\" />\r\n\r\n        <service\r\n            android:name=\"com.baidu.location.f\"\r\n            android:enabled=\"true\"\r\n            android:process=\":remote\">\r\n            <intent-filter>\r\n                <action android:name=\"com.baidu.location.service_v5.0.0\" />\r\n            </intent-filter>\r\n        </service> <!-- <provider -->\r\n        <!-- android:name=\"androidx.core.content.FileProvider\" -->\r\n        <!-- android:authorities=\"${applicationId}.provider\" -->\r\n        <!-- android:exported=\"false\" -->\r\n        <!-- android:grantUriPermissions=\"true\"> -->\r\n        <!-- <meta-data -->\r\n        <!-- android:name=\"android.support.FILE_PROVIDER_PATHS\" -->\r\n        <!-- android:resource=\"\" /> -->\r\n        <!-- </provider> -->\r\n        <activity\r\n            android:name=\".Start1Activity\"\r\n            android:windowSoftInputMode=\"adjustPan\">\r\n            <intent-filter>\r\n            <action android:name=\"android.intent.action.MAIN\" />\r\n\r\n            <category android:name=\"android.intent.category.LAUNCHER\" />\r\n        </intent-filter>\r\n        </activity>\r\n        <activity\r\n            android:name=\"cn.jpush.android.ui.PushActivity\"\r\n            android:configChanges=\"orientation|keyboardHidden\"\r\n            android:exported=\"false\"\r\n            android:theme=\"@android:style/Theme.NoTitleBar\">\r\n            <intent-filter>\r\n                <action android:name=\"cn.jpush.android.ui.PushActivity\" />\r\n\r\n                <category android:name=\"android.intent.category.DEFAULT\" />\r\n                <category android:name=\"${applicationId}\" />\r\n            </intent-filter>\r\n        </activity> <!-- Required SDK 核心功能 -->\r\n        <!-- 可配置android:process参数将PushService放在其他进程中 -->\r\n        <service\r\n            android:name=\"cn.jpush.android.service.PushService\"\r\n            android:process=\":pushcore\">\r\n            <intent-filter>\r\n                <action android:name=\"cn.jpush.android.intent.REGISTER\" />\r\n                <action android:name=\"cn.jpush.android.intent.REPORT\" />\r\n                <action android:name=\"cn.jpush.android.intent.PushService\" />\r\n                <action android:name=\"cn.jpush.android.intent.PUSH_TIME\" />\r\n            </intent-filter>\r\n        </service> <!-- since 3.0.9 Required SDK 核心功能 -->\r\n        <provider\r\n            android:name=\"cn.jpush.android.service.DataProvider\"\r\n            android:authorities=\"${applicationId}.DataProvider\"\r\n            android:exported=\"false\"\r\n            android:process=\":pushcore\" /> <!-- Required SDK核心功能 -->\r\n        <service android:name=\".my.MyUserService\" />\r\n\r\n        <receiver\r\n            android:name=\"cn.jpush.android.service.PushReceiver\"\r\n            android:enabled=\"true\">\r\n            <intent-filter android:priority=\"1000\">\r\n                <action android:name=\"cn.jpush.android.intent.NOTIFICATION_RECEIVED_PROXY\" /> <!-- Required  显示通知栏 -->\r\n                <category android:name=\"${applicationId}\" />\r\n            </intent-filter>\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.USER_PRESENT\" />\r\n                <action android:name=\"android.net.conn.CONNECTIVITY_CHANGE\" />\r\n            </intent-filter>\r\n            <!-- Optional -->\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.PACKAGE_ADDED\" />\r\n                <action android:name=\"android.intent.action.PACKAGE_REMOVED\" />\r\n\r\n                <data android:scheme=\"package\" />\r\n            </intent-filter>\r\n        </receiver> <!-- Required SDK核心功能 -->\r\n        <receiver\r\n            android:name=\"cn.jpush.android.service.AlarmReceiver\"\r\n            android:exported=\"false\" /> <!-- User defined.  For test only  用户自定义接收消息器,3.0.7开始支持,目前新tag/alias接口设置结果会在该广播接收器对应的方法中回调 -->\r\n        <!-- since 3.3.0 接收JPush相关事件 -->\r\n        <receiver\r\n            android:name=\".other.JpushReceiver\"\r\n            android:enabled=\"true\"\r\n            android:exported=\"false\">\r\n            <intent-filter>\r\n\r\n                <!--\r\n                <action android:name=\"cn.jpush.android.intent.REGISTRATION\" />\r\n                <action android:name=\"cn.jpush.android.intent.MESSAGE RECEIVED\"/>\r\n                <action android:name=\"cn.jpush.android.intent.NOTIFICATION_RECEIVED\"/>\r\n                <action android:name=\"cn.jpush.android.intent.NOTIFICATION_OPENED\" />\r\n                <action android:name=\"cn.jpush.android.intent.CONNECTION\"/>\r\n                -->\r\n\r\n                <action android:name=\"cn.jpush.android.intent.RECEIVE_MESSAGE\" />\r\n\r\n                <category android:name=\"${applicationId}\" />\r\n            </intent-filter>\r\n        </receiver> <!-- since 3.3.0 Required SDK核心功能 -->\r\n        <activity\r\n            android:name=\"cn.jpush.android.service.JNotifyActivity\"\r\n            android:exported=\"false\"\r\n            android:taskAffinity=\"jpush.custom\"\r\n            android:theme=\"@android:style/Theme.Translucent.NoTitleBar\">\r\n            <intent-filter>\r\n                <action android:name=\"cn.jpush.android.intent.JNotifyActivity\" />\r\n\r\n                <category android:name=\"${applicationId}\" />\r\n            </intent-filter>\r\n        </activity> <!-- since 3.3.0 Required SDK 核心功能 -->\r\n        <!-- 可配置android:process参数将PushService放在其他进程中 -->\r\n        <!-- User defined.  For test only 继承自cn.jpush.android.service.JCommonService -->\r\n        <service\r\n            android:name=\".other.JpushService\"\r\n            android:process=\":pushcore\">\r\n            <intent-filter>\r\n                <action android:name=\"cn.jiguang.user.service.action\" />\r\n            </intent-filter>\r\n        </service>\r\n        <service android:name=\".my.MyDataService\" />\r\n\r\n        <meta-data\r\n            android:name=\"JPUSH_CHANNEL\"\r\n            android:value=\"jpush_channel\" />\r\n        <meta-data\r\n            android:name=\"JPUSH_APPKEY\"\r\n            android:value=\"7153b7916be94ab289793e76\" />\r\n    </application>\r\n\r\n</manifest>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/AndroidManifest.xml	(revision f4aaf511276e0f60eb82edaef0144fc6ff002c53)
+++ app/src/main/AndroidManifest.xml	(date 1607759670038)
@@ -26,6 +26,12 @@
     <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
     <uses-permission android:name="android.permission.READ_PHONE_STATE" />
     <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
+    <uses-permission android:name="android.permission.GET_ACCOUNTS" />
+    <uses-permission android:name="android.permission.USE_CREDENTIALS" />
+    <uses-permission android:name="android.permission.MANAGE_ACCOUNTS" />
+    <uses-permission android:name="android.permission.AUTHENTICATE_ACCOUNTS" />
+    <uses-permission android:name="com.android.launcher.permission.READ_SETTINGS" />
+    <uses-permission android:name="android.permission.BROADCAST_STICKY" />
 
     <application
         android:name=".other.DebugApp"
Index: app/src/main/java/com/example/pet/my/Register.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.my;\r\n\r\nimport androidx.appcompat.app.AlertDialog;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.appcompat.widget.Toolbar;\r\n\r\nimport android.annotation.SuppressLint;\r\nimport android.content.DialogInterface;\r\nimport android.content.Intent;\r\nimport android.opengl.ETC1;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\nimport android.os.Message;\r\nimport android.text.TextUtils;\r\nimport android.util.Log;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.CheckBox;\r\nimport android.widget.EditText;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.example.pet.R;\r\nimport com.example.pet.other.Cache;\r\nimport com.example.pet.other.entity.User;\r\nimport com.google.gson.Gson;\r\nimport com.google.gson.GsonBuilder;\r\n\r\nimport java.io.IOException;\r\nimport java.util.Timer;\r\nimport java.util.TimerTask;\r\n\r\nimport cn.smssdk.EventHandler;\r\nimport cn.smssdk.SMSSDK;\r\nimport okhttp3.Call;\r\nimport okhttp3.Callback;\r\nimport okhttp3.MediaType;\r\nimport okhttp3.OkHttpClient;\r\nimport okhttp3.Request;\r\nimport okhttp3.RequestBody;\r\nimport okhttp3.Response;\r\n\r\n\r\npublic class Register extends AppCompatActivity {\r\n\r\n    private Toolbar toolbar;\r\n    private TextView registerAgreement;\r\n    private TextView tvLogin;\r\n    private EditText etPhone;\r\n    private CheckBox cbXieYi;\r\n    private EditText etYan;\r\n    private EditText etPass;\r\n    private EditText etPass1;\r\n    private Button btnGetYan;\r\n    private String phone;\r\n    private int time = 60;\r\n    private static final int CODE_TRUE = 2; //注册成功\r\n    private static final int CODE_FALSE = 3; //已存在\r\n    private static final int CODE_FALSE1 = 4; //未知原因错误\r\n\r\n    private Handler hd = new Handler() {\r\n        @Override\r\n        public void handleMessage(Message msg) {\r\n            if(msg.what == CODE_TRUE){\r\n                Intent intent = new Intent();\r\n                intent.setClass(Register.this,Login.class);\r\n                startActivity(intent);\r\n                Register.this.finish();\r\n            }else if(msg.what == CODE_FALSE){\r\n                Log.e(\"register\",\"6\");\r\n                Log.e(\"6\",msg.obj.toString());\r\n                toast(msg.obj.toString());\r\n            }else if(msg.what == CODE_FALSE1){\r\n                toast(\"后台服务繁忙，请1分钟后再次申请注册！\");\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    @Override\r\n    protected void onStart() {\r\n        super.onStart();\r\n        //启动短信验证SDK\r\n        EventHandler eventHandler = new EventHandler(){\r\n            @Override\r\n            public void afterEvent(int event, int result, Object data) {\r\n                Message msg = new Message();\r\n                msg.arg1 = event;\r\n                msg.arg2 = result;\r\n                msg.obj = data;\r\n                handler.sendMessage(msg);\r\n            }\r\n        };\r\n        //注册回调监听接口\r\n        SMSSDK.registerEventHandler(eventHandler);\r\n    }\r\n    @SuppressLint(\"HandlerLeak\")\r\n    private Handler handler = new Handler(){\r\n        public void handleMessage(Message msg) {\r\n            if (msg.what == -9) {\r\n                btnGetYan.setText(\"重新发送(\" + time + \")\");\r\n            } else if (msg.what == -8) {\r\n                btnGetYan.setText(\"获取验证码\");\r\n                btnGetYan.setClickable(true);\r\n                time = 60;\r\n            } else {\r\n                int event = msg.arg1;\r\n                int result = msg.arg2;\r\n                Object data = msg.obj;\r\n                Log.e(\"event\", \"event=\" + event);\r\n                if (result == SMSSDK.RESULT_COMPLETE) {\r\n                    if (event == SMSSDK.EVENT_SUBMIT_VERIFICATION_CODE) {\r\n                        toast(\"验证成功，密码是：\"+etPass.getText().toString());\r\n                        String pass = etPass.getText().toString();\r\n                        String pass1 = etPass1.getText().toString();\r\n                        if(pass.equals(pass1)){\r\n                            insert();\r\n                        }else {\r\n                            toast(\"请重新验证密码！\");\r\n                        }\r\n                    }else if (event == SMSSDK.EVENT_GET_VERIFICATION_CODE){        //获取验证码成功\r\n                        toast(\"验证码已发送\");\r\n                    }else if (event ==SMSSDK.EVENT_GET_SUPPORTED_COUNTRIES){//如果你调用了获取国家区号类表会在这里回调\r\n                        //返回支持发送验证码的国家列表\r\n                    }\r\n                }else{//错误等在这里（包括验证失败）\r\n                    //错误码请参照http://wiki.mob.com/android-api-错误码参考/这里我就不再继续写了\r\n                    ((Throwable)data).printStackTrace();\r\n                    String str = data.toString();\r\n                    toast(str);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    private void toast(final String str) {\r\n        runOnUiThread(new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                Toast.makeText(Register.this, str, Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n    }\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_register);\r\n        setView();\r\n    }\r\n\r\n    private void setView() {\r\n        etPhone = findViewById(R.id.et_phone);\r\n        cbXieYi = findViewById(R.id.cb_xieyi);\r\n        toolbar = findViewById(R.id.register_toolbar);\r\n        etYan = findViewById(R.id.et_yan);\r\n        etPass = findViewById(R.id.et_password);\r\n        etPass1 = findViewById(R.id.et_password1);\r\n        btnGetYan = findViewById(R.id.btn_getYan);\r\n        toolbar.setNavigationOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Register.this.finish();\r\n            }\r\n        });\r\n    }\r\n\r\n    public void onClicked(View view) {\r\n        switch (view.getId()){\r\n            case R.id.register_agreement:\r\n                Intent intent = new Intent(this,Agreement.class);\r\n                startActivity(intent);\r\n                break;\r\n            case R.id.tv_login:\r\n                Register.this.finish();\r\n                break;\r\n            case R.id.btn_getYan:\r\n                //获取验证码\r\n                phone = etPhone.getText().toString();\r\n                //验证手机号\r\n                yanPhone();\r\n                break;\r\n            case R.id.btn_register:\r\n                //提交注册信息\r\n                String code = etYan.getText().toString().replaceAll(\"/s\",\"\");\r\n                if (!TextUtils.isEmpty(code)) {//判断验证码是否为空\r\n                    //验证\r\n                    Log.e(\"code\",code);\r\n                    SMSSDK.submitVerificationCode( \"86\",  phone,  code);\r\n                }else{//如果用户输入的内容为空，提醒用户\r\n                    toast(\"请输入验证码后再提交\");\r\n                }\r\n                break;\r\n        }\r\n    }\r\n    /**\r\n     * 上传服务端\r\n     */\r\n    private void insert() {\r\n        //发送数据\r\n        Log.e(\"register\",\"1\");\r\n        OkHttpClient okHttpClient = new OkHttpClient();\r\n        Gson gson = new GsonBuilder()\r\n                .serializeNulls()//序列化空值\r\n                .create();\r\n        User user = new User();\r\n        user.setUserPassword(etPass.getText().toString());\r\n        user.setUserPhone(phone);\r\n        String str = gson.toJson(user);\r\n        Log.e(\"register\",\"2   \" + str);\r\n        RequestBody requestBody = RequestBody.create(MediaType.parse(\r\n                \"text/plain;charset=UTF-8\"),str);\r\n        Request request = new Request.Builder()\r\n                .post(requestBody)\r\n                .url(Cache.MY_URL + \"RegisterServlet\")\r\n                .build();\r\n        Log.e(\"register\",request.toString());\r\n        Call call = okHttpClient.newCall(request);\r\n\r\n        call.enqueue(new Callback() {\r\n            @Override\r\n            public void onFailure(Call call, IOException e) {\r\n                //请求失败\r\n                toast(\"注册失败，原因不明！\");\r\n                e.printStackTrace();\r\n            }\r\n\r\n            @Override\r\n            public void onResponse(Call call, Response response) throws IOException {\r\n                //请求成功\r\n                Log.e(\"register\",\"4\");\r\n                //使用HandlerMessage修改用户界面\r\n                Message msg = new Message();\r\n                String str = response.body().string();\r\n                if(str.equals(\"true\")){\r\n                    msg.what = CODE_TRUE;\r\n                }else if(str.equals(\"false\")){\r\n                    msg.what = CODE_FALSE1;\r\n                }else{\r\n                    msg.what = CODE_FALSE;\r\n                }\r\n                msg.obj = str;\r\n                hd.sendMessage(msg);\r\n                Log.e(\"register\",\"5\");\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    private void yanPhone() {\r\n        // 1. 判断手机号是不是11位并且看格式是否合理\r\n        if (!judgePhoneNums(phone)) {\r\n            return;\r\n        }\r\n        // 2. 通过sdk发送短信验证\r\n        AlertDialog.Builder builder = new AlertDialog.Builder(this);  //先得到构造器\r\n        builder.setTitle(\"提示\"); //设置标题\r\n        builder.setMessage(\"我们将要发送到\" + phone + \"验证\"); //设置内容\r\n        builder.setIcon(R.mipmap.ic_launcher);//设置图标，图片id即可\r\n        builder.setPositiveButton(\"确定\", new DialogInterface.OnClickListener() {\r\n            //设置确定按钮\r\n            @Override\r\n            public void onClick(DialogInterface dialog, int which) {\r\n                dialog.dismiss(); //关闭dialog\r\n                // 2. 通过sdk发送短信验证\r\n                SMSSDK.getVerificationCode(\"86\", phone);\r\n\r\n                // 3. 把按钮变成不可点击，并且显示倒计时（正在获取）\r\n                btnGetYan.setClickable(false);\r\n                btnGetYan.setText(\"重新发送(\" + time + \")\");\r\n                new Thread(new Runnable() {\r\n                    @Override\r\n                    public void run() {\r\n                        for (; time > 0; time--) {\r\n                            handler.sendEmptyMessage(-9);\r\n                            if (time <= 0) {\r\n                                break;\r\n                            }\r\n                            try {\r\n                                Thread.sleep(1000);\r\n                            } catch (InterruptedException e) {\r\n                                e.printStackTrace();\r\n                            }\r\n                        }\r\n                        handler.sendEmptyMessage(-8);\r\n                    }\r\n                }).start();\r\n\r\n            }\r\n        });\r\n        builder.setNegativeButton(\"取消\", new DialogInterface.OnClickListener() { //设置取消按钮\r\n            @Override\r\n            public void onClick(DialogInterface dialog, int which) {\r\n                dialog.dismiss();\r\n                Toast.makeText(Register.this, \"已取消\" + which, Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n        //参数都设置完成了，创建并显示出来\r\n        builder.create().show();\r\n\r\n    }\r\n    /**\r\n     * 判断手机号码是否合理\r\n     *\r\n     * @param phoneNums\r\n     */\r\n    private boolean judgePhoneNums(String phoneNums) {\r\n        if (isMatchLength(phoneNums, 11)\r\n                && isMobileNO(phoneNums)) {\r\n            return true;\r\n        }\r\n        Toast.makeText(this, \"手机号码输入有误！\",Toast.LENGTH_SHORT).show();\r\n        return false;\r\n\r\n    }\r\n    /**\r\n     * 验证手机格式\r\n     */\r\n    private boolean isMobileNO(String mobileNums) {\r\n        /*\r\n         * 移动：134、135、136、137、138、139、150、151、157(TD)、158、159、187、188\r\n         * 联通：130、131、132、152、155、156、185、186 电信：133、153、180、189、（1349卫通）\r\n         * 总结起来就是第一位必定为1，第二位必定为3或5或8，其他位置的可以为0-9\r\n         */\r\n        String telRegex = \"[1][358]\\\\d{9}\";// \"[1]\"代表第1位为数字1，\"[358]\"代表第二位可以为3、5、8中的一个，\"\\\\d{9}\"代表后面是可以是0～9的数字，有9位。\r\n        if (TextUtils.isEmpty(mobileNums))\r\n            return false;\r\n        else\r\n            return mobileNums.matches(telRegex);\r\n\r\n    }\r\n    /**\r\n     * 判断一个字符串的位数\r\n     * @param str\r\n     * @param length\r\n     * @return\r\n     */\r\n    private boolean isMatchLength(String str, int length) {\r\n        if (str.isEmpty()) {\r\n            return false;\r\n        } else {\r\n            return str.length() == length ? true : false;\r\n        }\r\n\r\n    }\r\n    @Override\r\n    protected void onDestroy() {\r\n        //反注册回调监听接口\r\n        SMSSDK.unregisterAllEventHandler();\r\n        //存储手机号\r\n//        inputText = inputPhoneEt.getText().toString();\r\n//        save(inputText);\r\n//        System.out.println(\"活动毁灭之前是否传值\"+inputText);\r\n        super.onDestroy();\r\n    }\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/my/Register.java	(revision f4aaf511276e0f60eb82edaef0144fc6ff002c53)
+++ app/src/main/java/com/example/pet/my/Register.java	(date 1607841251757)
@@ -77,6 +77,14 @@
         }
     };
 
+
+
+
+
+
+
+
+
     @Override
     protected void onStart() {
         super.onStart();
Index: app/src/main/java/com/example/pet/other/entity/User.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.other.entity;\r\n\r\nimport android.graphics.Bitmap;\r\n\r\nimport java.util.Objects;\r\n\r\npublic class User {\r\n    private int userId;//用户ID\r\n    private String userName;//用户姓名\r\n    private String userSex;//用户性别\r\n    private String accountNumber;//账号\r\n    private double accountAmount;//账户金额\r\n    private String picturePath;//图片路径\r\n    private String userPassword;//用户密码\r\n    private String userPhone;//用户手机号\r\n    private String userBrithday;//用户邮箱\r\n    private String userAutograph;//个性签名\r\nprivate Bitmap photo;\r\n    public User() {\r\n    }\r\n\r\n    public Bitmap getPhoto() {\r\n        return photo;\r\n    }\r\n\r\n    public void setPhoto(Bitmap photo) {\r\n        this.photo = photo;\r\n    }\r\n\r\n    public User(int userId, String userName, String userSex, String accountNumber, double accountAmount, String picturePath, String userPassword, String userPhone, String userBrithday, String userAutograph) {\r\n        this.userId = userId;\r\n        this.userName = userName;\r\n        this.userSex = userSex;\r\n        this.accountNumber = accountNumber;\r\n        this.accountAmount = accountAmount;\r\n        this.picturePath = picturePath;\r\n        this.userPassword = userPassword;\r\n        this.userPhone = userPhone;\r\n        this.userBrithday = userBrithday;\r\n        this.userAutograph = userAutograph;\r\n    }\r\n\r\n    @Override\r\n    public String toString() {\r\n        return \"User{\" +\r\n                \"userId=\" + userId +\r\n                \", userName='\" + userName + '\\'' +\r\n                \", userSex='\" + userSex + '\\'' +\r\n                \", accountNumber='\" + accountNumber + '\\'' +\r\n                \", accountAmount=\" + accountAmount +\r\n                \", picturePath='\" + picturePath + '\\'' +\r\n                \", userPassword='\" + userPassword + '\\'' +\r\n                \", userPhone='\" + userPhone + '\\'' +\r\n                \", userBrithday='\" + userBrithday + '\\'' +\r\n                \", userAutograph='\" + userAutograph + '\\'' +\r\n                '}';\r\n    }\r\n\r\n    public String getUserSex() {\r\n        return userSex;\r\n    }\r\n\r\n    public void setUserSex(String userSex) {\r\n        this.userSex = userSex;\r\n    }\r\n\r\n    public double getAccountAmount() {\r\n        return accountAmount;\r\n    }\r\n\r\n    public void setAccountAmount(double accountAmount) {\r\n        this.accountAmount = accountAmount;\r\n    }\r\n\r\n    public int getUserId() {\r\n        return userId;\r\n    }\r\n\r\n    public void setUserId(int userId) {\r\n        this.userId = userId;\r\n    }\r\n\r\n    public String getUserName() {\r\n        return userName;\r\n    }\r\n\r\n    public void setUserName(String userName) {\r\n        this.userName = userName;\r\n    }\r\n\r\n    public String getAccountNumber() {\r\n        return accountNumber;\r\n    }\r\n\r\n    public void setAccountNumber(String accountNumber) {\r\n        this.accountNumber = accountNumber;\r\n    }\r\n\r\n    public String getPicturePath() {\r\n        return picturePath;\r\n    }\r\n\r\n    public void setPicturePath(String picturePath) {\r\n        this.picturePath = picturePath;\r\n    }\r\n\r\n    public String getUserPassword() {\r\n        return userPassword;\r\n    }\r\n\r\n    public void setUserPassword(String userPassword) {\r\n        this.userPassword = userPassword;\r\n    }\r\n\r\n    public String getUserPhone() {\r\n        return userPhone;\r\n    }\r\n\r\n    public void setUserPhone(String userPhone) {\r\n        this.userPhone = userPhone;\r\n    }\r\n\r\n    public String getUserBrithday() {\r\n        return userBrithday;\r\n    }\r\n\r\n    public void setUserBrithday(String userBrithday) {\r\n        this.userBrithday = userBrithday;\r\n    }\r\n\r\n    public String getUserAutograph() {\r\n        return userAutograph;\r\n    }\r\n\r\n    public void setUserAutograph(String userAutograph) {\r\n        this.userAutograph = userAutograph;\r\n    }\r\n\r\n    @Override\r\n    public boolean equals(Object o) {\r\n        if (this == o) return true;\r\n        if (o == null || getClass() != o.getClass()) return false;\r\n        User user = (User) o;\r\n        return userId == user.userId &&\r\n                Double.compare(user.accountAmount, accountAmount) == 0 &&\r\n                Objects.equals(userName, user.userName) &&\r\n                Objects.equals(userSex, user.userSex) &&\r\n                Objects.equals(accountNumber, user.accountNumber) &&\r\n                Objects.equals(picturePath, user.picturePath) &&\r\n                Objects.equals(userPassword, user.userPassword) &&\r\n                Objects.equals(userPhone, user.userPhone) &&\r\n                Objects.equals(userBrithday, user.userBrithday) &&\r\n                Objects.equals(userAutograph, user.userAutograph) ;\r\n    }\r\n\r\n    @Override\r\n    public int hashCode() {\r\n        return Objects.hash(userId, userName, userSex, accountNumber, accountAmount, picturePath, userPassword, userPhone, userBrithday, userAutograph);\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/other/entity/User.java	(revision f4aaf511276e0f60eb82edaef0144fc6ff002c53)
+++ app/src/main/java/com/example/pet/other/entity/User.java	(date 1607824908604)
@@ -27,7 +27,9 @@
         this.photo = photo;
     }
 
-    public User(int userId, String userName, String userSex, String accountNumber, double accountAmount, String picturePath, String userPassword, String userPhone, String userBrithday, String userAutograph) {
+    public User(int userId, String userName, String userSex, String accountNumber,
+                double accountAmount, String picturePath, String userPassword,
+                String userPhone, String userBrithday, String userAutograph) {
         this.userId = userId;
         this.userName = userName;
         this.userSex = userSex;
Index: app/src/main/java/com/example/pet/my/editinfo/EditInfo.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.my.editinfo;\r\n\r\nimport androidx.annotation.Nullable;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.appcompat.widget.Toolbar;\r\nimport androidx.core.app.ActivityCompat;\r\n\r\nimport android.app.Activity;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.content.pm.PackageManager;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\nimport android.os.IBinder;\r\nimport android.os.Message;\r\nimport android.text.Editable;\r\nimport android.text.TextWatcher;\r\nimport android.util.Log;\r\nimport android.view.MotionEvent;\r\nimport android.view.View;\r\nimport android.view.inputmethod.InputMethodManager;\r\nimport android.widget.EditText;\r\nimport android.widget.PopupWindow;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.bigkoo.pickerview.builder.OptionsPickerBuilder;\r\nimport com.bigkoo.pickerview.builder.TimePickerBuilder;\r\nimport com.bigkoo.pickerview.listener.CustomListener;\r\nimport com.bigkoo.pickerview.listener.OnOptionsSelectListener;\r\nimport com.bigkoo.pickerview.listener.OnTimeSelectListener;\r\nimport com.bigkoo.pickerview.view.OptionsPickerView;\r\nimport com.bigkoo.pickerview.view.TimePickerView;\r\nimport com.example.pet.R;\r\nimport com.example.pet.other.Cache;\r\nimport com.example.pet.other.entity.User;\r\nimport com.google.gson.Gson;\r\nimport com.luck.picture.lib.PictureSelector;\r\nimport com.luck.picture.lib.config.PictureConfig;\r\nimport com.luck.picture.lib.config.PictureMimeType;\r\nimport com.luck.picture.lib.entity.LocalMedia;\r\n\r\nimport java.io.File;\r\nimport java.io.IOException;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.ArrayList;\r\nimport java.util.Calendar;\r\nimport java.util.Date;\r\nimport java.util.List;\r\n\r\nimport de.hdodenhof.circleimageview.CircleImageView;\r\nimport okhttp3.Call;\r\nimport okhttp3.Callback;\r\nimport okhttp3.MediaType;\r\nimport okhttp3.MultipartBody;\r\nimport okhttp3.OkHttpClient;\r\nimport okhttp3.Request;\r\nimport okhttp3.RequestBody;\r\nimport okhttp3.Response;\r\n\r\npublic class EditInfo extends AppCompatActivity {\r\n    private User user = new User();\r\n    private TextView upSex;\r\n    private PopupWindow popupWindow;\r\n    private Toolbar toolbar;\r\n    private CircleImageView upPhoto;\r\n    private TextView upBrithday;\r\n    private EditText upName;\r\n    private TimePickerView pvTime;\r\n    private OptionsPickerView pvCustomOptions;\r\n    private ArrayList<String> cardItem = new ArrayList<>();\r\n    //输入框初始值\r\n    private int num = 0;\r\n    //输入框最大值\r\n    public int mMaxNum=200;\r\n    public EditText etInput;\r\n    private TextView tvInput;\r\n    private String image_path;\r\n    private static final int REQUEST_EXTERNAL_STORAGE = 1;\r\n    private static String[] PERMISSIONS_STORAGE = {\r\n            \"android.permission.READ_EXTERNAL_STORAGE\",\r\n            \"android.permission.WRITE_EXTERNAL_STORAGE\",\r\n            \"android.permission.CAMER\"};\r\n\r\n    Handler hd = new Handler() {\r\n        @Override\r\n        public void handleMessage(Message msg) {\r\n            if(msg.what == 1){\r\n                Toast.makeText(EditInfo.this,\"上传成功\",Toast.LENGTH_SHORT);\r\n                upData();\r\n            }else if(msg.what == 2){\r\n                Log.e(\"up\",\"6b\");\r\n                Toast.makeText(EditInfo.this,\"上传失败了\",Toast.LENGTH_SHORT);\r\n            }else if(msg.what == 3){\r\n                Cache.user.setPicturePath(Cache.userPhone + \".jpg\");\r\n                Cache.user.setUserBrithday(upBrithday.getText().toString());\r\n                Cache.user.setUserSex(upSex.getText().toString());\r\n                Cache.user.setUserName(upName.getText().toString());\r\n                Cache.user.setUserAutograph(etInput.getText().toString());\r\n                Toast.makeText(EditInfo.this,\"上传成功\",Toast.LENGTH_SHORT);\r\n                EditInfo.this.finish();\r\n            }else {\r\n                Log.e(\"up\",\"6b\");\r\n                Toast.makeText(EditInfo.this,\"上传失败了\",Toast.LENGTH_SHORT);\r\n            }\r\n        }\r\n    };\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_edit_info);\r\n//        if (Build.VERSION.SDK_INT >= 21) {   //只有5.0及以上系统才支持，因此这里先进行了一层if判断\r\n//            View decorView = getWindow().getDecorView();\r\n//            int option = View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN\r\n//                    | View.SYSTEM_UI_FLAG_LAYOUT_STABLE    //设置为全屏显示，必须这两行代码一起才能生效\r\n//                    |View.SYSTEM_UI_FLAG_LIGHT_STATUS_BAR;  //因为背景为浅色，设置通知栏字体颜色为深色\r\n//            decorView.setSystemUiVisibility(option);\r\n//            getWindow().setStatusBarColor(Color.TRANSPARENT);//设置为透明\r\n//        }\r\n        //设置控件内容\r\n        setView();\r\n        initData();\r\n        //加载数据\r\n        upSex();\r\n        upBri();\r\n        countWords();\r\n    }\r\n\r\n    private void initData() {\r\n        cardItem.add(\"未知\");\r\n        cardItem.add(\"男\");\r\n        cardItem.add(\"女\");\r\n        Log.e(\"initData\",\"start\");\r\n        if(Cache.user.getPicturePath() != null){\r\n            upPhoto.setImageBitmap(Cache.user.getPhoto());\r\n        }\r\n        if(Cache.user.getUserName() != null){\r\n            upName.setText(Cache.user.getUserName());\r\n        }\r\n        if(Cache.user.getUserSex() != null){\r\n            upSex.setText(Cache.user.getUserSex());\r\n        }\r\n        if(Cache.user.getUserBrithday() != null){\r\n            upBrithday.setText(Cache.user.getUserBrithday());\r\n        }\r\n        if(Cache.user.getUserAutograph() != null){\r\n            etInput.setText(Cache.user.getUserAutograph());\r\n        }\r\n        Log.e(\"initData\",\"over\");\r\n    }\r\n\r\n    private void setView() {\r\n        upSex = findViewById(R.id.edit_info_sex);\r\n        toolbar = findViewById(R.id.edit_toolbar);\r\n        toolbar.setNavigationOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                EditInfo.this.finish();\r\n            }\r\n        });\r\n        upBrithday = findViewById(R.id.upBrithday);\r\n        upName = findViewById(R.id.upName);\r\n        upPhoto = findViewById(R.id.upPhoto);\r\n        etInput = findViewById(R.id.et_input);\r\n        tvInput = findViewById(R.id.tv_input);\r\n\r\n\r\n\r\n    }\r\n\r\n    public void onClicked(View view) {\r\n        switch(view.getId()){\r\n            case R.id.upPhoto:\r\n                //上传头像\r\n                upPic();\r\n                break;\r\n            case R.id.upName:\r\n                break;\r\n            case R.id.ll_upSex:\r\n                pvCustomOptions.show();\r\n                break;\r\n            case R.id.ll_upBrithday:\r\n                pvTime.show();\r\n                break;\r\n            case R.id.tv_save:\r\n                //保存信息\r\n                if(image_path == null){\r\n                    upData();\r\n                }else {\r\n                    upPhoto(image_path);\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    private void upSex() {\r\n        // 注意：自定义布局中，id为 optionspicker 或者 timepicker 的布局以及其子控件必须要有，否则会报空指针\r\n        // 具体可参考demo 里面的两个自定义布局\r\n        pvCustomOptions = new OptionsPickerBuilder(this, new OnOptionsSelectListener() {\r\n            @Override\r\n            public void onOptionsSelect(int options1, int options2, int options3, View v) {\r\n               //返回的分别是三个级别的选中位置\r\n                String tx = cardItem.get(options1);\r\n                upSex.setText(tx);\r\n//                Cache.user.setUserSex(tx);\r\n                user.setUserSex(tx);\r\n            }\r\n        })\r\n                .setLayoutRes(R.layout.picker_sex_bg, new CustomListener() {\r\n                    @Override\r\n                    public void customLayout(View v) {\r\n                        //自定义布局中的控件初始化及事件处理\r\n                        final TextView tvSubmit = v.findViewById(R.id.tv_finish);\r\n                        TextView tvCancel = v.findViewById(R.id.tv_cancel);\r\n                        TextView tyTitle = v.findViewById(R.id.tv_title);\r\n                        tyTitle.setText(\"性别\");\r\n                        tvSubmit.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvCustomOptions.returnData();\r\n                                pvCustomOptions.dismiss();\r\n                            }\r\n                        });\r\n                        tvCancel.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvCustomOptions.dismiss();\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                })\r\n                .setLineSpacingMultiplier(1.5f)//滚轮字体间距\r\n                .setContentTextSize(22)//字体大小\r\n                .setOutSideCancelable(true)\r\n                .build();\r\n        pvCustomOptions.setPicker(cardItem);//添加数据\r\n    }\r\n\r\n    private void upBri() {\r\n        Calendar selectedDate = Calendar.getInstance();//系统当前时间\r\n        Calendar startDate = Calendar.getInstance();\r\n        startDate.set(1900, 1, 1);\r\n        Calendar endDate = Calendar.getInstance();\r\n        pvTime = new TimePickerBuilder(this, new OnTimeSelectListener() {\r\n            @Override\r\n            public void onTimeSelect(Date date, View v) {\r\n                upBrithday.setText(getTimes(date));\r\n//                Cache.user.setUserBrithday(getTimes(date));\r\n                user.setUserBrithday(getTimes(date));\r\n            }\r\n        })\r\n                .setDate(selectedDate)\r\n                .setRangDate(startDate,endDate)\r\n                .setLayoutRes(R.layout.picker_time_bg, new CustomListener() {\r\n                    @Override\r\n                    public void customLayout(View v) {\r\n                        TextView tvSubmit = v.findViewById(R.id.tv_finish);\r\n                        TextView tvCannel = v.findViewById(R.id.tv_cancel);\r\n                        tvSubmit.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvTime.returnData();\r\n                                pvTime.dismiss();\r\n                            }\r\n                        });\r\n                        tvCannel.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvTime.dismiss();\r\n                            }\r\n                        });\r\n                    }\r\n                })\r\n                .setContentTextSize(22)//字体大小\r\n                .setOutSideCancelable(true)\r\n                .setType(new boolean[]{true, true, true, false, false, false})\r\n                .setLabel(\"年\", \"月\", \"日\", \"时\", \"分\", \"秒\")\r\n                .setLineSpacingMultiplier(1.5f)\r\n                .setTextXOffset(0, 0, 0, 40, 0, -40)\r\n                .isCenterLabel(false) //是否只显示中间选中项的label文字，false则每项item全部都带有label。\r\n                .setDividerColor(0xFF24AD9D)\r\n                .build();\r\n    }\r\n\r\n    //格式化时间\r\n    private String getTimes(Date date) {\r\n        SimpleDateFormat format = new SimpleDateFormat(\"yyyy-MM-dd\");\r\n        return format.format(date);\r\n    }\r\n\r\n    /**\r\n     * 隐藏键盘\r\n     * @param ev\r\n     * @return\r\n     */\r\n    @Override\r\n    public boolean dispatchTouchEvent(MotionEvent ev) {\r\n        if (ev.getAction() == MotionEvent.ACTION_DOWN) {\r\n            View v = getCurrentFocus();\r\n            if (isShouldHideKeyboard(v, ev)) {\r\n                hideKeyboard(v.getWindowToken());\r\n            }\r\n        }\r\n        return super.dispatchTouchEvent(ev);\r\n    }\r\n\r\n    /**\r\n     * 根据EditText所在坐标和用户点击的坐标相对比，来判断是否隐藏键盘，因为当用户点击EditText时则不能隐藏\r\n     *\r\n     * @param v\r\n     * @param event\r\n     * @return\r\n     */\r\n    private boolean isShouldHideKeyboard(View v, MotionEvent event) {\r\n        if (v != null && (v instanceof EditText)) {\r\n            int[] l = {0, 0};\r\n            v.getLocationInWindow(l);\r\n            int left = l[0],\r\n                    top = l[1],\r\n                    bottom = top + v.getHeight(),\r\n                    right = left + v.getWidth();\r\n            if (event.getX() > left && event.getX() < right\r\n                    && event.getY() > top && event.getY() < bottom) {\r\n                // 点击EditText的事件，忽略它。\r\n                return false;\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n        // 如果焦点不是EditText则忽略，这个发生在视图刚绘制完，第一个焦点不在EditText上，和用户用轨迹球选择其他的焦点\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 获取InputMethodManager，隐藏软键盘\r\n     * @param token\r\n     */\r\n    private void hideKeyboard(IBinder token) {\r\n        if (token != null) {\r\n            InputMethodManager im = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);\r\n            im.hideSoftInputFromWindow(token, InputMethodManager.HIDE_NOT_ALWAYS);\r\n        }\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * 记录字数和限制最大输入字数\r\n     */\r\n    private void countWords() {\r\n        etInput.addTextChangedListener(new TextWatcher() {\r\n            //记录输入的字数\r\n            private CharSequence wordNum;\r\n            private int selectionStart;\r\n            private int selectionEnd;\r\n            @Override\r\n            public void beforeTextChanged(CharSequence s, int start, int count, int after) {\r\n\r\n                wordNum = s;\r\n                //判断大于最大值\r\n                if (wordNum.length() > mMaxNum) {\r\n                    int tempSelection = selectionEnd;\r\n                    etInput.setText(s);\r\n                    etInput.setSelection(tempSelection);//设置光标在最后\r\n                    //吐司最多输入300字\r\n                    Toast.makeText(EditInfo.this, \"最多输入\"+mMaxNum+\"字\", Toast.LENGTH_SHORT).show();\r\n\r\n                }\r\n            }\r\n\r\n            @Override\r\n            public void onTextChanged(CharSequence s, int start, int before, int count) {\r\n                //实时记录输入的字数\r\n                wordNum= s;\r\n            }\r\n\r\n            @Override\r\n            public void afterTextChanged(Editable s) {\r\n                int number = num + s.length();\r\n                //TextView显示剩余字数\r\n                tvInput.setText(\"\" + number+\"/\" + mMaxNum);\r\n                selectionStart=etInput.getSelectionStart();\r\n                selectionEnd = etInput.getSelectionEnd();\r\n                //判断大于最大值\r\n                if (wordNum.length() > mMaxNum) {\r\n                    //删除多余输入的字（不会显示出来）\r\n                    s.delete(selectionStart - 1, selectionEnd);\r\n                    int tempSelection = selectionEnd;\r\n                    etInput.setText(s);\r\n                    etInput.setSelection(tempSelection);//设置光标在最后\r\n                    //吐司最多输入300字\r\n                    Toast.makeText(EditInfo.this, \"最多输入\"+mMaxNum+\"字\", Toast.LENGTH_SHORT).show();\r\n\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    private void upPic() {\r\n        //动态申请权限\r\n        verifyStoragePermissions(this);\r\n        PictureSelector.create(this)\r\n                .openGallery(PictureConfig.TYPE_IMAGE)\r\n                .imageEngine(GlideEngine.createGlideEngine())\r\n                .imageSpanCount(4)// 每行显示个数 int\r\n                .maxSelectNum(1)\r\n                .isWeChatStyle(true)\r\n                .selectionMode(PictureConfig.SINGLE)// 多选 or 单选 PictureConfig.MULTIPLE or PictureConfig.SINGLE\r\n                .isSingleDirectReturn(true)//PictureConfig.SINGLE模式下是否直接返回\r\n                .isPreviewImage(true)// 是否可预览图片 true or false\r\n                .isCamera(true)// 是否显示拍照按钮 true or false\r\n                .imageFormat(PictureMimeType.JPEG)// 拍照保存图片格式后缀,默认jpeg\r\n                .isZoomAnim(true)// 图片列表点击 缩放效果 默认true\r\n                .setOutputCameraPath(Const.getImgPath())// 自定义拍照保存路径,可不填\r\n                .isEnableCrop(true)// 是否裁剪 true or false\r\n                .isCompress(true)// 是否压缩 true or false\r\n                .compressSavePath(Const.getImgPath())//压缩图片保存地址\r\n                .freeStyleCropEnabled(true)// 裁剪框是否可拖拽 true or false\r\n                .showCropGrid(true)// 是否显示裁剪矩形网格 圆形裁剪时建议设为false    true or false\r\n                .synOrAsy(false)\r\n                .forResult(PictureConfig.CHOOSE_REQUEST);//结果回调onActivityResult code\r\n    }\r\n\r\n    //接受回调\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        if (resultCode == -1 && data != null) {\r\n            switch (requestCode) {\r\n                case PictureConfig.CHOOSE_REQUEST:\r\n                    List<LocalMedia> selectList = PictureSelector.obtainMultipleResult(data);\r\n                    image_path = selectList.get(0).getCompressPath();\r\n                    upPhoto.setImageURI(Uri.parse(image_path));\r\n                    //上传图片\r\n//                    Cache.user.setPicturePath(image_path);\r\n                    user.setPicturePath(image_path);\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 上传图片\r\n     * 未测试\r\n     */\r\n    public void upPhoto(String path){\r\n//        Cache.user.setUserName(upName.getText().toString());\r\n        Log.e(\"name\",upName.getText().toString());\r\n        Log.e(\"up\",\"1\");\r\n        File file = new File(path);\r\n        Log.e(\"up\",\"2\");\r\n        String url = Cache.MY_URL + \"UpdataUserInfoServlet\";\r\n        OkHttpClient okHttpClient = new OkHttpClient();\r\n        if(file != null && file.exists()){\r\n            RequestBody requestBody = new MultipartBody.Builder()\r\n                    .setType(MultipartBody.FORM)\r\n                    .addFormDataPart(\"file\",\r\n                            Cache.userPhone + \".jpg\",\r\n                            RequestBody.create(MediaType.parse(\"image/png\"),file))\r\n                    .addFormDataPart(\"phone\",Cache.userPhone)\r\n                    .build();\r\n            Request request = new Request.Builder()\r\n                    .url(url)\r\n                    .post(requestBody)\r\n                    .build();\r\n            Call call = okHttpClient.newCall(request);\r\n\r\n            Log.e(\"up\",\"3\");\r\n            call.enqueue(new Callback() {\r\n                @Override\r\n                public void onFailure(Call call, IOException e) {\r\n                    //失败\r\n                    Log.e(\"up\",\"4b\");\r\n                    Message msg = new Message();\r\n                    msg.what = 2;\r\n                    msg.obj = 1;\r\n                    Log.e(\"up\",\"5b\");\r\n                    hd.sendMessage(msg);\r\n                    Log.e(\"up\",\"6b\");\r\n                    e.printStackTrace();\r\n                }\r\n\r\n                @Override\r\n                public void onResponse(Call call, Response response) throws IOException {\r\n                    //上传成功\r\n                    Log.e(\"up\",\"4a\");\r\n                    Message msg = new Message();\r\n                    String res = response.body().string();\r\n                    if(res.equals(\"true\")){\r\n                        msg.what = 1;\r\n                        msg.obj = 1;\r\n                        Log.e(\"updata\",res);\r\n                    }else {\r\n                        msg.what = 2;\r\n                        msg.obj = 1;\r\n                        Log.e(\"updata\",res);\r\n                    }\r\n                    hd.sendMessage(msg);\r\n\r\n                }\r\n            });\r\n\r\n        }else {\r\n            Toast.makeText(EditInfo.this,\"请添加头像\",Toast.LENGTH_SHORT);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 上传数据\r\n     */\r\n    public void upData(){\r\n        OkHttpClient okHttpClient = new OkHttpClient();\r\n        //创建请求体对象\r\n        user.setUserPhone(Cache.userPhone);\r\n        String name = upName.getText().toString();\r\n        if(name == null){\r\n            user.setUserName(\"\");\r\n        }else {\r\n            user.setUserName(name);\r\n        }\r\n        String autograph = etInput.getText().toString();\r\n        if(autograph == null){\r\n            user.setUserAutograph(\"\");\r\n        }else {\r\n            user.setUserAutograph(autograph);\r\n        }\r\n        String path = Cache.user.getPicturePath();\r\n        if(path == null){\r\n            user.setPicturePath(\"\");\r\n        }else {\r\n            user.setPicturePath(path);\r\n        }\r\n        String sex = upSex.getText().toString();\r\n        if(sex == null){\r\n            user.setUserSex(\"未知\");\r\n        }else {\r\n            user.setUserSex(sex);\r\n        }\r\n        String brithday = upBrithday.getText().toString();\r\n        if(brithday == null){\r\n            Calendar selectedDate = Calendar.getInstance();//系统当前时间\r\n            user.setUserBrithday(getTimes(selectedDate.getTime()));\r\n        }else {\r\n            user.setUserBrithday(brithday);\r\n        }\r\n\r\n        RequestBody requestBody = RequestBody.create(MediaType.parse(\r\n                \"text/plain;charset=UTF-8\"),new Gson().toJson(user));\r\n        //3.创建请求对象\r\n        Request request = new Request.Builder()\r\n                .post(requestBody)\r\n                .url(Cache.MY_URL + \"UpDataUserInfo2Servlet\")\r\n                .build();\r\n        //3.创建Call对象，发送请求，并接受响应\r\n        Call call = okHttpClient.newCall(request);\r\n        //异步网络请求（无需手动使用子线程）\r\n        call.enqueue(new Callback() {\r\n            @Override\r\n            public void onFailure(Call call, IOException e) {\r\n                //失败\r\n                Message msg = new Message();\r\n                msg.what = 4;\r\n                msg.obj = 3;\r\n                Log.e(\"up\",\"5b\");\r\n                hd.sendMessage(msg);\r\n                Log.e(\"up\",\"6b\");\r\n                e.printStackTrace();\r\n            }\r\n\r\n            @Override\r\n            public void onResponse(Call call, Response response) throws IOException {\r\n                //上传成功\r\n                Message msg = new Message();\r\n                String res = response.body().string();\r\n                if(res.equals(\"true\")){\r\n                    msg.what = 3;\r\n                    msg.obj = 1;\r\n                    Log.e(\"updata\",res);\r\n                }else {\r\n                    msg.what = 2;\r\n                    msg.obj = 1;\r\n                    Log.e(\"updata\",res);\r\n                }\r\n                hd.sendMessage(msg);\r\n\r\n            }\r\n        });\r\n    }\r\n\r\n    //然后通过一个函数来申请权限\r\n    public static void verifyStoragePermissions(Activity activity) {\r\n        try {\r\n            //检测是否有写的权限\r\n            int permission = ActivityCompat.checkSelfPermission(activity,\r\n                    \"android.permission.WRITE_EXTERNAL_STORAGE\");\r\n            if (permission != PackageManager.PERMISSION_GRANTED) {\r\n                // 没有写的权限，去申请写的权限，会弹出对话框\r\n                ActivityCompat.requestPermissions(activity, PERMISSIONS_STORAGE,REQUEST_EXTERNAL_STORAGE);\r\n            }\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/my/editinfo/EditInfo.java	(revision f4aaf511276e0f60eb82edaef0144fc6ff002c53)
+++ app/src/main/java/com/example/pet/my/editinfo/EditInfo.java	(date 1607825077960)
@@ -100,7 +100,7 @@
                 Cache.user.setUserAutograph(etInput.getText().toString());
                 Toast.makeText(EditInfo.this,"上传成功",Toast.LENGTH_SHORT);
                 EditInfo.this.finish();
-            }else {
+            }else if(msg.what == 4) {
                 Log.e("up","6b");
                 Toast.makeText(EditInfo.this,"上传失败了",Toast.LENGTH_SHORT);
             }
