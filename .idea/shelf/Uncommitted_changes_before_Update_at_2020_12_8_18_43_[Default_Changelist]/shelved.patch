Index: app/src/main/java/com/example/pet/other/Cache.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.other;\r\n\r\nimport com.example.pet.other.entity.Order;\r\nimport com.example.pet.other.entity.Pet;\r\nimport com.example.pet.other.entity.Tips;\r\nimport com.example.pet.other.entity.User;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class Cache {\r\n    /**\r\n     * 存储一些全局信息\r\n     */\r\npublic static User user;\r\npublic static String userPhone;\r\npublic static final String MY_URL=\"http://10.7.90.249:8080/ChongBaoService/\";//我的URL\r\npublic static String url = \"http://10.7.89.96:8080/ChongBao_war_exploded/\";\r\n\r\npublic static int user_id = 1;\r\n\r\npublic static List<Order> myOrderList ;//我的订单数据\r\npublic static List<Pet> myPetList;//我的宠物数据\r\n    public static ArrayList<Tips> myPostList ;\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/other/Cache.java	(revision 9034b7c01a04f8670c0d59fde2797698ed6a38db)
+++ app/src/main/java/com/example/pet/other/Cache.java	(date 1607347522731)
@@ -14,7 +14,7 @@
      */
 public static User user;
 public static String userPhone;
-public static final String MY_URL="http://10.7.90.249:8080/ChongBaoService/";//我的URL
+public static final String MY_URL="http://10.222.189.151:8080/";//我的URL
 public static String url = "http://10.7.89.96:8080/ChongBao_war_exploded/";
 
 public static int user_id = 1;
Index: app/src/main/java/com/example/pet/my/Login.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.my;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport android.animation.Animator;\r\nimport android.animation.AnimatorSet;\r\nimport android.animation.ObjectAnimator;\r\nimport android.animation.PropertyValuesHolder;\r\nimport android.animation.ValueAnimator;\r\nimport android.content.Intent;\r\nimport android.graphics.Color;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\nimport android.os.Message;\r\nimport android.util.Log;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.view.animation.AccelerateDecelerateInterpolator;\r\nimport android.widget.EditText;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.example.pet.MainActivity;\r\nimport com.example.pet.R;\r\nimport com.example.pet.other.Cache;\r\n\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.net.MalformedURLException;\r\nimport java.net.URL;\r\n\r\npublic class Login extends AppCompatActivity {\r\n    private String phone ;\r\n    private View progress;\r\n    private View mInputLayout;\r\n    private TextView login;\r\n    private float mWidth, mHeight;\r\n    private LinearLayout mName, mPsw;\r\n    private EditText etName;\r\n    private EditText etPassword;\r\n    private Handler handler = new Handler( ){\r\n        @Override\r\n        public void handleMessage(@NonNull Message msg) {\r\n           switch (msg.what){\r\n               case 1:\r\n                   mName.setVisibility(View.INVISIBLE);\r\n                   mPsw.setVisibility(View.INVISIBLE);\r\n                   inputAnimator(mInputLayout, mWidth, mHeight);\r\n                    Cache.userPhone = phone;\r\n                    Log.e(\"Login\",\"登录成功\"+Cache.userPhone);\r\n                    Intent intent2 = new Intent(Login.this,MyUserService.class);\r\n                    startService(intent2);\r\n\r\n                   break;\r\n               case 0:\r\n                   Toast.makeText(Login.this,\"密码有误，请重试\",Toast.LENGTH_LONG).show();\r\n                   break;\r\n           }\r\n        }\r\n    };\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_login);\r\n        if (Build.VERSION.SDK_INT >= 21) {   //只有5.0及以上系统才支持，因此这里先进行了一层if判断\r\n            View decorView = getWindow().getDecorView();\r\n            int option = View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN\r\n                    | View.SYSTEM_UI_FLAG_LAYOUT_STABLE    //设置为全屏显示，必须这两行代码一起才能生效\r\n                    |View.SYSTEM_UI_FLAG_LIGHT_STATUS_BAR;  //因为背景为浅色，设置通知栏字体颜色为深色\r\n            decorView.setSystemUiVisibility(option);\r\n            getWindow().setStatusBarColor(Color.TRANSPARENT);//设置为透明\r\n        }\r\n        initView();\r\n    }\r\n\r\n    private void initView() {\r\n        login = (TextView) findViewById(R.id.login_btn);\r\n        progress = findViewById(R.id.layout_progress);\r\n        mInputLayout = findViewById(R.id.input_layout);\r\n        mName = (LinearLayout) findViewById(R.id.input_layout_name);\r\n        mPsw = (LinearLayout) findViewById(R.id.input_layout_psw);\r\n        etName = findViewById(R.id.login_et_username);\r\n        etPassword = findViewById(R.id.login_et_password);\r\n    }\r\n\r\n    public void onClicked(View view) {\r\n        switch (view.getId()){\r\n            case R.id.login_btn:\r\n                mWidth = login.getMeasuredWidth();\r\n                mHeight = login.getMeasuredHeight();\r\n                loginService();\r\n                break;\r\n            case R.id.login_register:\r\n                Intent intent = new Intent(this,Register.class);\r\n                startActivity(intent);\r\n                break;\r\n            case R.id.login_update:\r\n                Intent intent1 = new Intent(this,Update.class);\r\n                startActivity(intent1);\r\n                break;\r\n\r\n        }\r\n    }\r\n\r\n    private void loginService() {\r\n        phone = etName.getText().toString();\r\nCache.userPhone = etName.getText().toString();\r\n        final String pwd = etPassword.getText().toString();\r\n        if(phone.length() ==11 && pwd.length()!=0){\r\n            new Thread(){\r\n                @Override\r\n                public void run() {\r\n                    try {\r\n                        URL url = new URL(Cache.MY_URL+\"LoginServlet?num=\"+phone+\"&pwd=\"+pwd);\r\n                        InputStream in = url.openStream();\r\n                        int num = in.read();\r\n                        Message message = new Message();\r\n                        message.what = num;\r\n                        handler.sendMessage(message);\r\n                        in.close();\r\n                    } catch (MalformedURLException e) {\r\n                        e.printStackTrace();\r\n                    } catch (IOException e) {\r\n                        e.printStackTrace();\r\n                    }\r\n\r\n                }\r\n            }.start();\r\n        }else{\r\n            Toast.makeText(this,\"输入格式有误\",Toast.LENGTH_LONG).show();\r\n        }\r\n    }\r\n\r\n    private void inputAnimator(final View view, float w, float h) {\r\n        AnimatorSet set = new AnimatorSet();\r\n        ValueAnimator animator = ValueAnimator.ofFloat(0, w);\r\n        animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() {\r\n            @Override\r\n            public void onAnimationUpdate(ValueAnimator animation) {\r\n                float value = (Float) animation.getAnimatedValue();\r\n                ViewGroup.MarginLayoutParams params = (ViewGroup.MarginLayoutParams) view\r\n                        .getLayoutParams();\r\n                params.leftMargin = (int) value;\r\n                params.rightMargin = (int) value;\r\n                view.setLayoutParams(params);\r\n            }\r\n        });\r\n        ObjectAnimator animator2 = ObjectAnimator.ofFloat(mInputLayout, \"scaleX\", 1f, 0.5f);\r\n        set.setDuration(1500);\r\n        set.setInterpolator(new AccelerateDecelerateInterpolator());\r\n        set.playTogether(animator, animator2);\r\n        set.start();\r\n        set.addListener(new Animator.AnimatorListener() {\r\n            @Override\r\n            public void onAnimationStart(Animator animation) {\r\n\r\n            }\r\n            @Override\r\n            public void onAnimationRepeat(Animator animation) {\r\n                // TODO Auto-generated method stub\r\n\r\n            }\r\n            @Override\r\n            public void onAnimationEnd(Animator animation) {\r\n                progress.setVisibility(View.VISIBLE);\r\n                progressAnimator(progress);\r\n                mInputLayout.setVisibility(View.INVISIBLE);\r\n                Intent intent1 = new Intent(Login.this,MyDataService.class);\r\n                startService(intent1);\r\n                Intent intent = new Intent(Login.this,MainActivity.class);\r\n                startActivity(intent);\r\n                Login.this.finish();\r\n            }\r\n            @Override\r\n            public void onAnimationCancel(Animator animation) {\r\n                // TODO Auto-generated method stub\r\n            }\r\n        });\r\n    }\r\n    private void progressAnimator(final View view) {\r\n        PropertyValuesHolder animator = PropertyValuesHolder.ofFloat(\"scaleX\", 0.5f, 1f);\r\n        PropertyValuesHolder animator2 = PropertyValuesHolder.ofFloat(\"scaleY\", 0.5f, 1f);\r\n        ObjectAnimator animator3 = ObjectAnimator.ofPropertyValuesHolder(view, animator, animator2);\r\n        animator3.setDuration(1500);\r\n        animator3.setInterpolator(new JellyInterpolator());\r\n        animator3.start();\r\n    }\r\n    public void back(View view) {\r\n        Intent intent = new Intent(Login.this,MainActivity.class);\r\n        startActivity(intent);\r\n        this.finish();\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/my/Login.java	(revision 9034b7c01a04f8670c0d59fde2797698ed6a38db)
+++ app/src/main/java/com/example/pet/my/Login.java	(date 1607351354184)
@@ -107,18 +107,22 @@
 
     private void loginService() {
         phone = etName.getText().toString();
-Cache.userPhone = etName.getText().toString();
+        Cache.userPhone = etName.getText().toString();
         final String pwd = etPassword.getText().toString();
+        Log.e(phone,pwd);
+        Log.e("Login",""+Cache.userPhone+pwd);
         if(phone.length() ==11 && pwd.length()!=0){
             new Thread(){
                 @Override
                 public void run() {
                     try {
                         URL url = new URL(Cache.MY_URL+"LoginServlet?num="+phone+"&pwd="+pwd);
+                        Log.e("链接","成功");
                         InputStream in = url.openStream();
                         int num = in.read();
                         Message message = new Message();
                         message.what = num;
+                        Log.e("num",num + "");
                         handler.sendMessage(message);
                         in.close();
                     } catch (MalformedURLException e) {
Index: app/src/main/java/com/example/pet/my/MyFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.my;\r\n\r\nimport android.content.Intent;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.provider.MediaStore;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.AdapterView;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ImageView;\r\nimport android.widget.ListView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport com.example.pet.R;\r\nimport com.example.pet.my.editinfo.EditInfo;\r\nimport com.example.pet.my.order.MyOrderActivity;\r\nimport com.example.pet.other.Cache;\r\n\r\nimport java.io.File;\r\nimport java.io.IOException;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\nimport cn.smssdk.ui.companent.CircleImageView;\r\n\r\npublic class MyFragment extends Fragment {\r\n    private View view;\r\n    private TextView login;\r\n    private TextView count;\r\n    private CircleImageView photo;\r\n    private List<My> myList1 = new ArrayList<>();\r\n    private List<My> myList2 = new ArrayList<>();\r\n    private List<My> myList3 = new ArrayList<>();\r\n\r\n    @Override\r\n    public View onCreateView(final LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {\r\n        view = inflater.inflate(R.layout.fragment_my, container, false);\r\n        login = view.findViewById(R.id.fragment_login);\r\n        count = view.findViewById(R.id.fragment_count);\r\nphoto = view.findViewById(R.id.user_photo);\r\n        login.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                Intent intent = new Intent(getContext(), Login.class);\r\n                startActivity(intent);\r\n            }\r\n        });\r\n        //适配第一个listView\r\n        MyAdapter myAdapter1 = new MyAdapter(view.getContext(), R.layout.my_listview, myList1);\r\n        ListView listView1 = (ListView) view.findViewById(R.id.my_listview1);\r\n        listView1.setAdapter(myAdapter1);\r\n        //适配第二个listView\r\n        MyAdapter myAdapter2 = new MyAdapter(view.getContext(), R.layout.my_listview, myList2);\r\n        ListView listView2 = (ListView) view.findViewById(R.id.my_listview2);\r\n        listView2.setAdapter(myAdapter2);\r\n        //适配第三个listView\r\n        MyAdapter myAdapter3 = new MyAdapter(view.getContext(), R.layout.my_listview, myList3);\r\n        ListView listView3 = (ListView) view.findViewById(R.id.my_listview3);\r\n        listView3.setAdapter(myAdapter3);\r\n        listView1.setOnItemClickListener(new AdapterView.OnItemClickListener() {\r\n            @Override\r\n            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {\r\n                /**\r\n                 * 暂时修改\r\n                 */\r\n                if (Cache.user != null) {\r\n                    switch (position) {\r\n                        case 0:\r\n                            Intent intent2 = new Intent(getContext(), EditInfo.class);\r\n                            startActivity(intent2);\r\n                            break;\r\n                        default:\r\n                            break;\r\n                    }\r\n                } else {\r\n                    showLoginToast();\r\n                }\r\n            }\r\n        });\r\n        listView2.setOnItemClickListener(new AdapterView.OnItemClickListener() {\r\n            @Override\r\n            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {\r\n                if (Cache.user != null) {\r\n                    switch (position) {\r\n                        case 0:\r\n                            Intent intent = new Intent(getContext(), Post.class);\r\n                            startActivity(intent);\r\n                            break;\r\n                        case 1:\r\n                            Intent intent1 = new Intent(getContext(), MyOrderActivity.class);\r\n                            startActivity(intent1);\r\n                            break;\r\n                        case 2:\r\n                            Intent intent3 = new Intent(getContext(), History.class);\r\n                            startActivity(intent3);\r\n                            break;\r\n                        case 3:\r\n                            Intent intent4 = new Intent(getContext(), NewPet.class);\r\n                            startActivity(intent4);\r\n                            break;\r\n                        default:\r\n                            break;\r\n                    }\r\n                } else {\r\n                    showLoginToast();\r\n                }\r\n            }\r\n        });\r\n        listView3.setOnItemClickListener(new AdapterView.OnItemClickListener() {\r\n            @Override\r\n            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {\r\n                switch (position) {\r\n                    case 0:\r\n                        if (Cache.user != null) {\r\n                            Intent intent = new Intent(getContext(), Setting.class);\r\n                            startActivity(intent);\r\n                        }else {\r\n                            showLoginToast();\r\n                        }\r\n                        break;\r\n                    case 1:\r\n                        Intent intent1 = new Intent(getContext(), AboutUs.class);\r\n                        startActivity(intent1);\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n        return view;\r\n    }\r\n\r\n    //初始化数据\r\n    private void init() {\r\n        My my1 = new My(R.drawable.bianji, \"修改信息\", R.drawable.next);\r\n        myList1.add(my1);\r\n        My my2 = new My(R.drawable.mytie, \"我的帖子\", R.drawable.next);\r\n        myList2.add(my2);\r\n        My my3 = new My(R.drawable.myorder, \"我的订单\", R.drawable.next);\r\n        myList2.add(my3);\r\n        My my4 = new My(R.drawable.liulan, \"浏览记录\", R.drawable.next);\r\n        myList2.add(my4);\r\n        My my5 = new My(R.drawable.petlogo, \"我的宠物\", R.drawable.next);\r\n        myList2.add(my5);\r\n        My my6 = new My(R.drawable.setting, \"个人设置\", R.drawable.next);\r\n        myList3.add(my6);\r\n        My my7 = new My(R.drawable.we, \"关于我们\", R.drawable.next);\r\n        myList3.add(my7);\r\n    }\r\n\r\n    //加载数据，根据生命周期\r\n    @Override\r\n    public void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        init();\r\n    }\r\n\r\n    //通过生命周期方法 获得当前用户数据\r\n    @Override\r\n    public void onStart() {\r\n        if (Cache.user != null) {\r\n            login.setText(Cache.user.getUserName());\r\n            count.setText(Cache.user.getUserPhone());\r\n            photo.setImageBitmap(Cache.user.getPhoto());\r\n        }\r\n        super.onStart();\r\n    }\r\n\r\n    public void showLoginToast() {\r\n        Toast.makeText(getContext(), \"请先登录\", Toast.LENGTH_LONG).show();\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/my/MyFragment.java	(revision 9034b7c01a04f8670c0d59fde2797698ed6a38db)
+++ app/src/main/java/com/example/pet/my/MyFragment.java	(date 1607351599112)
@@ -67,9 +67,7 @@
         listView1.setOnItemClickListener(new AdapterView.OnItemClickListener() {
             @Override
             public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
-                /**
-                 * 暂时修改
-                 */
+
                 if (Cache.user != null) {
                     switch (position) {
                         case 0:
Index: app/src/main/res/layout/activity_pet.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<ScrollView\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\">\r\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:orientation=\"vertical\">\r\n    <!--顶栏-->\r\n    <LinearLayout\r\n\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_marginLeft=\"25dp\"\r\n        android:layout_marginRight=\"25dp\">\r\n\r\n        <LinearLayout\r\n\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"match_parent\"\r\n            android:orientation=\"vertical\">\r\n\r\n            <ImageView\r\n                android:id=\"@+id/pet_photo\"\r\n                android:layout_width=\"200dp\"\r\n                android:layout_height=\"200dp\"\r\n                android:layout_gravity=\"center\"\r\n                android:layout_marginTop=\"21dp\"\r\n                android:background=\"@drawable/hashiqi\" />\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"50dp\"\r\n                android:layout_marginTop=\"50dp\"\r\n               >\r\n\r\n                <TextView\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"match_parent\"\r\n                    android:layout_marginRight=\"25sp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:text=\"爱称\"\r\n                    android:textColor=\"#000\"\r\n                    android:textSize=\"12sp\" />\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"match_parent\"\r\n                    android:background=\"@drawable/bg_myinfo\"\r\n                    android:orientation=\"vertical\">\r\n\r\n                    <EditText\r\n                        android:id=\"@+id/pet_name\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:background=\"@null\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:onClick=\"onClicked\"\r\n                        android:text=\"有光\"\r\n                        android:textSize=\"12sp\" />\r\n                </LinearLayout>\r\n\r\n\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"50dp\"\r\n               >\r\n\r\n                <TextView\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"match_parent\"\r\n                    android:layout_marginRight=\"25sp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:text=\"种类\"\r\n                    android:textColor=\"#000\"\r\n                    android:textSize=\"12sp\" />\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"match_parent\"\r\n                    android:background=\"@drawable/bg_myinfo\"\r\n                    android:orientation=\"vertical\">\r\n\r\n                    <EditText\r\n                        android:id=\"@+id/pet_type\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:background=\"@null\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:onClick=\"onClicked\"\r\n                        android:text=\"哈士奇\"\r\n                        android:textColor=\"@color/black\"\r\n                        android:textSize=\"12sp\" />\r\n                </LinearLayout>\r\n\r\n\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"50dp\"\r\n               >\r\n\r\n                <TextView\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"match_parent\"\r\n                    android:layout_marginRight=\"25sp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:text=\"年龄\"\r\n                    android:textColor=\"#000\"\r\n                    android:textSize=\"12sp\" />\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"match_parent\"\r\n                    android:background=\"@drawable/bg_myinfo\"\r\n                    android:orientation=\"vertical\">\r\n\r\n                    <EditText\r\n                        android:id=\"@+id/pet_age\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:background=\"@null\"\r\n                        android:gravity=\"center_vertical\"\r\n                        android:onClick=\"onClicked\"\r\n                        android:text=\"4岁\"\r\n                        android:textColor=\"@color/black\"\r\n                        android:textSize=\"12sp\" />\r\n                </LinearLayout>\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n\r\n                android:orientation=\"vertical\">\r\n\r\n                <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginTop=\"25sp\"\r\n                    android:layout_marginBottom=\"20dp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:text=\"宠物简介\"\r\n                    android:textColor=\"#000\"\r\n                    android:textSize=\"12sp\" />\r\n\r\n                <LinearLayout\r\n                    android:layout_marginBottom=\"30dp\"\r\n                  android:background=\"@drawable/bg_myinfo\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"100dp\">\r\n\r\n                    <EditText\r\n                        android:id=\"@+id/pet_autograph\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"100dp\"\r\n                        android:background=\"@null\"\r\n                        android:enabled=\"true\"\r\n                        android:gravity=\"start\"\r\n                        android:hint=\"阿巴阿巴阿巴\"\r\n                        android:inputType=\"textMultiLine\"\r\n                        android:maxLines=\"6\"\r\n                        android:minLines=\"6\"\r\n                        android:scrollbars=\"vertical\"\r\n                        android:textSize=\"12sp\" />\r\n                </LinearLayout>\r\n                <Button\r\n                    android:textColor=\"@color/red\"\r\n                    android:id=\"@+id/pet_update\"\r\n                    android:background=\"@drawable/edit\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"修改\" />\r\n            </LinearLayout>\r\n        </LinearLayout>\r\n    </LinearLayout>\r\n\r\n\r\n</LinearLayout>\r\n</ScrollView>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_pet.xml	(revision 9034b7c01a04f8670c0d59fde2797698ed6a38db)
+++ app/src/main/res/layout/activity_pet.xml	(date 1607347522766)
@@ -23,7 +23,7 @@
 
             <ImageView
                 android:id="@+id/pet_photo"
-                android:layout_width="200dp"
+                android:layout_width="250dp"
                 android:layout_height="200dp"
                 android:layout_gravity="center"
                 android:layout_marginTop="21dp"
Index: app/src/main/java/com/example/pet/my/editinfo/EditInfo.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.pet.my.editinfo;\r\n\r\nimport androidx.annotation.Nullable;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.appcompat.widget.Toolbar;\r\nimport androidx.core.app.ActivityCompat;\r\n\r\nimport android.app.Activity;\r\nimport android.content.ContentResolver;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.content.pm.PackageManager;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.BitmapFactory;\r\nimport android.graphics.Rect;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.os.Environment;\r\nimport android.os.Handler;\r\nimport android.os.IBinder;\r\nimport android.os.Looper;\r\nimport android.os.Message;\r\nimport android.provider.MediaStore;\r\nimport android.text.Editable;\r\nimport android.text.TextWatcher;\r\nimport android.util.Log;\r\nimport android.view.Gravity;\r\nimport android.view.MotionEvent;\r\nimport android.view.View;\r\nimport android.view.inputmethod.InputMethodManager;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.PopupWindow;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.bigkoo.pickerview.builder.OptionsPickerBuilder;\r\nimport com.bigkoo.pickerview.builder.TimePickerBuilder;\r\nimport com.bigkoo.pickerview.listener.CustomListener;\r\nimport com.bigkoo.pickerview.listener.OnOptionsSelectListener;\r\nimport com.bigkoo.pickerview.listener.OnTimeSelectListener;\r\nimport com.bigkoo.pickerview.view.OptionsPickerView;\r\nimport com.bigkoo.pickerview.view.TimePickerView;\r\nimport com.example.pet.R;\r\nimport com.example.pet.my.SetPassword;\r\nimport com.example.pet.other.Cache;\r\nimport com.example.pet.other.entity.User;\r\nimport com.google.gson.Gson;\r\nimport com.luck.picture.lib.PictureSelector;\r\nimport com.luck.picture.lib.config.PictureConfig;\r\nimport com.luck.picture.lib.config.PictureMimeType;\r\nimport com.luck.picture.lib.entity.LocalMedia;\r\n\r\nimport java.io.ByteArrayOutputStream;\r\nimport java.io.File;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.ArrayList;\r\nimport java.util.Calendar;\r\nimport java.util.Date;\r\nimport java.util.List;\r\n\r\nimport cn.jiguang.net.HttpUtils;\r\nimport de.hdodenhof.circleimageview.CircleImageView;\r\nimport okhttp3.Call;\r\nimport okhttp3.Callback;\r\nimport okhttp3.MediaType;\r\nimport okhttp3.MultipartBody;\r\nimport okhttp3.OkHttpClient;\r\nimport okhttp3.Request;\r\nimport okhttp3.RequestBody;\r\nimport okhttp3.Response;\r\n\r\nimport static com.luck.picture.lib.config.PictureConfig.REQUEST_CAMERA;\r\n\r\npublic class EditInfo extends AppCompatActivity {\r\n    private User user = new User();\r\n    private TextView upSex;\r\n    private PopupWindow popupWindow;\r\n    private Toolbar toolbar;\r\n    private CircleImageView upPhoto;\r\n    private TextView upBrithday;\r\n    private EditText upName;\r\n    private TimePickerView pvTime;\r\n    private OptionsPickerView pvCustomOptions;\r\n    private ArrayList<String> cardItem = new ArrayList<>();\r\n    //输入框初始值\r\n    private int num = 0;\r\n    //输入框最大值\r\n    public int mMaxNum=200;\r\n    public EditText etInput;\r\n    private TextView tvInput;\r\n    private String image_path;\r\n    private static final int REQUEST_EXTERNAL_STORAGE = 1;\r\n    private static String[] PERMISSIONS_STORAGE = {\r\n            \"android.permission.READ_EXTERNAL_STORAGE\",\r\n            \"android.permission.WRITE_EXTERNAL_STORAGE\",\r\n            \"android.permission.CAMER\"};\r\n\r\n    Handler hd = new Handler() {\r\n        @Override\r\n        public void handleMessage(Message msg) {\r\n            if(msg.what == 1){\r\n                Toast.makeText(EditInfo.this,\"上传成功\",Toast.LENGTH_SHORT);\r\n                upData();\r\n            }else if(msg.what == 2){\r\n                Log.e(\"up\",\"6b\");\r\n                Toast.makeText(EditInfo.this,\"上传失败了\",Toast.LENGTH_SHORT);\r\n            }else if(msg.what == 3){\r\n                Toast.makeText(EditInfo.this,\"上传成功\",Toast.LENGTH_SHORT);\r\n                EditInfo.this.finish();\r\n            }else {\r\n                Log.e(\"up\",\"6b\");\r\n                Toast.makeText(EditInfo.this,\"上传失败了\",Toast.LENGTH_SHORT);\r\n            }\r\n        }\r\n    };\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_edit_info);\r\n//        if (Build.VERSION.SDK_INT >= 21) {   //只有5.0及以上系统才支持，因此这里先进行了一层if判断\r\n//            View decorView = getWindow().getDecorView();\r\n//            int option = View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN\r\n//                    | View.SYSTEM_UI_FLAG_LAYOUT_STABLE    //设置为全屏显示，必须这两行代码一起才能生效\r\n//                    |View.SYSTEM_UI_FLAG_LIGHT_STATUS_BAR;  //因为背景为浅色，设置通知栏字体颜色为深色\r\n//            decorView.setSystemUiVisibility(option);\r\n//            getWindow().setStatusBarColor(Color.TRANSPARENT);//设置为透明\r\n//        }\r\n        //设置控件内容\r\n        setView();\r\n    }\r\n\r\n    public void onClicked(View view) {\r\n        switch(view.getId()){\r\n            case R.id.upPhoto:\r\n                //上传头像\r\n                upPic();\r\n                break;\r\n            case R.id.upName:\r\n                break;\r\n            case R.id.ll_upSex:\r\n                pvCustomOptions.show();\r\n                break;\r\n            case R.id.ll_upBrithday:\r\n                pvTime.show();\r\n                break;\r\n            case R.id.tv_save:\r\n                //保存信息\r\n                upPhoto(image_path);\r\n                break;\r\n        }\r\n    }\r\n\r\n    private void upSex() {\r\n        // 注意：自定义布局中，id为 optionspicker 或者 timepicker 的布局以及其子控件必须要有，否则会报空指针\r\n        // 具体可参考demo 里面的两个自定义布局\r\n        pvCustomOptions = new OptionsPickerBuilder(this, new OnOptionsSelectListener() {\r\n            @Override\r\n            public void onOptionsSelect(int options1, int options2, int options3, View v) {\r\n               //返回的分别是三个级别的选中位置\r\n                String tx = cardItem.get(options1);\r\n                upSex.setText(tx);\r\n                Cache.user.setUserSex(tx);\r\n                user.setUserSex(tx);\r\n            }\r\n        })\r\n                .setLayoutRes(R.layout.picker_sex_bg, new CustomListener() {\r\n                    @Override\r\n                    public void customLayout(View v) {\r\n                        //自定义布局中的控件初始化及事件处理\r\n                        final TextView tvSubmit = v.findViewById(R.id.tv_finish);\r\n                        TextView tvCancel = v.findViewById(R.id.tv_cancel);\r\n                        tvSubmit.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvCustomOptions.returnData();\r\n                                pvCustomOptions.dismiss();\r\n                            }\r\n                        });\r\n                        tvCancel.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvCustomOptions.dismiss();\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                })\r\n                .setOutSideCancelable(true)\r\n                .build();\r\n        pvCustomOptions.setPicker(cardItem);//添加数据\r\n    }\r\n\r\n    private void upBri() {\r\n        Calendar selectedDate = Calendar.getInstance();//系统当前时间\r\n        Calendar startDate = Calendar.getInstance();\r\n        startDate.set(1900, 1, 1);\r\n        Calendar endDate = Calendar.getInstance();\r\n        pvTime = new TimePickerBuilder(this, new OnTimeSelectListener() {\r\n            @Override\r\n            public void onTimeSelect(Date date, View v) {\r\n                upBrithday.setText(getTimes(date));\r\n                Cache.user.setUserBrithday(getTimes(date));\r\n                user.setUserBrithday(getTimes(date));\r\n            }\r\n        })\r\n                .setDate(selectedDate)\r\n                .setRangDate(startDate,endDate)\r\n                .setLayoutRes(R.layout.picker_time_bg, new CustomListener() {\r\n                    @Override\r\n                    public void customLayout(View v) {\r\n                        TextView tvSubmit = v.findViewById(R.id.tv_finish);\r\n                        TextView tvCannel = v.findViewById(R.id.tv_cancel);\r\n                        tvSubmit.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvTime.returnData();\r\n                                pvTime.dismiss();\r\n                            }\r\n                        });\r\n                        tvCannel.setOnClickListener(new View.OnClickListener() {\r\n                            @Override\r\n                            public void onClick(View v) {\r\n                                pvTime.dismiss();\r\n                            }\r\n                        });\r\n                    }\r\n                })\r\n                .setOutSideCancelable(true)\r\n                .setContentTextSize(18)\r\n                .setType(new boolean[]{true, true, true, false, false, false})\r\n                .setLabel(\"年\", \"月\", \"日\", \"时\", \"分\", \"秒\")\r\n                .setLineSpacingMultiplier(1.2f)\r\n                .setTextXOffset(0, 0, 0, 40, 0, -40)\r\n                .isCenterLabel(false) //是否只显示中间选中项的label文字，false则每项item全部都带有label。\r\n                .setDividerColor(0xFF24AD9D)\r\n                .build();\r\n    }\r\n\r\n    //格式化时间\r\n    private String getTimes(Date date) {\r\n        SimpleDateFormat format = new SimpleDateFormat(\"yyyy-MM-dd\");\r\n        return format.format(date);\r\n    }\r\n\r\n    @Override\r\n    public boolean dispatchTouchEvent(MotionEvent ev) {\r\n        if (ev.getAction() == MotionEvent.ACTION_DOWN) {\r\n            View v = getCurrentFocus();\r\n            if (isShouldHideKeyboard(v, ev)) {\r\n                hideKeyboard(v.getWindowToken());\r\n            }\r\n        }\r\n        return super.dispatchTouchEvent(ev);\r\n    }\r\n\r\n    /**\r\n     * 根据EditText所在坐标和用户点击的坐标相对比，来判断是否隐藏键盘，因为当用户点击EditText时则不能隐藏\r\n     *\r\n     * @param v\r\n     * @param event\r\n     * @return\r\n     */\r\n    private boolean isShouldHideKeyboard(View v, MotionEvent event) {\r\n        if (v != null && (v instanceof EditText)) {\r\n            int[] l = {0, 0};\r\n            v.getLocationInWindow(l);\r\n            int left = l[0],\r\n                    top = l[1],\r\n                    bottom = top + v.getHeight(),\r\n                    right = left + v.getWidth();\r\n            if (event.getX() > left && event.getX() < right\r\n                    && event.getY() > top && event.getY() < bottom) {\r\n                // 点击EditText的事件，忽略它。\r\n                return false;\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n        // 如果焦点不是EditText则忽略，这个发生在视图刚绘制完，第一个焦点不在EditText上，和用户用轨迹球选择其他的焦点\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 获取InputMethodManager，隐藏软键盘\r\n     * @param token\r\n     */\r\n    private void hideKeyboard(IBinder token) {\r\n        if (token != null) {\r\n            InputMethodManager im = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);\r\n            im.hideSoftInputFromWindow(token, InputMethodManager.HIDE_NOT_ALWAYS);\r\n        }\r\n    }\r\n\r\n    private void setView() {\r\n        upSex = findViewById(R.id.edit_info_sex);\r\n        toolbar = findViewById(R.id.edit_toolbar);\r\n        toolbar.setNavigationOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                EditInfo.this.finish();\r\n            }\r\n        });\r\n        upBrithday = findViewById(R.id.upBrithday);\r\n        upName = findViewById(R.id.upName);\r\n        upPhoto = findViewById(R.id.upPhoto);\r\n        etInput = findViewById(R.id.et_input);\r\n        tvInput = findViewById(R.id.tv_input);\r\n        cardItem.add(\"未知\");\r\n        cardItem.add(\"男\");\r\n        cardItem.add(\"女\");\r\n        //加载数据\r\n        upSex();\r\n        upBri();\r\n        countWords();\r\n\r\n\r\n\r\n    }\r\n\r\n    /**\r\n     * 记录字数和限制最大输入字数\r\n     */\r\n    private void countWords() {\r\n        etInput.addTextChangedListener(new TextWatcher() {\r\n            //记录输入的字数\r\n            private CharSequence wordNum;\r\n            private int selectionStart;\r\n            private int selectionEnd;\r\n            @Override\r\n            public void beforeTextChanged(CharSequence s, int start, int count, int after) {\r\n\r\n            }\r\n\r\n            @Override\r\n            public void onTextChanged(CharSequence s, int start, int before, int count) {\r\n                //实时记录输入的字数\r\n                wordNum= s;\r\n            }\r\n\r\n            @Override\r\n            public void afterTextChanged(Editable s) {\r\n\r\n                Cache.user.setUserAutograph(Cache.user.getUserAutograph() + s);\r\n                int number = num + s.length();\r\n                //TextView显示剩余字数\r\n                tvInput.setText(\"\" + number+\"/\" + mMaxNum);\r\n                selectionStart=etInput.getSelectionStart();\r\n                selectionEnd = etInput.getSelectionEnd();\r\n                //判断大于最大值\r\n                if (wordNum.length() > mMaxNum) {\r\n                    //删除多余输入的字（不会显示出来）\r\n                    s.delete(selectionStart - 1, selectionEnd);\r\n                    int tempSelection = selectionEnd;\r\n                    etInput.setText(s);\r\n                    etInput.setSelection(tempSelection);//设置光标在最后\r\n                    //吐司最多输入300字\r\n                    Toast.makeText(EditInfo.this, \"最多输入\"+mMaxNum+\"字\", Toast.LENGTH_SHORT).show();\r\n\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    private void upPic() {\r\n        //动态申请权限\r\n        verifyStoragePermissions(this);\r\n        PictureSelector.create(this)\r\n                .openGallery(PictureConfig.TYPE_IMAGE)\r\n                .imageEngine(GlideEngine.createGlideEngine())\r\n                .imageSpanCount(4)// 每行显示个数 int\r\n                .maxSelectNum(1)\r\n                .isWeChatStyle(true)\r\n                .selectionMode(PictureConfig.SINGLE)// 多选 or 单选 PictureConfig.MULTIPLE or PictureConfig.SINGLE\r\n                .isSingleDirectReturn(true)//PictureConfig.SINGLE模式下是否直接返回\r\n                .isPreviewImage(true)// 是否可预览图片 true or false\r\n                .isCamera(true)// 是否显示拍照按钮 true or false\r\n                .imageFormat(PictureMimeType.JPEG)// 拍照保存图片格式后缀,默认jpeg\r\n                .isZoomAnim(true)// 图片列表点击 缩放效果 默认true\r\n                .setOutputCameraPath(Const.getImgPath())// 自定义拍照保存路径,可不填\r\n                .isEnableCrop(true)// 是否裁剪 true or false\r\n                .isCompress(true)// 是否压缩 true or false\r\n                .compressSavePath(Const.getImgPath())//压缩图片保存地址\r\n                .freeStyleCropEnabled(true)// 裁剪框是否可拖拽 true or false\r\n                .showCropGrid(true)// 是否显示裁剪矩形网格 圆形裁剪时建议设为false    true or false\r\n                .forResult(PictureConfig.CHOOSE_REQUEST);//结果回调onActivityResult code\r\n    }\r\n\r\n    //接受回调\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        if (resultCode == -1 && data != null) {\r\n            switch (requestCode) {\r\n                case PictureConfig.CHOOSE_REQUEST:\r\n                    List<LocalMedia> selectList = PictureSelector.obtainMultipleResult(data);\r\n                    image_path = selectList.get(0).getCompressPath();\r\n                    upPhoto.setImageURI(Uri.parse(image_path));\r\n                    //上传图片\r\n                    Cache.user.setPicturePath(image_path);\r\n                    user.setPicturePath(image_path);\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 上传图片\r\n     * 未测试\r\n     */\r\n    public void upPhoto(String path){\r\n        Cache.user.setUserName(upName.getText().toString());\r\n        Log.e(\"name\",upName.getText().toString());\r\n        Log.e(\"up\",\"1\");\r\n        File file = new File(path);\r\n        Log.e(\"up\",\"2\");\r\n        String url = Cache.MY_URL + \"UpdataUserInfoServlet\";\r\n        OkHttpClient okHttpClient = new OkHttpClient();\r\n        if(file != null && file.exists()){\r\n            RequestBody requestBody = new MultipartBody.Builder()\r\n                    .setType(MultipartBody.FORM)\r\n                    .addFormDataPart(\"file\",\r\n                            Cache.userPhone + \".jpg\",\r\n                            RequestBody.create(MediaType.parse(\"image/png\"),file))\r\n                    .addFormDataPart(\"phone\",Cache.userPhone)\r\n                    .build();\r\n            Request request = new Request.Builder()\r\n                    .url(url)\r\n                    .post(requestBody)\r\n                    .build();\r\n            Call call = okHttpClient.newCall(request);\r\n\r\n            Log.e(\"up\",\"3\");\r\n            call.enqueue(new Callback() {\r\n                @Override\r\n                public void onFailure(Call call, IOException e) {\r\n                    //失败\r\n                    Log.e(\"up\",\"4b\");\r\n                    Message msg = new Message();\r\n                    msg.what = 2;\r\n                    msg.obj = 1;\r\n                    Log.e(\"up\",\"5b\");\r\n                    hd.sendMessage(msg);\r\n                    Log.e(\"up\",\"6b\");\r\n                    e.printStackTrace();\r\n                }\r\n\r\n                @Override\r\n                public void onResponse(Call call, Response response) throws IOException {\r\n                    //上传成功\r\n                    Log.e(\"up\",\"4a\");\r\n                    Message msg = new Message();\r\n                    String res = response.body().string();\r\n                    if(res.equals(\"true\")){\r\n                        msg.what = 1;\r\n                        msg.obj = 1;\r\n                        Log.e(\"updata\",res);\r\n                    }else {\r\n                        msg.what = 2;\r\n                        msg.obj = 1;\r\n                        Log.e(\"updata\",res);\r\n                    }\r\n                    hd.sendMessage(msg);\r\n\r\n                }\r\n            });\r\n\r\n        }else {\r\n            Toast.makeText(EditInfo.this,\"请添加头像\",Toast.LENGTH_SHORT);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 上传数据\r\n     */\r\n    public void upData(){\r\n        OkHttpClient okHttpClient = new OkHttpClient();\r\n        //创建请求体对象\r\n        user.setUserPhone(Cache.userPhone);\r\n        user.setUserName(upName.getText().toString());\r\n        user.setUserAutograph(etInput.getText().toString());\r\n        user.setPicturePath(Cache.userPhone + \".jpg\");\r\n        RequestBody requestBody = RequestBody.create(MediaType.parse(\r\n                \"text/plain;charset=UTF-8\"),new Gson().toJson(user));\r\n        //3.创建请求对象\r\n        Request request = new Request.Builder()\r\n                .post(requestBody)\r\n                .url(Cache.MY_URL + \"UpDataUserInfo2Servlet\")\r\n                .build();\r\n        //3.创建Call对象，发送请求，并接受响应\r\n        Call call = okHttpClient.newCall(request);\r\n        //异步网络请求（无需手动使用子线程）\r\n        call.enqueue(new Callback() {\r\n            @Override\r\n            public void onFailure(Call call, IOException e) {\r\n                //失败\r\n                Message msg = new Message();\r\n                msg.what = 4;\r\n                msg.obj = 3;\r\n                Log.e(\"up\",\"5b\");\r\n                hd.sendMessage(msg);\r\n                Log.e(\"up\",\"6b\");\r\n                e.printStackTrace();\r\n            }\r\n\r\n            @Override\r\n            public void onResponse(Call call, Response response) throws IOException {\r\n                //上传成功\r\n                Message msg = new Message();\r\n                String res = response.body().string();\r\n                if(res.equals(\"true\")){\r\n                    msg.what = 3;\r\n                    msg.obj = 1;\r\n                    Log.e(\"updata\",res);\r\n                }else {\r\n                    msg.what = 2;\r\n                    msg.obj = 1;\r\n                    Log.e(\"updata\",res);\r\n                }\r\n                hd.sendMessage(msg);\r\n\r\n            }\r\n        });\r\n    }\r\n\r\n    //然后通过一个函数来申请权限\r\n    public static void verifyStoragePermissions(Activity activity) {\r\n        try {\r\n            //检测是否有写的权限\r\n            int permission = ActivityCompat.checkSelfPermission(activity,\r\n                    \"android.permission.WRITE_EXTERNAL_STORAGE\");\r\n            if (permission != PackageManager.PERMISSION_GRANTED) {\r\n                // 没有写的权限，去申请写的权限，会弹出对话框\r\n                ActivityCompat.requestPermissions(activity, PERMISSIONS_STORAGE,REQUEST_EXTERNAL_STORAGE);\r\n            }\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n\r\n\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/pet/my/editinfo/EditInfo.java	(revision 9034b7c01a04f8670c0d59fde2797698ed6a38db)
+++ app/src/main/java/com/example/pet/my/editinfo/EditInfo.java	(date 1607347522782)
@@ -56,6 +56,8 @@
 import java.io.File;
 import java.io.IOException;
 import java.io.InputStream;
+import java.net.MalformedURLException;
+import java.net.URL;
 import java.text.SimpleDateFormat;
 import java.util.ArrayList;
 import java.util.Calendar;
@@ -131,6 +133,61 @@
 //        }
         //设置控件内容
         setView();
+        initData();
+        //加载数据
+        upSex();
+        upBri();
+        countWords();
+    }
+
+    private void initData() {
+        cardItem.add("未知");
+        cardItem.add("男");
+        cardItem.add("女");
+        if(Cache.user.getPicturePath() != null){
+            URL url1 = null;
+            try {
+                url1 = new URL(Cache.MY_URL +"upload/" +user.getPicturePath());
+                InputStream in1 = url1.openStream();
+                Bitmap bitmap = BitmapFactory.decodeStream(in1);
+                upPhoto.setImageBitmap(bitmap);
+            } catch (MalformedURLException e) {
+                e.printStackTrace();
+            } catch (IOException e) {
+                e.printStackTrace();
+            }
+        }
+        if(Cache.user.getUserName() != null){
+            upName.setText(Cache.user.getUserName());
+        }
+        if(Cache.user.getUserSex() != null){
+            upSex.setText(Cache.user.getUserSex());
+        }
+        if(Cache.user.getUserBrithday() != null){
+            upBrithday.setText(Cache.user.getUserBrithday());
+        }
+        if(Cache.user.getUserAutograph() != null){
+            etInput.setText(Cache.user.getUserAutograph());
+        }
+    }
+
+    private void setView() {
+        upSex = findViewById(R.id.edit_info_sex);
+        toolbar = findViewById(R.id.edit_toolbar);
+        toolbar.setNavigationOnClickListener(new View.OnClickListener() {
+            @Override
+            public void onClick(View v) {
+                EditInfo.this.finish();
+            }
+        });
+        upBrithday = findViewById(R.id.upBrithday);
+        upName = findViewById(R.id.upName);
+        upPhoto = findViewById(R.id.upPhoto);
+        etInput = findViewById(R.id.et_input);
+        tvInput = findViewById(R.id.tv_input);
+
+
+
     }
 
     public void onClicked(View view) {
@@ -295,31 +352,7 @@
         }
     }
 
-    private void setView() {
-        upSex = findViewById(R.id.edit_info_sex);
-        toolbar = findViewById(R.id.edit_toolbar);
-        toolbar.setNavigationOnClickListener(new View.OnClickListener() {
-            @Override
-            public void onClick(View v) {
-                EditInfo.this.finish();
-            }
-        });
-        upBrithday = findViewById(R.id.upBrithday);
-        upName = findViewById(R.id.upName);
-        upPhoto = findViewById(R.id.upPhoto);
-        etInput = findViewById(R.id.et_input);
-        tvInput = findViewById(R.id.tv_input);
-        cardItem.add("未知");
-        cardItem.add("男");
-        cardItem.add("女");
-        //加载数据
-        upSex();
-        upBri();
-        countWords();
-
 
-
-    }
 
     /**
      * 记录字数和限制最大输入字数
@@ -541,7 +574,4 @@
             e.printStackTrace();
         }
     }
-
-
-
 }
\ No newline at end of file
diff --git .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_5_14_54__Default_Changelist_.xml .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_5_14_54__Default_Changelist_.xml
diff --git .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_09__Default_Changelist_.xml .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_09__Default_Changelist_.xml
diff --git .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_2_11_10__Default_Changelist_.xml .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_2_11_10__Default_Changelist_.xml
diff --git .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_9_09__Default_Changelist_.xml .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_9_09__Default_Changelist_.xml
diff --git .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_15__Default_Changelist_.xml .idea/shelf/Uncommitted_changes_before_Update_at_2020_12_3_10_15__Default_Changelist_.xml
